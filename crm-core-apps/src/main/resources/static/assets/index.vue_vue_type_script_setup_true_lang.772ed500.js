import{a as B,l as F}from"./index.e9d54774.js";/* empty css               */import{d as H,f as p,c as Y,w as S,o as G,D as L,aH as x,aI as s,aS as d,G as A,u as m,aY as f,aW as c,bY as z,bt as J,cu as D,cv as K,E as w,aU as Q,aV as X,H as Z,bg as ee,a$ as ae,aO as te,aN as oe,aP as le,bo as se,bp as ne,bq as ue}from"./arco.a97fe066.js";import{c as E}from"./color.562bf6e9.js";import{w as re}from"./monitor-object.647fdfa2.js";/* empty css               *//* empty css              */import{a as ce,s as de,f as ie}from"./monitor-object-tag.71c4a187.js";import{d as me}from"./index.127a6572.js";const be=H({__name:"index",props:{queryParams:{},categoryCode:{}},emits:["check"],setup(N,{emit:M}){const y=N,v=M,T=E("info-6"),R=E("warn-6"),V=E("average-6"),I=E("high-6"),_=E("disaster-6"),C=E("success-6"),a=p({DISASTER:0,HIGH:0,AVERAGE:0,WARN:0,INFO:0,NORMAL:0}),t=p({DISASTER:!1,HIGH:!1,AVERAGE:!1,WARN:!1,INFO:!1,NORMAL:!1}),b=Y(()=>{const l=[];return Object.keys(t.value).forEach(e=>{t.value[e]&&(e!=="NORMAL"?l.push(e):l.push(""))}),l}),h=async(l={...y.queryParams})=>{y.categoryCode&&(l.category=y.categoryCode);const{data:e}=await re(l);e&&Object.keys(e).forEach(r=>{e[r]>99&&(e[r]="99+")}),a.value=e};S(()=>y.queryParams,()=>{h()},{deep:!0});const u=()=>{v("check",b.value)};return G(()=>{h()}),(l,e)=>{const r=z,O=J;return L(),x(O,null,{default:s(()=>[d(r,{checked:t.value.DISASTER,"onUpdate:checked":e[0]||(e[0]=n=>t.value.DISASTER=n),checkable:"",color:"red","default-checked":!1,style:A({border:"1px solid "+m(_)}),onCheck:u},{default:s(()=>[f(c(l.$t("alertManage.searchForm.eventDisasterTag"))+"("+c(a.value.DISASTER?a.value.DISASTER:0)+") ",1)]),_:1},8,["checked","style"]),d(r,{checked:t.value.HIGH,"onUpdate:checked":e[1]||(e[1]=n=>t.value.HIGH=n),checkable:"",color:"orangered","default-checked":!1,style:A({border:"1px solid "+m(I)}),onCheck:u},{default:s(()=>[f(c(l.$t("alertManage.searchForm.eventHighTag"))+"("+c(a.value.HIGH?a.value.HIGH:0)+") ",1)]),_:1},8,["checked","style"]),d(r,{checked:t.value.AVERAGE,"onUpdate:checked":e[2]||(e[2]=n=>t.value.AVERAGE=n),checkable:"",color:"orange","default-checked":!1,style:A({border:"1px solid "+m(V)}),onCheck:u},{default:s(()=>[f(c(l.$t("alertManage.searchForm.eventAverageTag"))+"("+c(a.value.AVERAGE?a.value.AVERAGE:0)+") ",1)]),_:1},8,["checked","style"]),d(r,{checked:t.value.WARN,"onUpdate:checked":e[3]||(e[3]=n=>t.value.WARN=n),checkable:"",color:"gold","default-checked":!1,style:A({border:"1px solid "+m(R)}),onCheck:u},{default:s(()=>[f(c(l.$t("alertManage.searchForm.eventWarnTag"))+"("+c(a.value.WARN?a.value.WARN:0)+") ",1)]),_:1},8,["checked","style"]),d(r,{checked:t.value.INFO,"onUpdate:checked":e[4]||(e[4]=n=>t.value.INFO=n),checkable:"",color:"blue","default-checked":!1,style:A({border:"1px solid "+m(T)}),onCheck:u},{default:s(()=>[f(c(l.$t("alertManage.searchForm.eventInfoTag"))+"("+c(a.value.INFO?a.value.INFO:0)+") ",1)]),_:1},8,["checked","style"]),d(r,{checked:t.value.NORMAL,"onUpdate:checked":e[5]||(e[5]=n=>t.value.NORMAL=n),checkable:!0,color:"green","default-checked":!1,style:A({border:"1px solid "+m(C)}),onCheck:u},{default:s(()=>[f(" \u6B63\u5E38("+c(a.value.NORMAL?a.value.NORMAL:0)+") ",1)]),_:1},8,["checked","style"])]),_:1})}}}),fe={style:{display:"flex"}},Fe=H({__name:"index",props:D({attachNewTagList:{type:Array,default:()=>[]}},{modelValue:{default:()=>[]},modelModifiers:{}}),emits:D(["changeTagNameList"],["update:modelValue"]),setup(N,{emit:M}){const y=M,v=p([]),{loading:T,setLoading:R}=B(),{loading:V,setLoading:I}=B(),_=K(N,"modelValue"),C=N,a=p([]);S(()=>_,()=>{v.value=F.cloneDeep(_.value)},{deep:!0,immediate:!0});const t=async()=>{R(!0),a.value=(await ce()).data,R(!1)};S(()=>C.attachNewTagList,i=>{i&&i.length>0&&i.forEach(o=>{F.find(a.value,{name:o})||a.value.push({id:o,name:o})})},{deep:!0,immediate:!0});const b=p(),h=p(!1),u=p({id:"",name:""}),l=()=>{u.value.name="",b.value.resetFields(),h.value=!0},e=p([]),r=i=>{e.value=[],_.value=F.cloneDeep(i),v.value.forEach(o=>{const k=F.find(a.value,{id:o});k&&e.value.push(k.name)}),y("changeTagNameList",F.uniq(e.value))},O=async()=>{try{if(I(!0),!await b.value.validate()){const o=(await de(u.value)).data;v.value.push(o),r(v.value),ee.success("\u63D0\u4EA4\u6210\u529F"),h.value=!1,await t()}}catch(i){console.error(i)}finally{I(!1)}},n=me(async(i,o)=>{const{data:k}=await ie(i);k&&o("\u6807\u7B7E\u5DF2\u5B58\u5728")},500);return G(()=>{t()}),(i,o)=>{const k=ae,U=te,W=oe,$=le,P=se,q=ne,j=ue;return L(),w("div",fe,[d(U,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=g=>v.value=g),placeholder:"\u8BF7\u9009\u62E9",multiple:"",style:{width:"90%"},"allow-clear":"",loading:m(T),onChange:r},{default:s(()=>[(L(!0),w(Q,null,X(a.value,g=>(L(),x(k,{key:g.id,value:g.id},{default:s(()=>[f(c(g.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","loading"]),d(W,{type:"text",onClick:l},{default:s(()=>[f("\u65B0\u5EFA")]),_:1}),d(j,{visible:h.value,width:"auto","title-align":"start",draggable:"","mask-closable":!1,"ok-loading":m(V),onOk:O,onCancel:o[2]||(o[2]=g=>h.value=!1)},{title:s(()=>[f("\u65B0\u5EFA\u6807\u7B7E")]),default:s(()=>[Z("div",null,[d(q,{ref_key:"tagFormRef",ref:b,model:u.value,style:{width:"540px"}},{default:s(()=>[d(P,{field:"name",label:"\u6807\u7B7E\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u7B7E\u540D\u79F0"},{validator:m(n)}],"validate-trigger":"blur"},{default:s(()=>[d($,{modelValue:u.value.name,"onUpdate:modelValue":o[1]||(o[1]=g=>u.value.name=g),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])])]),_:1},8,["visible","ok-loading"])])}}});export{Fe as _,be as a};
