import{a as ee,l as te}from"./index.e9d54774.js";/* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css               */import{d as ae,f as m,r as V,o as oe,aT as le,D as ne,E as ie,H as F,aS as t,aI as o,u as i,aY as p,aW as h,bz as se,bg as E,bq as k,ch as ue,bt as de,a_ as re,aN as ce,b0 as me,aM as pe,bB as fe,aP as ge,bo as ye,bv as _e,bp as ve}from"./arco.a97fe066.js";import{q as Ce,s as be,d as Fe,a as he}from"./dict.7add4266.js";import{p as we}from"./pagination.72a5f225.js";import{d as z}from"./index.127a6572.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";const Be={class:"page-container"},De={class:"page-panel"},Se={style:{height:"calc(100vh - 146px)"}},Re=ae({__name:"index",setup(xe){const{loading:q,setLoading:w}=ee(!1),{pagination:s,pageSizeOptions:$}=we(),B=m(),A=m(),T=m({size:"mini",height:"auto",columnConfig:{resizable:!0},showOverflow:"tooltip",columns:[{title:"\u5B57\u5178\u7C7B\u578B",field:"type",minWidth:120},{title:"\u5B57\u5178\u540D\u79F0",field:"name",minWidth:120},{title:"\u5B57\u5178\u7F16\u7801",field:"code",minWidth:120},{title:"\u63CF\u8FF0",field:"description",minWidth:120},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",width:200},{title:"\u64CD\u4F5C",width:120,slots:{default:"action"}}]}),g=V({queryStr:""}),d=async(e={...g,page:s})=>{w(!0);const a=B.value;try{const{data:u}=await Ce(e);s.total=u.totalElements,a&&await a.reloadData(u.content)}catch(u){console.error(u)}finally{w(!1)}},P=e=>{s.current=e,d()},I=e=>{s.pageSize=e,d()},L=()=>{d()},r=m(!1),c=m(),l=V({id:"",type:"",name:"",code:"",description:""}),O=async()=>{await c.value.validate()?console.warn("\u9A8C\u8BC1\u4E0D\u901A\u8FC7"):(await be(l),E.success("\u63D0\u4EA4\u6210\u529F"),r.value=!1,await d())};let y,_;const R=()=>{r.value=!0,c.value.resetFields(),l.id="",y="",_=""},U=e=>{r.value=!0,te.assign(l,e),y=l.type,_=l.code,c.value.validate()},W=async e=>{k.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,content:`\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u5B57\u5178'${e.name}'\uFF0C\u662F\u5426\u7EE7\u7EED?`,onOk:async()=>{await Fe(e.id),E.success("\u5220\u9664\u6210\u529F"),await d()}})},D=z(async()=>{await d()},500);oe(()=>{d()});let v=!1;const M=e=>{const{value:a}=e.target;v=v||!!a},N=e=>{e!==y&&v&&l.code&&c.value.validateField("code")},G=z(async(e,a)=>{if(e!==_&&l.type){const{data:u}=await he(l.type,e);u&&a("\u7C7B\u578B\u7F16\u7801\u5DF2\u5B58\u5728")}},500);return(e,a)=>{const u=ue,C=de,S=re,j=ce,H=me,x=pe,Y=fe,J=le("vxe-grid"),b=ge,f=ye,K=_e,Q=ve,X=k;return ne(),ie("div",Be,[F("div",De,[t(H,null,{default:o(()=>[t(S,{span:14},{default:o(()=>[t(C,{style:{"margin-bottom":"5px"}},{default:o(()=>[t(u,{modelValue:g.queryStr,"onUpdate:modelValue":a[0]||(a[0]=n=>g.queryStr=n),style:{width:"320px"},placeholder:"\u5B57\u5178\u7C7B\u578B/\u540D\u79F0/\u7F16\u7801","allow-clear":"",onSearch:L,onInput:i(D),onClear:i(D)},null,8,["modelValue","onInput","onClear"])]),_:1})]),_:1}),t(S,{span:10,style:{"text-align":"right"}},{default:o(()=>[t(C,{style:{"margin-bottom":"5px"}},{default:o(()=>[t(j,{type:"primary",size:"medium",onClick:R},{default:o(()=>[p(h(e.$t("button.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),F("div",Se,[t(J,se({ref_key:"xGrid",ref:B,loading:i(q)},T.value),{index:o(({rowIndex:n})=>[p(h(n+1+(i(s).current-1)*i(s).pageSize),1)]),action:o(({row:n})=>[t(C,null,{default:o(()=>[t(x,{onClick:Z=>U(n)},{default:o(()=>[p("\u7F16\u8F91")]),_:2},1032,["onClick"]),t(x,{type:"text",onClick:Z=>W(n)},{default:o(()=>[p("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:o(()=>[t(Y,{ref_key:"xPagination",ref:A,current:i(s).current,"page-size":i(s).pageSize,total:i(s).total,"page-size-options":i($),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:P,onPageSizeChange:I},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),t(X,{visible:r.value,width:"auto","title-align":"start","mask-closable":!1,draggable:"",onOk:O,onCancel:a[5]||(a[5]=n=>r.value=!1)},{title:o(()=>[p(h(l.id?"\u7F16\u8F91\u5B57\u5178":"\u65B0\u5EFA\u5B57\u5178"),1)]),default:o(()=>[F("div",null,[t(Q,{ref_key:"submitFormRef",ref:c,model:l,style:{width:"600px"}},{default:o(()=>[t(f,{field:"type",label:e.$t("system.dict.filed.label.type"),rules:[{required:!0,message:e.$t("system.dict.filed.message.required.type")},{maxLength:64,message:"\u5B57\u5178\u957F\u5EA6\u6700\u5927\u4E0D\u80FD\u8D85\u8FC764"},{validator:N}],"validate-trigger":"blur"},{default:o(()=>[t(b,{modelValue:l.type,"onUpdate:modelValue":a[1]||(a[1]=n=>l.type=n),onBlur:M},null,8,["modelValue"])]),_:1},8,["label","rules"]),t(f,{field:"name",label:e.$t("system.dict.filed.label.name"),rules:[{required:!0,message:e.$t("system.dict.filed.message.required.name")}],"validate-trigger":"blur"},{default:o(()=>[t(b,{modelValue:l.name,"onUpdate:modelValue":a[2]||(a[2]=n=>l.name=n)},null,8,["modelValue"])]),_:1},8,["label","rules"]),t(f,{field:"code",label:e.$t("system.dict.filed.label.code"),rules:[{required:!0,message:e.$t("system.dict.filed.message.required.code")},{validator:i(G)}],"validate-trigger":"blur"},{default:o(()=>[t(b,{modelValue:l.code,"onUpdate:modelValue":a[3]||(a[3]=n=>l.code=n)},null,8,["modelValue"])]),_:1},8,["label","rules"]),t(f,{field:"description",label:e.$t("system.dict.filed.label.description")},{default:o(()=>[t(K,{modelValue:l.description,"onUpdate:modelValue":a[4]||(a[4]=n=>l.description=n),"show-word-limit":"","max-length":500},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["visible"])])}}});export{Re as default};
