import{h as U,a as ue,l as L,_ as Oe,J as Re}from"./index.e9d54774.js";/* empty css                *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as Ie,f as m,w as Ue,o as Ae,n as Be,aT as Ve,D as r,aH as y,aI as a,aS as l,u as d,aY as n,aZ as q,E as F,aU as I,aV as R,aW as p,H as _,G as We,bg as A,bX as ze,aP as $e,bo as Ke,a$ as we,aO as Pe,bK as He,be as qe,bY as Le,cJ as je,bv as Ge,bf as Je,a_ as Ne,b0 as Te,bp as Xe,a3 as Ye,bh as Ze,aN as Se,bt as Me,bi as Qe,bI as et,bJ as tt,c as xe,ce as at,bN as De,bz as ut,bq as de,h as Ee,aM as lt,bG as ot,bH as st,P as nt,cx as it,bE as rt,cM as dt,bB as pt}from"./arco.a97fe066.js";import{_ as ct}from"./index.vue_vue_type_script_setup_true_lang.dff799f7.js";/* empty css              *//* empty css               *//* empty css                */import{_ as mt,a as vt}from"./batch-assign-business.vue_vue_type_script_setup_true_lang.92520241.js";/* empty css                */import{A as ft,p as yt,z as gt,c as _t}from"./monitor-object.647fdfa2.js";import{f as bt}from"./dict.7add4266.js";import{i as Ft}from"./validate.dea67cb4.js";import{_ as Ct,a as Dt}from"./index.vue_vue_type_script_setup_true_lang.772ed500.js";import{q as Et}from"./business.22e8b088.js";import{w as kt}from"./tree-util.a8ddc3e6.js";import{d as ke}from"./index.127a6572.js";import{p as ht}from"./pagination.72a5f225.js";import{u as Bt}from"./router.2bf8d2ce.js";import{p as xt}from"./alert-record.078e7032.js";import{f as It}from"./app-instance.ab836c4c.js";import{u as At}from"./unit-util.2cbd6bbc.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";/* empty css                */import"./monitor-object-tag.71c4a187.js";import"./config-backup-device.df1a641e.js";import"./color.562bf6e9.js";import"./moment.a1678c09.js";const ce=[{name:"\u79D2",value:"s"},{name:"\u5206\u949F",value:"m"}],Vt={keyword:""},pe={hostName:"",displayName:"",useIp:!0,ip:"",dns:"",proxyId:"",proxyHostId:"",delay:1,delayUnit:"m",description:"",retryTimes:3,retryPriority:"HIGH",responseTime:5,responseUnit:"m",responseAvg:500,responsePriority:"WARN",packetLossDuration:5,packetLossUnit:"m",packetLossPercent:50,packetLossPriority:"WARN",tagIdList:[],businessId:"",enable:!0};function $t(c){return U.post("/ping/save",c)}function wt(c,V){return U.delete(`/ping/${c}/${V}`)}function Pt(c){return U.post("/ping/batchDelete",{monitorObjectCheckIds:c})}function Lt(c){return U.post("/ping/update",c)}function Nt(c){return U.post("/ping/pageList",c)}function Tt(c){return U.get(`/ping/getPingGlobalMacro/${c}`)}function St(c,V){return U.get(`/ping/${c}/${V}`)}function Mt(c,V){return U.get(`/ping/findPingByAppKeyAndIp/${c}/${V}`)}const he=c=>(et("data-v-6e115e6f"),c=c(),tt(),c),Ot=he(()=>_("div",null,"\u683C\u5F0F\uFF1A9.9.9.9",-1)),Rt={style:{display:"flex",width:"100%"}},Ut={style:{display:"flex","align-items":"center"}},Wt=he(()=>_("div",{style:{color:"var(--color-text-3)","font-size":"12px",width:"100px"}}," \u6570\u636E\u66F4\u65B0\u65F6\u95F4\u9891\u7387 ",-1)),zt={key:0},Kt={key:1},Ht=he(()=>_("span",null,"\u5FC5\u9700\u7684\u5B8F\u53D8\u91CF\u4E0D\u5B58\u5728\uFF0C\u8BF7\u68C0\u67E5\u540E\u53F0\u914D\u7F6E",-1)),qt=Ie({__name:"ping-save-drawer",props:{visible:{type:Boolean},ping:{},appKey:{}},emits:["ok","closeDrawer"],setup(c,{emit:V}){const{loading:$,setLoading:le}=ue(),{loading:me,setLoading:Y}=ue(),{loading:W,setLoading:Z}=ue(),{loading:k,setLoading:h}=ue(),B=c,N=V,x=m(),z=m(!1),u=m(L.cloneDeep(pe)),f=m([]),K=m([]),C=m([]),g=m(!1),j=m(!1),v=m({}),T=m(!1),S=i=>{Be(()=>{u.value[i]===void 0?(u.value[i]=pe[i],i==="delay"&&(u.value.delayUnit=pe.delayUnit)):i!=="responseAvg"&&(u.value[i]=Math.trunc(u.value[i]))})},oe=i=>{const e=L.find(f.value,{proxyid:i});e&&e.hostid?u.value.proxyHostId=e.hostid:u.value.proxyHostId=""},G=(i,e)=>e.title?e.title.toLowerCase().indexOf(i.toLowerCase())>-1:!1,J=async()=>{if(!await x.value.validate()){Y(!0);const e=A.info({content:"\u8FDE\u901A\u6027\u6D4B\u8BD5\u8FDB\u884C\u4E2D\uFF0C\u8BF7\u7A0D\u5019...",closable:!0,duration:6e4});try{j.value=(await ft(u.value)).data,e.close(),j.value?A.success("\u6D4B\u8BD5\u6210\u529F"):A.error("\u6D4B\u8BD5\u5931\u8D25")}catch(o){e&&e.close(),console.log(o)}finally{g.value=!0,Y(!1)}}},ve=async()=>{if(!await x.value.validate()){le(!0);try{u.value.useIp?u.value.dns="":u.value.ip="",z.value?(await Lt(L.cloneDeep(u.value)),A.success("\u66F4\u65B0\u6210\u529F")):(await $t(L.cloneDeep(u.value)),A.success("\u65B0\u5EFA\u6210\u529F")),N("ok")}finally{le(!1)}}},Q=()=>{u.value=L.cloneDeep(pe)},H=()=>!v.value["{$INTERVAL_TIME}"]||!v.value["{$ICMP_CONN_TIME}"]||!v.value["{$ICMP_RESPONSE_TIME}"]||!v.value["{$ICMP_RESPONSE_TIME_WARN}"]||!v.value["{$ICMP_LOSS_TIME}"]||!v.value["{$ICMP_LOSS_WARN}"],se=()=>{if(v.value["{$INTERVAL_TIME}"]){const i=String(v.value["{$INTERVAL_TIME}"]);u.value.delay=Number(i.substring(0,i.length-1)),u.value.delayUnit=i.substring(i.length-1)}if(v.value["{$ICMP_CONN_TIME}"]&&(u.value.retryTimes=Number(String(v.value["{$ICMP_CONN_TIME}"]).replace("#",""))),v.value["{$ICMP_RESPONSE_TIME}"]){const i=String(v.value["{$ICMP_RESPONSE_TIME}"]);u.value.responseTime=Number(i.substring(0,i.length-1)),u.value.responseUnit=i.substring(i.length-1)}if(v.value["{$ICMP_RESPONSE_TIME_WARN}"]&&(u.value.responseAvg=Number(v.value["{$ICMP_RESPONSE_TIME_WARN}"])*1e3),v.value["{$ICMP_LOSS_TIME}"]){const i=String(v.value["{$ICMP_LOSS_TIME}"]);u.value.packetLossDuration=Number(i.substring(0,i.length-1)),u.value.packetLossUnit=i.substring(i.length-1)}v.value["{$ICMP_LOSS_WARN}"]&&(u.value.packetLossPercent=Number(v.value["{$ICMP_LOSS_WARN}"]))},ne=async i=>{if(i){u.value.appKey=i,Z(!0),h(!0);try{f.value=(await yt(i)).data,f.value.length>0?u.value.proxyId?oe(u.value.proxyId):(u.value.proxyHostId=f.value[0].hostid,u.value.proxyId=f.value[0].proxyid):(f.value=[],u.value.proxyHostId="",u.value.proxyId=""),C.value=(await Et({})).data,C.value=C.value.filter(e=>e.id!=="0"&&e.id!=="-1"),kt(C.value,e=>{e.disabled=e.data.type==="FOLDER"})}catch(e){console.log(e)}finally{Z(!1),h(!1)}}},ie=m(""),fe=ke(async(i,e)=>{if(i!==ie.value){const{data:o}=await Mt(B.appKey,i);o&&o.length>0&&e("\u8BE5IP\u5DF2\u5B58\u5728")}},500);return Ue([()=>B.appKey,()=>B.ping],async([i,e])=>{Z(!0),h(!0),v.value=(await Tt(i)).data,T.value=H(),e&&e.id?(z.value=!0,u.value=L.cloneDeep(e),ie.value=L.cloneDeep(e.ip),e.businessDtos&&e.businessDtos.length>0?u.value.businessId=e.businessDtos[0].id:u.value.businessId="",e.tagDtos&&(u.value.tagIdList=e.tagDtos.map(o=>o.id)),await ne(e.appKey)):(z.value=!1,Q(),se(),await ne(i))},{deep:!0,immediate:!0}),Ae(async()=>{await Be(()=>{x.value&&x.value.clearValidate()}),K.value=(await bt("\u544A\u8B66\u7EA7\u522B")).data}),(i,e)=>{const o=ze,b=$e,D=Ke,w=we,E=Pe,M=He,P=qe,O=Ve("icon-font"),ye=Le,ge=je,_e=Ge,be=Je,ee=Ne,Fe=Te,X=Xe,Ce=Ye,re=Ze,te=Se,ae=Me,s=Qe;return r(),y(s,{title:(z.value?"\u7F16\u8F91":"\u65B0\u5EFA")+"Ping\u5BF9\u8C61",visible:B.visible,width:"50vw","mask-closable":!1,"unmount-on-close":"",onBeforeOpen:Q,onCancel:e[27]||(e[27]=t=>N("closeDrawer"))},{footer:a(()=>[l(ae,null,{default:a(()=>[l(te,{loading:d(me),onClick:J},{default:a(()=>[n(" \u8FDE\u901A\u6027\u6D4B\u8BD5 ")]),_:1},8,["loading"]),l(te,{loading:d($),disabled:T.value,type:"primary",onClick:ve},{default:a(()=>[n(" \u786E\u5B9A ")]),_:1},8,["loading","disabled"]),l(te,{onClick:e[26]||(e[26]=t=>N("closeDrawer"))},{default:a(()=>[n("\u53D6\u6D88")]),_:1})]),_:1})]),default:a(()=>[l(X,{ref_key:"formRef",ref:x,model:u.value,"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:a(()=>[l(o,{orientation:"left"},{default:a(()=>[n("\u57FA\u672C\u4FE1\u606F")]),_:1}),l(D,{field:"displayName",label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]},{default:a(()=>[l(b,{modelValue:u.value.displayName,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value.displayName=t),size:"small","show-word-limit":"","allow-clear":"","max-length":255},null,8,["modelValue"])]),_:1}),u.value.useIp?(r(),y(D,{key:0,label:"IP",field:"ip",required:u.value.useIp,"validate-trigger":"blur",rules:[{required:!0,message:"IP\u4E0D\u80FD\u4E3A\u7A7A"},{match:d(Ft),message:"IP\u683C\u5F0F\u4E0D\u5BF9"},{validator:d(fe)}]},{extra:a(()=>[Ot]),default:a(()=>[l(b,{modelValue:u.value.ip,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value.ip=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["required","rules"])):q("",!0),l(D,{label:"\u901A\u8FC7Proxy\u76D1\u63A7",field:"proxyId"},{default:a(()=>[l(M,{loading:d(W),style:{width:"100%"}},{default:a(()=>[l(E,{modelValue:u.value.proxyId,"onUpdate:modelValue":e[2]||(e[2]=t=>u.value.proxyId=t),placeholder:"\u8BF7\u9009\u62E9Proxy",onChange:oe},{default:a(()=>[(r(!0),F(I,null,R(f.value,t=>(r(),y(w,{key:t.host,value:t.proxyid},{default:a(()=>[t.host!=="no_proxy"?(r(),F(I,{key:0},[n(p(t.host+" ["+t.hostCount+"/"+t.suggestionCount+"]"),1)],64)):(r(),F(I,{key:1},[n(p(t.host),1)],64))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["loading"])]),_:1}),l(D,{label:"\u91C7\u96C6\u9891\u7387"},{default:a(()=>[_("div",Rt,[l(P,{modelValue:u.value.delay,"onUpdate:modelValue":e[3]||(e[3]=t=>u.value.delay=t),style:{width:"90%"},placeholder:"\u8BF7\u8F93\u5165\u91C7\u96C6\u9891\u7387","default-value":1,min:1,max:999999,onBlur:e[4]||(e[4]=t=>S("delay"))},null,8,["modelValue"]),_("div",Ut,[l(E,{modelValue:u.value.delayUnit,"onUpdate:modelValue":e[5]||(e[5]=t=>u.value.delayUnit=t),style:{width:"100px",margin:"0 10px"}},{default:a(()=>[(r(!0),F(I,null,R(d(ce),t=>(r(),y(w,{key:t.value,value:t.value},{default:a(()=>[n(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),Wt])])]),_:1}),l(D,{label:"\u76EE\u5F55"},{default:a(()=>[l(M,{loading:d(k),style:{width:"100%"}},{default:a(()=>[l(ge,{modelValue:u.value.businessId,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.businessId=t),"allow-search":!0,"allow-clear":!0,data:C.value,placeholder:"\u8BF7\u9009\u62E9","filter-tree-node":G,loading:d(k)},{"tree-slot-icon":a(({node:t})=>[l(O,{type:t.data.type==="FOLDER"?"icon-folder":"icon-cube",size:16,style:{color:"var(--color-text-2)"}},null,8,["type"])]),"tree-slot-title":a(t=>[_("span",null,p(t.title),1),l(ye,{style:{"margin-left":"8px"},color:t.data.type==="FOLDER"?"blue":"green"},{default:a(()=>[n(p(t.data.type==="FOLDER"?"\u6587\u4EF6\u5939":"\u8282\u70B9"),1)]),_:2},1032,["color"])]),_:1},8,["modelValue","data","loading"])]),_:1},8,["loading"])]),_:1}),l(D,{label:"\u6807\u7B7E"},{default:a(()=>[l(Ct,{modelValue:u.value.tagIdList,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value.tagIdList=t),multiple:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(D,{field:"desc",label:"\u5907\u6CE8"},{default:a(()=>[l(_e,{modelValue:u.value.description,"onUpdate:modelValue":e[8]||(e[8]=t=>u.value.description=t),"max-length":500,"allow-clear":"","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(D,{label:"\u542F\u7528\u76D1\u63A7"},{default:a(()=>[l(be,{modelValue:u.value.enable,"onUpdate:modelValue":e[9]||(e[9]=t=>u.value.enable=t),type:"line"},{checked:a(()=>[n("\u542F\u7528")]),unchecked:a(()=>[n("\u7981\u7528")]),_:1},8,["modelValue"])]),_:1}),l(o,{orientation:"left"},{default:a(()=>[n("\u544A\u8B66\u8BBE\u7F6E")]),_:1}),l(Fe,{style:{display:"flex","justify-content":"center","align-items":"center",padding:"20px 20px 20px 40px"}},{default:a(()=>[l(ee,{span:24},{default:a(()=>[n(" 1.\u544A\u8B66\u7B49\u7EA7 "),l(E,{modelValue:u.value.retryPriority,"onUpdate:modelValue":e[10]||(e[10]=t=>u.value.retryPriority=t),placeholder:"\u8BF7\u9009\u62E9\u544A\u8B66\u7EA7\u522B",style:{width:"90px"}},{default:a(()=>[(r(!0),F(I,null,R(K.value,t=>(r(),y(w,{key:t.code,value:t.code},{default:a(()=>[n(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),n(" \uFF1A\u6700\u8FD1 "),l(P,{modelValue:u.value.retryTimes,"onUpdate:modelValue":e[11]||(e[11]=t=>u.value.retryTimes=t),"default-value":2,min:1,max:999999,style:{width:"100px"},onBlur:e[12]||(e[12]=t=>S("retryTimes"))},null,8,["modelValue"]),n(" \u6B21\u8FDE\u63A5\u8D85\u65F6\uFF0C\u4F1A\u89E6\u53D1\u544A\u8B66 ")]),_:1}),l(ee,{span:24,style:{"padding-top":"10px"}},{default:a(()=>[n(" 2.\u544A\u8B66\u7B49\u7EA7 "),l(E,{modelValue:u.value.responsePriority,"onUpdate:modelValue":e[13]||(e[13]=t=>u.value.responsePriority=t),placeholder:"\u8BF7\u9009\u62E9\u544A\u8B66\u7EA7\u522B",style:{width:"90px"}},{default:a(()=>[(r(!0),F(I,null,R(K.value,t=>(r(),y(w,{key:t.code,value:t.code},{default:a(()=>[n(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),n(" \uFF1A\u6700\u8FD1 "),l(P,{modelValue:u.value.responseTime,"onUpdate:modelValue":e[14]||(e[14]=t=>u.value.responseTime=t),"default-value":1,min:1,max:999999,style:{width:"100px"},onBlur:e[15]||(e[15]=t=>S("responseTime"))},null,8,["modelValue"]),l(E,{modelValue:u.value.responseUnit,"onUpdate:modelValue":e[16]||(e[16]=t=>u.value.responseUnit=t),style:{width:"100px",margin:"0 10px"}},{default:a(()=>[(r(!0),F(I,null,R(d(ce),t=>(r(),y(w,{key:t.value,value:t.value},{default:a(()=>[n(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),n(" \u5185Ping\u68C0\u6D4B\u54CD\u5E94\u65F6\u95F4\u9AD8\u4E8E "),l(P,{modelValue:u.value.responseAvg,"onUpdate:modelValue":e[17]||(e[17]=t=>u.value.responseAvg=t),"default-value":200,min:.001,max:999999,style:{width:"100px"},onBlur:e[18]||(e[18]=t=>S("responseAvg"))},null,8,["modelValue"]),n(" \u6BEB\u79D2\uFF0C\u4F1A\u89E6\u53D1\u544A\u8B66 ")]),_:1}),l(ee,{span:24,style:{"padding-top":"10px"}},{default:a(()=>[n(" 3.\u544A\u8B66\u7B49\u7EA7 "),l(E,{modelValue:u.value.packetLossPriority,"onUpdate:modelValue":e[19]||(e[19]=t=>u.value.packetLossPriority=t),placeholder:"\u8BF7\u9009\u62E9\u544A\u8B66\u7EA7\u522B",style:{width:"90px"}},{default:a(()=>[(r(!0),F(I,null,R(K.value,t=>(r(),y(w,{key:t.code,value:t.code},{default:a(()=>[n(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),n(" \uFF1A\u6700\u8FD1 "),l(P,{modelValue:u.value.packetLossDuration,"onUpdate:modelValue":e[20]||(e[20]=t=>u.value.packetLossDuration=t),"default-value":1,min:1,max:999999,style:{width:"100px"},onBlur:e[21]||(e[21]=t=>S("packetLossDuration"))},null,8,["modelValue"]),l(E,{modelValue:u.value.packetLossUnit,"onUpdate:modelValue":e[22]||(e[22]=t=>u.value.packetLossUnit=t),style:{width:"100px",margin:"0 10px"}},{default:a(()=>[(r(!0),F(I,null,R(d(ce),t=>(r(),y(w,{key:t.value,value:t.value},{default:a(()=>[n(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),n(" \u5185\u4E22\u5305\u7387\u9AD8\u4E8E "),l(P,{modelValue:u.value.packetLossPercent,"onUpdate:modelValue":e[23]||(e[23]=t=>u.value.packetLossPercent=t),"default-value":50,min:1,max:999999,style:{width:"100px"},onBlur:e[24]||(e[24]=t=>S("packetLossPercent"))},null,8,["modelValue"]),n(" %\uFF0C\u4F1A\u89E6\u53D1\u544A\u8B66 ")]),_:1})]),_:1})]),_:1},8,["model"]),g.value?(r(),y(re,{key:0,style:We({bottom:T.value?"54px":"8px",position:"absolute",width:"98%"}),type:j.value?"success":"error"},{action:a(()=>[l(Ce,{style:{cursor:"pointer"},onClick:e[25]||(e[25]=t=>g.value=!1)})]),default:a(()=>[j.value?(r(),F("span",zt,"\u6D4B\u8BD5\u6210\u529F")):(r(),F("span",Kt,"\u6D4B\u8BD5\u5931\u8D25"))]),_:1},8,["style","type"])):q("",!0),T.value?(r(),y(re,{key:1,style:{bottom:"8px",position:"absolute",width:"98%"},type:"normal"},{default:a(()=>[Ht]),_:1})):q("",!0)]),_:1},8,["title","visible"])}}});const jt=Oe(qt,[["__scopeId","data-v-6e115e6f"]]),Gt={class:"page-container"},Jt={class:"page-panel"},Xt={style:{display:"flex"}},Yt={style:{"justify-content":"flex-end","margin-left":"auto"}},Zt={key:0},Qt={class:"selected-count"},ea={style:{height:"calc(100vh - 150px)"}},ta={style:{color:"var(--color-bg-5)"}},aa="detect",Ta=Ie({__name:"index",setup(c){const{openInNewTab:V}=Bt(),{pagination:$,pageSizeOptions:le}=ht(),{loading:me,setLoading:Y}=ue(),W=m(),Z=m(),k=m(L.cloneDeep(Vt)),h=m(!1),B=m([]),N=m(""),x=m(),z=m([{type:"checkbox",width:40},{title:"\u76D1\u63A7\u5BF9\u8C61",field:"displayName",minWidth:200,slots:{default:"displayName"},showOverflow:"ellipsis"},{title:"IP",field:"ip",minWidth:110},{title:"\u542F\u7528\u72B6\u6001",field:"enable",slots:{default:"enable"},minWidth:100},{title:"\u544A\u8B66\u72B6\u6001",slots:{default:"hostPriority"},minWidth:70},{title:"\u8FDE\u901A\u6027",field:"connectValue",slots:{default:"connectValue"},minWidth:70},{title:"\u76EE\u5F55",field:"business",slots:{default:"business"},minWidth:150},{title:"\u54CD\u5E94\u65F6\u95F4",field:"responseTimeValue",slots:{default:"responseTimeValue"},minWidth:90},{title:"\u4E22\u5305\u7387",field:"packageLossValue",slots:{default:"packageLossValue"},minWidth:150},{title:"\u91C7\u96C6\u9891\u7387",field:"delay",minWidth:90,slots:{default:"delay"}},{title:"proxy",field:"proxyName",minWidth:100,showOverflow:"ellipsis"},{title:"\u6807\u7B7E",field:"tag",slots:{default:"tag"},minWidth:150},{title:"\u5907\u6CE8",field:"description",width:150}]);Re()||z.value.push({title:"\u64CD\u4F5C",field:"action",slots:{default:"action"},fixed:"right",minWidth:160});const u=m({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"checkId",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:z.value}),f=xe(()=>{const e=W.value,o=[];return e&&(o.push(...e.getCheckboxRecords().map(b=>`${b.checkId}`)),o.push(...e.getCheckboxReserveRecords().map(b=>`${b.checkId}`))),o}),K=xe(()=>{const e=W.value,o=[];return e&&(o.push(...e.getCheckboxRecords()),o.push(...e.getCheckboxReserveRecords())),o}),C=()=>{const e=W.value;e&&(e.clearCheckboxReserve(),e.clearCheckboxRow())},g=async()=>{Y(!0);const e={...k.value,page:$},o=W.value;try{const{data:b}=await Nt(e);$.total=b.totalElements,o&&await o.loadData(b.content)}catch(b){console.log(b)}finally{Y(!1)}},j=e=>{$.current=e,g()},v=e=>{$.pageSize=e,g()},T=ke(async()=>{await g()},500),S=ke(async()=>{await g()},500),oe=e=>{k.value.priorityList=e,g()},G=m(!1),J=m(!1),ve=async e=>{de.confirm({title:"\u63D0\u793A",simple:!1,draggable:!0,closable:!1,titleAlign:"start",content:"\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u6240\u9009\u5BF9\u8C61 , \u662F\u5426\u7EE7\u7EED?",async onOk(){try{await Pt(e),await g(),A.success("\u5220\u9664\u6210\u529F"),C()}catch{A.error("\u5220\u9664\u5931\u8D25")}}})},Q=async(e,o)=>{de.confirm({title:"\u63D0\u793A",simple:!1,draggable:!0,closable:!1,titleAlign:"start",content:`\u6B64\u64CD\u4F5C\u5C06${o?"\u542F\u7528":"\u7981\u7528"}\u6240\u9009\u5BF9\u8C61 , \u662F\u5426\u7EE7\u7EED?`,async onOk(){try{await _t(e,o),await g(),A.success(`${o?"\u542F\u7528":"\u7981\u7528"}\u6210\u529F`),C()}catch{A.error(`${o?"\u542F\u7528":"\u7981\u7528"}\u5931\u8D25`)}}})},H=e=>{e==="batchAssignTag"?G.value=!0:e==="batchAssignBusiness"?J.value=!0:e==="batchDelete"?ve(f.value):e==="batchOpen"?Q(f.value,!0):e==="batchClose"&&Q(f.value,!1)},se=e=>{N.value=e,x.value=void 0,h.value=!0},ne=async e=>{e.editLoading=!0;try{const{data:o}=await St(e.appKey,e.hostId);o.hostPriority=e.hostPriority,o.proxyName=e.proxyName,o.tagDtos=e.tagDtos,o.businessDtos=e.businessDtos,x.value=L.cloneDeep(o),N.value=o.appKey,h.value=!0}catch(o){console.log(o)}finally{e.editLoading=!1}},ie=e=>{de.confirm({title:"\u63D0\u793A",simple:!1,draggable:!0,closable:!1,titleAlign:"start",content:()=>Ee("div",["\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45",Ee("span",{style:"color: rgb(var(--danger-6))"},"\u5220\u9664"),'Ping\u8BBE\u5907"',Ee("span",{style:"color: rgb(var(--primary-6))"},e.displayName),'"\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F']),onOk:async()=>{await wt(e.appKey,e.hostId),await g()}})},fe=e=>{de.confirm({title:"\u63D0\u793A",simple:!1,draggable:!0,closable:!1,titleAlign:"start",content:`\u6B64\u64CD\u4F5C\u5C06\u5237\u65B0Ping\u5BF9\u8C61"${e.displayName}"\u7684\u6570\u636E,\u662F\u5426\u7EE7\u7EED?`,onOk:async()=>{await gt(e.appKey,e.hostId),A.success("\u8BF7\u6C42\u6210\u529F"),await g()}})},i=()=>{x.value=void 0,N.value="",h.value=!1,g()};return Ae(async()=>{await g(),B.value=(await It("ZABBIX")).data}),(e,o)=>{const b=$e,D=we,w=Pe,E=Me,M=lt,P=Se,O=ot,ye=st,ge=nt,_e=it,be=Ne,ee=Te,Fe=rt,X=Le,Ce=dt,re=pt,te=Ve("vxe-grid"),ae=at("read-only");return r(),F("div",Gt,[_("div",Jt,[l(ee,null,{default:a(()=>[l(be,{span:24},{default:a(()=>[_("div",Xt,[l(E,{style:{"margin-bottom":"5px"}},{default:a(()=>[l(b,{modelValue:k.value.keyword,"onUpdate:modelValue":o[0]||(o[0]=s=>k.value.keyword=s),style:{width:"180px"},placeholder:"\u76D1\u63A7\u5BF9\u8C61/IP/\u5907\u6CE8","allow-clear":"",onInput:d(T),onClear:d(T),onPressEnter:d(T)},null,8,["modelValue","onInput","onClear","onPressEnter"]),l(w,{modelValue:k.value.enable,"onUpdate:modelValue":o[1]||(o[1]=s=>k.value.enable=s),style:{width:"110px"},placeholder:"\u542F\u7528\u72B6\u6001","allow-clear":"",onChange:d(S)},{default:a(()=>[l(D,{value:!0},{default:a(()=>[n("\u5DF2\u542F\u7528")]),_:1}),l(D,{value:!1},{default:a(()=>[n("\u5DF2\u505C\u7528")]),_:1})]),_:1},8,["modelValue","onChange"]),l(Dt,{"query-params":k.value,"category-code":aa,onCheck:oe},null,8,["query-params"])]),_:1}),_("div",Yt,[l(E,null,{default:a(()=>[f.value.length>0?(r(),F("span",Zt,[_("span",Qt," \u5DF2\u9009\u62E9\u4E86"+p(f.value.length)+"\u6761 ",1),l(M,{onClick:C},{default:a(()=>[n("\u6E05\u7A7A")]),_:1})])):q("",!0),l(ct,{onClick:g}),B.value.length===1?De((r(),y(P,{key:1,type:"primary",onClick:o[2]||(o[2]=s=>se(B.value[0].id))},{default:a(()=>[n(" \u65B0\u5EFA ")]),_:1})),[[ae]]):q("",!0),B.value.length>1?De((r(),y(ye,{key:2,trigger:"hover"},{content:a(()=>[(r(!0),F(I,null,R(B.value,s=>(r(),y(O,{key:s.id,onClick:t=>se(s.id)},{default:a(()=>[n(p(s.name),1)]),_:2},1032,["onClick"]))),128))]),default:a(()=>[l(P,null,{default:a(()=>[n("\u65B0\u5EFA")]),_:1})]),_:1})),[[ae]]):q("",!0),De((r(),y(_e,{"content-class":"monitor-object-table-container","render-to-body":!1},{icon:a(()=>[l(ge)]),content:a(()=>[l(O,{disabled:f.value.length===0,onClick:o[3]||(o[3]=s=>H("batchAssignBusiness"))},{default:a(()=>[n(" \u5206\u914D\u76EE\u5F55 ")]),_:1},8,["disabled"]),l(O,{disabled:f.value.length===0,onClick:o[4]||(o[4]=s=>H("batchAssignTag"))},{default:a(()=>[n(" \u5206\u914D\u6807\u7B7E ")]),_:1},8,["disabled"]),l(O,{disabled:f.value.length===0,onClick:o[5]||(o[5]=s=>H("batchDelete"))},{default:a(()=>[n(" \u6279\u91CF\u5220\u9664 ")]),_:1},8,["disabled"]),l(O,{disabled:f.value.length===0,onClick:o[6]||(o[6]=s=>H("batchOpen"))},{default:a(()=>[n(" \u6279\u91CF\u542F\u7528 ")]),_:1},8,["disabled"]),l(O,{disabled:f.value.length===0,onClick:o[7]||(o[7]=s=>H("batchClose"))},{default:a(()=>[n(" \u6279\u91CF\u7981\u7528 ")]),_:1},8,["disabled"])]),default:a(()=>[n(" \u64CD\u4F5C ")]),_:1})),[[ae]])]),_:1})])])]),_:1})]),_:1}),_("div",ea,[l(te,ut({ref_key:"xGrid",ref:W,loading:d(me)},u.value),{displayName:a(({row:s})=>[l(Fe,null,{content:a(()=>[_("div",null,"\u5BF9\u8C61\u540D\u79F0\uFF1A"+p(s.displayName),1),_("div",null," \u76EE\u5F55\uFF1A"+p(s.businessDtos.map(t=>t.name).join("\uFF0C")||"--"),1),_("div",null,"\u5907\u6CE8\uFF1A"+p(s.description?s.description:"--"),1)]),default:a(()=>[l(M,{hoverable:!1,style:{"font-size":"12px"},onClick:t=>d(V)({name:"MonitorObjectDetail",query:{appKey:s.appKey,hostId:s.hostId,backVisible:"hide"}})},{default:a(()=>[n(p(s.displayName),1)]),_:2},1032,["onClick"])]),_:2},1024)]),enable:a(({row:s})=>[n(p(s.enable?"\u5DF2\u542F\u7528":"\u5DF2\u505C\u7528"),1)]),hostPriority:a(({row:s})=>[s.hostPriority?(r(),y(X,{key:0,color:`rgb(var(--${(s.hostPriority?s.hostPriority:"").toLowerCase()}-6))`},{default:a(()=>[_("span",ta,p(d(xt)[s.hostPriority]),1)]),_:2},1032,["color"])):(r(),y(X,{key:1,color:"green"},{default:a(()=>[n("\u6B63\u5E38")]),_:1}))]),delay:a(({row:s})=>[n(p(s.delay)+p(d(ce).filter(t=>t.value===s.delayUnit)[0].name),1)]),business:a(({row:s})=>[_("span",null,p(s.businessDtos.map(t=>t.name).join("\uFF0C")||"--"),1)]),connectValue:a(({row:s})=>[s.connectValue==="1"?(r(),y(X,{key:0,color:"green"},{default:a(()=>[n("\u6B63\u5E38")]),_:1})):(r(),y(X,{key:1,color:"red"},{default:a(()=>[n("\u4E2D\u65AD")]),_:1}))]),responseTimeValue:a(({row:s})=>[n(p(s.responseTimeValue==="0"||!s.responseTimeValue?0:(Number(s.responseTimeValue)*1e3).toFixed(2))+"ms ",1)]),packageLossValue:a(({row:s})=>[l(Ce,{percent:Number(d(At)("%",Number(s.packageLossValue/100),!1)),status:Number(s.packageLossValue)>s.packetLossPercent?"danger":"normal",style:{width:"100%"}},null,8,["percent","status"])]),tag:a(({row:s})=>[_("span",null,p(s.tagDtos.map(t=>t.name).join("\uFF0C")||"--"),1)]),action:a(({row:s})=>[l(E,null,{default:a(()=>[l(M,{hoverable:!1,loading:s.editLoading,onClick:t=>ne(s)},{default:a(()=>[n(" \u7F16\u8F91 ")]),_:2},1032,["loading","onClick"]),l(M,{onClick:t=>fe(s)},{default:a(()=>[n("\u8BF7\u6C42")]),_:2},1032,["onClick"]),l(M,{onClick:t=>ie(s)},{default:a(()=>[n("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:a(()=>[l(re,{ref_key:"xPagination",ref:Z,current:d($).current,"page-size":d($).pageSize,total:d($).total,"page-size-options":d(le),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:j,onPageSizeChange:v},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])]),h.value?(r(),y(jt,{key:0,ping:x.value,"app-key":N.value,visible:h.value,onOk:i,onCloseDrawer:o[8]||(o[8]=s=>h.value=!1)},null,8,["ping","app-key","visible"])):q("",!0),l(mt,{visible:G.value,records:K.value,"check-keys":f.value,onOk:o[9]||(o[9]=s=>{G.value=!1,g(),C()}),onCancel:o[10]||(o[10]=s=>G.value=!1)},null,8,["visible","records","check-keys"]),l(vt,{visible:J.value,records:K.value,"check-keys":f.value,onOk:o[11]||(o[11]=s=>{J.value=!1,g(),C()}),onCancel:o[12]||(o[12]=s=>J.value=!1)},null,8,["visible","records","check-keys"])])])}}});export{Ta as default};
