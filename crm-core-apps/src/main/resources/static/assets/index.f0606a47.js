import{d as v,f as m,r as W,o as O,aT as j,D as g,E as h,aS as o,aI as i,u as n,H as S,aY as f,aW as _,aZ as N,aH as q,bz as G,aP as Y,c9 as Z,bt as J,a_ as K,b0 as Q,bY as X,aM as ee,bB as te}from"./arco.a97fe066.js";import{h as z,a as ae}from"./index.e9d54774.js";/* empty css                *//* empty css               *//* empty css               *//* empty css                */import{d as ne}from"./index.127a6572.js";import{p as oe}from"./pagination.72a5f225.js";import{d as se}from"./global.90f51a62.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang.dff799f7.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";function le(u){return z.post("/zabbixReportSendHistory/pageList",u)}function re(u){return z.post(`/zabbixReportSendHistory/downloadAttach/${u}`,{},{responseType:"blob",timeout:36e5})}const ue={style:{height:"calc(100vh - 146px)"}},de={key:0},ce=v({__name:"list",setup(u,{expose:y}){const{loading:x,setLoading:C}=ae(!1),{pagination:s,pageSizeOptions:B}=oe(),F=m(),E=m(),k=m({size:"mini",height:"auto",columnConfig:{resizable:!0},showOverflow:"tooltip",columns:[{title:"\u62A5\u8868\u540D\u79F0",field:"reportName",minWidth:120},{title:"\u62A5\u8868\u7C7B\u578B",field:"reportTypeName",minWidth:120},{title:"\u8BA2\u9605\u5468\u671F",field:"periodName",minWidth:120},{title:"\u8BA2\u9605\u4EBA",field:"subscribeUserName",minWidth:120},{title:"\u53D1\u9001\u5F00\u59CB\u65F6\u95F4",field:"sendStartTime",width:160},{title:"\u53D1\u9001\u7ED3\u675F\u65F6\u95F4",field:"sendEndTime",width:160},{title:"\u53D1\u9001\u65B9\u5F0F",field:"sendTypeName",slots:{default:"sendTypeName"},width:160},{title:"\u53D1\u9001\u7ED3\u679C",field:"sendResultName",slots:{default:"sendResultName"},width:80},{title:"\u5931\u8D25\u539F\u56E0",field:"errorMessage",width:200},{title:"\u64CD\u4F5C",fixed:"right",field:"attachFilePath",slots:{default:"attachFilePath"},width:100}]}),l=W({reportName:"",subscribeUserName:""}),d=async(t={...l,page:s})=>{C(!0);const a=F.value;try{const{data:r}=await le(t);s.total=r.totalElements,a&&await a.reloadData(r.content)}catch(r){console.error(r)}finally{C(!1)}},D=t=>{s.current=t,d()},T=t=>{s.pageSize=t,d()},c=()=>{d()},A=t=>{t?[l.sendBeginTime,l.sendEndTime]=t:(l.sendBeginTime=void 0,l.sendEndTime=void 0),s.current=1,c()},p=ne(async()=>{await d()},500),P=t=>t.sendResult==="SUCCESS"?"green":t.sendResult==="FAILURE"?"red":"gold",b=m([]),R=async t=>{try{t.attachFileLoading=!0,se(await re(t.id))}catch(a){console.error(a)}finally{t.attachFileLoading=!1}};return O(()=>{d()}),y({search:c}),(t,a)=>{const r=Y,V=Z,L=J,w=K,I=Q,U=X,$=ee,H=te,M=j("vxe-grid");return g(),h("div",null,[o(I,null,{default:i(()=>[o(w,{span:14},{default:i(()=>[o(L,{style:{"margin-bottom":"5px"}},{default:i(()=>[o(r,{modelValue:l.reportName,"onUpdate:modelValue":a[0]||(a[0]=e=>l.reportName=e),style:{width:"200px"},placeholder:"\u62A5\u8868\u540D\u79F0","allow-clear":"",onSearch:c,onInput:n(p),onClear:n(p)},null,8,["modelValue","onInput","onClear"]),o(r,{modelValue:l.subscribeUserName,"onUpdate:modelValue":a[1]||(a[1]=e=>l.subscribeUserName=e),style:{width:"200px"},placeholder:"\u8BA2\u9605\u4EBA","allow-clear":"",onSearch:c,onInput:n(p),onClear:n(p)},null,8,["modelValue","onInput","onClear"]),o(V,{"model-value":b.value,"onUpdate:modelValue":a[2]||(a[2]=e=>b.value=e),style:{width:"360px"},"show-time":"",onChange:A},null,8,["model-value"])]),_:1})]),_:1}),o(w,{span:10,style:{display:"flex","align-items":"center","justify-content":"end","margin-top":"8px"}},{default:i(()=>[o(ie,{onClick:a[3]||(a[3]=e=>{n(s).current=1,c()})})]),_:1})]),_:1}),S("div",ue,[o(M,G({ref_key:"xGrid",ref:F,loading:n(x)},k.value),{index:i(({rowIndex:e})=>[f(_(e+1+(n(s).current-1)*n(s).pageSize),1)]),sendTypeName:i(({row:e})=>[e.sendType==="MAIL"?(g(),h("span",de,"\u90AE\u4EF6("+_(e.sendMail)+")",1)):N("",!0)]),sendResultName:i(({row:e})=>[o(U,{size:"small",bordered:"",color:P(e)},{default:i(()=>[f(_(e.sendResultName),1)]),_:2},1032,["color"])]),attachFilePath:i(({row:e})=>[e.attachFilePath?(g(),q($,{key:0,style:{"font-size":"12px"},hoverable:!1,loading:e.attachFileLoading,onClick:ge=>R(e)},{default:i(()=>[f(" \u4E0B\u8F7D\u9644\u4EF6 ")]),_:2},1032,["loading","onClick"])):N("",!0)]),pager:i(()=>[o(H,{ref_key:"xPagination",ref:E,current:n(s).current,"page-size":n(s).pageSize,total:n(s).total,"page-size-options":n(B),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:D,onPageSizeChange:T},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])])}}}),pe={class:"page-container"},me={class:"page-panel"},ze=v({__name:"index",setup(u){return(y,x)=>(g(),h("div",pe,[S("div",me,[o(ce,{ref:"subscribeSendHistoryRef"},null,512)])]))}});export{ze as default};
