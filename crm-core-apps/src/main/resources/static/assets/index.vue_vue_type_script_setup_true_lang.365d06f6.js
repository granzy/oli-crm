import{a as J,l as v,N as X,O as Z}from"./index.e9d54774.js";/* empty css               */import{d as $,f as c,w as B,r as ee,c as ae,aT as te,D as w,aH as E,aI as i,aY as k,aS as r,aW as I,H as L,bz as oe,u as m,aP as ne,aN as le,bt as F,a_ as se,b0 as ue,bB as ie,bi as re,E as q,aU as U,aV as ce,aM as de,bY as pe}from"./arco.a97fe066.js";/* empty css                */import{p as me}from"./pagination.72a5f225.js";const ge={style:{height:"calc(100vh - 180px)"}},ve=$({__name:"draw-select",props:{modelValue:{},visible:{type:Boolean,default:!1}},emits:["update:modelValue","ok","cancel"],setup(x,{emit:C}){const{pagination:e,pageSizeOptions:f}=me(),{loading:g,setLoading:b}=J(!1),d=x,n=c([]);B(()=>d.modelValue,a=>{n.value=v.cloneDeep(a)},{deep:!0,immediate:!0});const _=C,h=c(),V=c(),t=c({size:"mini",height:"auto",columnConfig:{resizable:!0},showOverflow:"tooltip",rowConfig:{isHover:!0,keyField:"id"},columns:[{type:"checkbox",width:40},{title:"\u7528\u6237\u540D\u79F0",field:"username",minWidth:120}]}),l=ee({queryStr:""});let y=[];const S=()=>{const a=h.value;y.forEach(s=>{const o=s.id,p=n.value.indexOf(o)!==-1;a.getRowById(o)&&a.setCheckboxRow(a.getRowById(o),p)})},D=()=>{e.current=1,l.queryStr=""},u=async(a={...l,page:e})=>{b(!0);try{const s=h.value,{data:o}=await X(a);e.total=o.totalElements,s&&(await s.loadData(o.content),y=o.content)}catch(s){console.error(s)}finally{b(!1),S()}},O=a=>{e.current=a,u()},N=a=>{e.pageSize=a,u()},R=a=>{const{checked:s,row:o}=a;s?n.value.push(o.id):n.value=n.value.filter(p=>p!==o.id)},P=ae(()=>y.map(a=>a.id)),H=a=>{const{checked:s}=a;if(s){const o=P.value.filter(p=>!n.value.includes(p));n.value.push(...o)}else n.value=n.value.filter(o=>!P.value.includes(o))},T=()=>{e.current=1,u()},A=()=>{n.value=v.cloneDeep(d.modelValue),_("cancel")},G=()=>{_("update:modelValue",n.value),_("ok")};return(a,s)=>{const o=ne,p=le,W=F,Y=se,j=ue,K=ie,M=te("vxe-grid"),Q=re;return w(),E(Q,{width:720,visible:a.visible,"mask-closable":!1,onOk:G,onCancel:A,onBeforeOpen:D,onOpen:u},{title:i(()=>[k("\u7528\u6237\u5217\u8868")]),default:i(()=>[r(j,null,{default:i(()=>[r(Y,{span:14},{default:i(()=>[r(W,{style:{"margin-bottom":"5px"}},{default:i(()=>[r(o,{modelValue:l.queryStr,"onUpdate:modelValue":s[0]||(s[0]=z=>l.queryStr=z),style:{width:"320px"},placeholder:"\u7528\u6237\u540D\u79F0/\u767B\u5F55\u540D\u79F0","allow-clear":""},null,8,["modelValue"]),r(p,{type:"primary",size:"medium",onClick:T},{default:i(()=>[k(I(a.$t("button.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),L("div",ge,[r(M,oe({ref_key:"xGrid",ref:h,loading:m(g)},t.value,{onCheckboxChange:R,onCheckboxAll:H}),{index:i(({rowIndex:z})=>[k(I(z+1+(m(e).current-1)*m(e).pageSize),1)]),pager:i(()=>[r(K,{ref_key:"xPagination",ref:V,current:m(e).current,"page-size":m(e).pageSize,total:m(e).total,"page-size-options":m(f),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:O,onPageSizeChange:N},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),_:1},8,["visible"])}}}),be=$({__name:"index",props:{modelValue:{}},emits:["update:modelValue","ok","cancel","close"],setup(x,{emit:C}){const e=c([]),f=c([]),g=c(!1),b=x,d=C,n=c(),_=async t=>{if(t&&t.length>0){const{data:l}=await Z(t);n.value=l}else n.value=[]};B(()=>e,t=>{_(t.value),f.value=v.cloneDeep(t.value)},{deep:!0,immediate:!0}),B(()=>b.modelValue,t=>{v.isEqual(t,f.value)||(e.value=v.cloneDeep(t),f.value=v.cloneDeep(t))},{deep:!0,immediate:!0});const h=()=>{g.value=!1,d("update:modelValue",e.value),d("ok",e.value)},V=t=>{e.value=e.value.filter(l=>l!==t.id),d("update:modelValue",e.value),d("close",t)};return(t,l)=>{const y=de,S=pe,D=F;return w(),q(U,null,[r(ve,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=u=>e.value=u),visible:g.value,onOk:h,onCancel:l[1]||(l[1]=u=>g.value=!1)},null,8,["modelValue","visible"]),L("div",null,[r(D,{direction:"vertical",fill:""},{default:i(()=>[r(y,{style:{"margin-top":"4px"},onClick:l[2]||(l[2]=u=>g.value=!0)},{default:i(()=>[k(" \u9009\u62E9\u7528\u6237 ")]),_:1}),L("div",null,[(w(!0),q(U,null,ce(n.value,u=>(w(),E(S,{key:u.id,style:{"margin-right":"6px","margin-bottom":"6px"},closable:"",onClose:O=>V(u)},{default:i(()=>[k(I(u.username),1)]),_:2},1032,["onClose"]))),128))])]),_:1})])],64)}}});export{be as _};
