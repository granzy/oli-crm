import{l as R,a1 as q,a as H}from"./index.e9d54774.js";/* empty css                *//* empty css               *//* empty css               */import{d as O,f as m,r as I,D as F,aH as $,aI as t,aY as f,aW as x,H as k,aS as e,E as M,aU as G,aV as W,aZ as Y,u as d,bg as T,n as Z,bY as j,bt as L,bh as J,aP as K,bo as Q,bv as X,bp as ee,bi as te,o as ae,aT as oe,bz as ne,bq as se,a_ as ie,aN as le,b0 as ue,aM as re,bB as ce}from"./arco.a97fe066.js";import{p as me}from"./pagination.72a5f225.js";import{s as de,g as pe,a as fe,d as ge}from"./executable-script.a4963186.js";/* empty css              *//* empty css               */import{d as _e}from"./index.127a6572.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang.a6146e11.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";const be=O({__name:"form",props:{visible:{type:Boolean,default:!1},initForm:{},scriptArgs:{}},emits:["ok","cancel"],setup(N,{emit:h}){const g=N,l=h,_=m(),a=I({name:"",content:"",language:"shell",comments:""}),C=m(),A=async()=>{var o;await _.value.validate()?console.warn("\u9A8C\u8BC1\u4E0D\u901A\u8FC7"):(a.content=((o=C.value.getEditor())==null?void 0:o.getValue())||"",await de(a),T.success("\u63D0\u4EA4\u6210\u529F"),l("ok"))},D=()=>{a.id="",a.name="",a.content="",a.comments=""},y=m(""),p=async()=>{g.initForm?(R.assign(a,g.initForm),y.value=R.cloneDeep(g.initForm.name),_.value&&_.value.validate()):await Z(()=>{D()})},V=_e(async(n,o)=>{if(n!==y.value){const{data:v}=await pe(n);v&&o("\u8BE5\u540D\u79F0\u5DF2\u5B58\u5728")}},500),z=()=>{l("cancel")};return(n,o)=>{const v=q,S=j,s=L,i=J,u=K,b=Q,w=X,P=ee,B=te;return F(),$(B,{visible:n.visible,width:"50vw","title-align":"start","mask-closable":!1,"unmount-on-close":"",onOk:A,onCancel:z,onBeforeOpen:p},{title:t(()=>[f(x(a.id?"\u7F16\u8F91\u811A\u672C":"\u65B0\u5EFA\u811A\u672C"),1)]),default:t(()=>[k("div",null,[n.scriptArgs?(F(),$(i,{key:0,banner:"",style:{"margin-bottom":"1em"}},{icon:t(()=>[e(v,{style:{color:"#e6a23c"}})]),default:t(()=>[f(" \u652F\u6301\u4F20\u9012\u4EE5\u4E0B\u53C2\u6570: "),e(s,null,{default:t(()=>[(F(!0),M(G,null,W(n.scriptArgs,(r,E)=>(F(),$(S,{key:E,color:"#168cff",size:"small",style:{padding:"0 2px"}},{default:t(()=>[f(" $"+x(E+1)+"("+x(r)+") ",1)]),_:2},1024))),128))]),_:1})]),_:1})):Y("",!0),e(P,{ref_key:"submitFormRef",ref:_,model:a,"label-col-props":{span:3,offset:0},"wrapper-col-props":{span:21,offset:0}},{default:t(()=>[e(b,{field:"name",label:"\u811A\u672C\u540D\u79F0","validate-trigger":"blur",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u811A\u672C\u540D\u79F0"},{validator:d(V)}]},{default:t(()=>[e(u,{modelValue:a.name,"onUpdate:modelValue":o[0]||(o[0]=r=>a.name=r),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["rules"]),e(b,{field:"content",label:"\u811A\u672C\u5185\u5BB9","validate-trigger":"blur"},{default:t(()=>[e(ve,{ref_key:"MonacoEditRef",ref:C,modelValue:a.content,"onUpdate:modelValue":o[1]||(o[1]=r=>a.content=r),"editor-option":{readOnly:!1,minimap:{enabled:!1},contextmenu:!1},style:{border:"1px solid var(--color-border-3)"},height:600,language:"shell"},null,8,["modelValue"])]),_:1}),e(b,{field:"comments",label:"\u5907\u6CE8","validate-trigger":"blur"},{default:t(()=>[e(w,{modelValue:a.comments,"onUpdate:modelValue":o[2]||(o[2]=r=>a.comments=r),"auto-size":{minRows:2,maxRows:3}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),Fe={class:"page-container"},Ce={class:"page-panel"},ye={style:{height:"calc(100vh - 145px)"}},Re=O({__name:"script",setup(N){const{loading:h,setLoading:g}=H(!1),{pagination:l,pageSizeOptions:_}=me(),a=m(),C=m(),A=m(["IP","\u4E3B\u673A\u540D","\u7CFB\u7EDF\u67B6\u6784","\u7CFB\u7EDF\u7C7B\u578B","\u7CFB\u7EDF\u7248\u672C","Zabbix IP","Agent\u5143\u6570\u636E","\u5B89\u88C5\u5305\u8DEF\u5F84"]),D=m({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"id",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:[{title:"\u811A\u672C\u540D\u79F0",field:"name",minWidth:120},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",width:150},{title:"\u4FEE\u6539\u65F6\u95F4",field:"updateTime",width:150},{title:"\u5907\u6CE8",field:"comments",width:150},{title:"\u64CD\u4F5C",width:120,fixed:"right",slots:{default:"action"}}]}),y=I({}),p=async(s={...y,page:l})=>{g(!0);const i=a.value;try{const{data:u}=await fe(s);l.total=u.totalElements,i&&await i.reloadData(u.content)}catch(u){console.error(u)}finally{g(!1)}},V=s=>{l.current=s,p()},z=s=>{l.pageSize=s,p()},n=m(!1),o=m(),v=s=>{o.value=R.cloneDeep(s),n.value=!0},S=s=>{se.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,content:`\u786E\u5B9A\u5220\u9664\u811A\u672C${s.name}\u5417?`,onOk:async()=>{await ge(s.id),T.success("\u5220\u9664\u6210\u529F"),await p()}})};return ae(()=>{p()}),(s,i)=>{const u=ie,b=le,w=L,P=ue,B=re,r=ce,E=oe("vxe-grid");return F(),M("div",Fe,[k("div",Ce,[k("div",null,[e(P,null,{default:t(()=>[e(u,{span:14}),e(u,{span:10,style:{"text-align":"right"}},{default:t(()=>[e(w,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(b,{type:"primary",onClick:i[0]||(i[0]=c=>{o.value=void 0,n.value=!0})},{default:t(()=>[f(" \u65B0\u5EFA ")]),_:1})]),_:1})]),_:1})]),_:1}),k("div",ye,[e(E,ne({ref_key:"xGrid",ref:a,loading:d(h)},D.value),{index:t(({rowIndex:c})=>[f(x(c+1+(d(l).current-1)*d(l).pageSize),1)]),action:t(({row:c})=>[e(w,null,{default:t(()=>[e(B,{type:"text",onClick:U=>v(c)},{default:t(()=>[f("\u7F16\u8F91")]),_:2},1032,["onClick"]),e(B,{type:"text",onClick:U=>S(c)},{default:t(()=>[f("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:t(()=>[e(r,{ref_key:"xPagination",ref:C,current:d(l).current,"page-size":d(l).pageSize,total:d(l).total,"page-size-options":d(_),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:V,onPageSizeChange:z},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),e(be,{visible:n.value,"onUpdate:visible":i[1]||(i[1]=c=>n.value=c),"init-form":o.value,"script-args":A.value,onOk:i[2]||(i[2]=c=>{n.value=!1,p()}),onCancel:i[3]||(i[3]=c=>n.value=!1)},null,8,["visible","init-form","script-args"])])])}}});export{Re as default};
