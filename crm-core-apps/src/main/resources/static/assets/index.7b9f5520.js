import{a as L,l as O,_ as Y}from"./index.e9d54774.js";/* empty css                *//* empty css               */import{d as N,f as _,o as H,aT as W,D as $,aH as U,aI as t,aS as e,u as x,bK as G,E as A,H as k,aW as m,aZ as M,F as B,aY as s,aU as j,aM as X,bE as Z,aQ as q,bV as Q,bW as J,w as ee,G as E,bX as te,bY as ae,bt as K,aP as oe,bo as le,a$ as re,aO as se,bZ as ie,bp as ne,c as ue,b_ as ce,a_ as de,b$ as pe,c0 as me,b0 as fe}from"./arco.a97fe066.js";import{u as he}from"./chart-option.8bf8c179.js";import{c as F}from"./color.562bf6e9.js";import{r as _e,p as ve,l as ye}from"./alert-record.078e7032.js";/* empty css                *//* empty css                *//* empty css               */import{_ as ge}from"./index.vue_vue_type_script_setup_true_lang.bb709029.js";import{u as be}from"./router.2bf8d2ce.js";/* empty css              *//* empty css                */import{p as ke}from"./pagination.72a5f225.js";import{b as z}from"./bus.4c102fb6.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css               */import"./index.vue_vue_type_script_setup_true_lang.8d2e7b7f.js";import"./performance-data.vue_vue_type_script_setup_true_lang.419c45ec.js";/* empty css               *//* empty css                */import"./text-data-table.vue_vue_type_script_setup_true_lang.2f77f7d2.js";import"./date-time.3a778351.js";import"./moment.a1678c09.js";import"./unit-util.2cbd6bbc.js";import"./item-instance.4f13cfef.js";import"./global.90f51a62.js";import"./monitor-object.647fdfa2.js";import"./config-backup-device.df1a641e.js";import"./alert-original.vue_vue_type_script_setup_true_lang.52196415.js";import"./notice-strategy-drawer.vue_vue_type_script_setup_true_lang.ef7ea06b.js";/* empty css                */import"./dict.7add4266.js";import"./index.vue_vue_type_script_setup_true_lang.365d06f6.js";import"./app-model.480d8620.js";import"./index.vue_vue_type_script_setup_true_lang.5f4a4784.js";/* empty css               */import"./index.0f61770a.js";import"./vuedraggable.umd.d90dc502.js";const xe=N({__name:"alert-statistics",props:{searchParam:{type:Object,default:()=>({})}},setup(V,{expose:v}){const c=_({datetime:[],datetimeRange:{},disaster:[],high:[],average:[],warn:[],info:[],total:[]}),w=V,{loading:f,setLoading:o}=L(!1),n=()=>{o(!0),_e(w.searchParam).then(d=>{c.value=d.data,o(!1)})},S=O.debounce(n,500);H(()=>{n()}),v({fetchDataDebounce:S});const{chartOption:P}=he(()=>{const d=F("info-6"),y=F("warn-6"),g=F("average-6"),D=F("high-6"),l=F("disaster-6");return{animation:!1,tooltip:{trigger:"axis",position(a,b,u,h,I){const C=I.viewSize[0],p=a[0]+10,r=u.offsetWidth;let T=p;return p+r>C&&(T=p-r-20),[T,"0%"]},appendToBody:!0,axisPointer:{type:"shadow"},formatter(a){a.reverse();const b=c.value.datetimeRange[a[0].axisValue].split(" ");let u=`<div>${b[0]}</div><div>${b[1]}</div>`;return a.forEach(h=>{u+="<div>",u+=`${h.marker} ${h.seriesName}: ${h.value}`,u+="</div>"}),u}},legend:{show:!1},grid:{left:"10px",right:"14px",bottom:"0%",top:"5%",containLabel:!0},xAxis:[{type:"category",data:c.value.datetime}],yAxis:[{type:"value"}],series:[{name:"\u4FE1\u606F",type:"bar",itemStyle:{color:d},stack:"priority",data:c.value.info},{name:"\u8B66\u544A",type:"bar",itemStyle:{color:y},stack:"priority",data:c.value.warn},{name:"\u4E00\u822C",type:"bar",itemStyle:{color:g},stack:"priority",data:c.value.average},{name:"\u4E25\u91CD",type:"bar",itemStyle:{color:D},stack:"priority",data:c.value.high},{name:"\u707E\u96BE",type:"bar",itemStyle:{color:l},barWidth:10,stack:"priority",data:c.value.disaster}]}});return(d,y)=>{const g=W("Chart"),D=G;return $(),U(D,{loading:x(f),style:{width:"100%"}},{default:t(()=>[e(g,{height:"200px",option:x(P)},null,8,["option"])]),_:1},8,["loading"])}}}),Fe={style:{display:"flex","align-items":"center"}},we={style:{flex:"9",color:"var(--color-text-2)","font-size":"12px"}},De={class:"item-line",style:{flex:"3"}},Ce={key:0,class:"up-line",style:{bottom:"10px"}},$e={key:1,class:"down-line",style:{bottom:"-50px"}},Se={style:{display:"flex"}},Pe={style:{"font-size":"12px",color:"var(--color-text-2)"}},Te={style:{"font-size":"12px",color:"var(--color-text-2)"}},Ve={key:0,style:{"font-weight":"600","font-size":"12px",color:"var(--color-text-1)","padding-left":"4px","margin-left":"auto"}},Ie=N({__name:"real-time-alert-list",props:{searchParam:{type:Object,default:()=>({})},height:{type:String,default:"calc(100vh - 220px)"}},setup(V,{expose:v}){const{openInNewTab:c}=be(),w=V,f=_([]),{loading:o,setLoading:n}=L(!1),S=()=>{n(!0),ye(w.searchParam).then(l=>{f.value=l.data,n(!1)})},P=O.debounce(S,500),d=_(!1),y=_("snapshot"),g=_(void 0),D=(l,a)=>{g.value=l,d.value=!0,a?y.value=a:y.value="snapshot"};return H(()=>{S()}),v({fetchDataDebounce:P}),(l,a)=>{const b=X,u=Z,h=q,I=Q,C=J,p=G;return $(),A(j,null,[e(h,{"body-style":{padding:"0px"}},{default:t(()=>[e(p,{loading:x(o),style:{width:"100%"}},{default:t(()=>[e(C,{"virtual-list-props":{height:V.height},data:f.value,bordered:!1},{item:t(({item:r,index:T})=>[($(),U(I,{key:T},{default:t(()=>[k("div",Fe,[k("div",we,m(r.shortTriggerTime),1),k("div",De,[T!==0?($(),A("div",Ce)):M("",!0),k("div",{class:B(`event-level-${(r.priority?r.priority:"").toLowerCase()} circle`)},null,2),T!==f.value.length-1?($(),A("div",$e)):M("",!0)]),e(h,{"body-style":{padding:"4px"},style:{flex:"100"}},{default:t(()=>[k("div",Se,[k("span",{style:{"font-size":"12px","font-weight":"600",background:"transparent","min-width":"26px"},class:B(`event-level-${(r.priority?r.priority:"").toLowerCase()}`)},m(x(ve)[r.priority]),3),e(u,{content:r.information},{default:t(()=>[e(b,{hoverable:!1,style:{"font-size":"12px","margin-left":"10px","max-width":"360px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},onClick:R=>D(r.id,"snapshot")},{default:t(()=>[s(m(r.information),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"]),s(" \uFF5C "),k("span",Pe,m(r.ip),1),s(" \uFF5C "),e(u,{content:r.displayName},{default:t(()=>[e(b,{hoverable:!1,style:{"font-size":"12px","max-width":"150px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},onClick:R=>x(c)({name:"MonitorObjectDetail",query:{appKey:r.appKey,hostId:r.hostId,backVisible:"hide"}})},{default:t(()=>[s(m(r.displayName),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"]),s(" \uFF5C "),k("span",Te," \u3010"+m(r.appName)+"\u3011 ",1),r.recoverTime?($(),A("span",Ve," \u6062\u590D\u65F6\u95F4:"+m(r.recoverTime),1)):M("",!0)])]),_:2},1024)])]),_:2},1024))]),_:1},8,["virtual-list-props","data"])]),_:1},8,["loading"])]),_:1}),d.value?($(),U(ge,{key:0,visible:d.value,"onUpdate:visible":a[0]||(a[0]=r=>d.value=r),"alert-id":g.value,active:y.value},null,8,["visible","alert-id","active"])):M("",!0)],64)}}});const Ae=Y(Ie,[["__scopeId","data-v-b50e9826"]]),Ee=N({__name:"search-form",props:{searchParam:{}},emits:["update:searchParam"],setup(V,{emit:v}){const c=V,w=v,{pagination:f}=ke(),o=_({checkedPriority:[!1,!1,!1,!1,!1],keyword:"",ip:"",accurate:!0,group:"",subtype:"",startDate:"",endDate:"",processorIds:[],processStatuses:["PENDING"],page:f}),n=()=>{w("update:searchParam",o.value)};ee(()=>c.searchParam,l=>{o.value={...o.value,...l}},{deep:!0,immediate:!0});const S=_(),P=F("info-6"),d=F("warn-6"),y=F("average-6"),g=F("high-6"),D=F("disaster-6");return(l,a)=>{const b=te,u=ae,h=K,I=oe,C=le,p=re,r=se,T=ie,R=ne;return $(),A("div",null,[e(b,{direction:"horizontal",orientation:"left"},{default:t(()=>[s(m(l.$t("alertManage.searchForm.title")),1)]),_:1}),e(h,{size:"mini",wrap:""},{default:t(()=>[e(u,{checked:o.value.checkedPriority[4],"onUpdate:checked":[a[0]||(a[0]=i=>o.value.checkedPriority[4]=i),n],style:E({border:"1px solid "+x(D)}),color:"red",checkable:"",bordered:""},{default:t(()=>[s(m(l.$t("alertManage.searchForm.eventDisasterTag")),1)]),_:1},8,["checked","style"]),e(u,{checked:o.value.checkedPriority[3],"onUpdate:checked":[a[1]||(a[1]=i=>o.value.checkedPriority[3]=i),n],style:E({border:"1px solid "+x(g)}),color:"orangered",checkable:"",bordered:""},{default:t(()=>[s(m(l.$t("alertManage.searchForm.eventHighTag")),1)]),_:1},8,["checked","style"]),e(u,{checked:o.value.checkedPriority[2],"onUpdate:checked":[a[2]||(a[2]=i=>o.value.checkedPriority[2]=i),n],style:E({border:"1px solid "+x(y)}),color:"orange",checkable:"",bordered:""},{default:t(()=>[s(m(l.$t("alertManage.searchForm.eventAverageTag")),1)]),_:1},8,["checked","style"]),e(u,{checked:o.value.checkedPriority[1],"onUpdate:checked":[a[3]||(a[3]=i=>o.value.checkedPriority[1]=i),n],style:E({border:"1px solid "+x(d)}),color:"gold",checkable:"",bordered:""},{default:t(()=>[s(m(l.$t("alertManage.searchForm.eventWarnTag")),1)]),_:1},8,["checked","style"]),e(u,{checked:o.value.checkedPriority[0],"onUpdate:checked":[a[4]||(a[4]=i=>o.value.checkedPriority[0]=i),n],style:E({border:"1px solid "+x(P)}),color:"blue",checkable:"",bordered:""},{default:t(()=>[s(m(l.$t("alertManage.searchForm.eventInfoTag")),1)]),_:1},8,["checked","style"])]),_:1}),e(R,{ref_key:"formRef",ref:S,model:o.value,layout:"vertical",size:"medium"},{default:t(()=>[e(C,{field:"keyword",label:l.$t("alertManage.searchForm.keyword")},{default:t(()=>[e(I,{modelValue:o.value.keyword,"onUpdate:modelValue":a[5]||(a[5]=i=>o.value.keyword=i),placeholder:"\u544A\u8B66\u6807\u9898/\u76D1\u63A7\u5BF9\u8C61/IP",onInput:n},null,8,["modelValue"])]),_:1},8,["label"]),e(C,{field:"ip",label:l.$t("alertManage.searchForm.realTimeDuration")},{default:t(()=>[e(r,{modelValue:o.value.realTimeStatisticDuration,"onUpdate:modelValue":a[6]||(a[6]=i=>o.value.realTimeStatisticDuration=i),onChange:n},{default:t(()=>[e(p,{value:"TODAY"},{default:t(()=>[s("\u4ECA\u5929")]),_:1}),e(p,{value:"H6"},{default:t(()=>[s("\u6700\u8FD16\u5C0F\u65F6")]),_:1}),e(p,{value:"H12"},{default:t(()=>[s("\u6700\u8FD112\u5C0F\u65F6")]),_:1}),e(p,{value:"H24"},{default:t(()=>[s("\u6700\u8FD124\u5C0F\u65F6")]),_:1}),e(p,{value:"H48"},{default:t(()=>[s("\u6700\u8FD148\u5C0F\u65F6")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(C,{field:"ip",label:l.$t("alertManage.searchForm.ip")},{default:t(()=>[e(I,{modelValue:o.value.ip,"onUpdate:modelValue":a[8]||(a[8]=i=>o.value.ip=i),placeholder:l.$t("alertManage.searchForm.ip"),onInput:n},{suffix:t(()=>[e(T,{modelValue:o.value.accurate,"onUpdate:modelValue":a[7]||(a[7]=i=>o.value.accurate=i),onChange:n},{default:t(()=>[s(m(l.$t("alertManage.searchForm.ip.accurate")),1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(C,{field:"ip",label:l.$t("alertManage.searchForm.processStatus")},{default:t(()=>[e(r,{modelValue:o.value.processStatuses,"onUpdate:modelValue":a[9]||(a[9]=i=>o.value.processStatuses=i),placeholder:l.$t("alertManage.searchForm.processStatus"),multiple:"",onChange:n},{default:t(()=>[e(p,{value:"PENDING"},{default:t(()=>[s("\u5F85\u5904\u7406")]),_:1}),e(p,{value:"PROCESSING"},{default:t(()=>[s("\u5904\u7406\u4E2D")]),_:1}),e(p,{value:"FINISH"},{default:t(()=>[s("\u5DF2\u5904\u7406")]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(C,{field:"ip",label:l.$t("alertManage.searchForm.mine")},{default:t(()=>[e(r,{modelValue:o.value.mine,"onUpdate:modelValue":a[10]||(a[10]=i=>o.value.mine=i),placeholder:l.$t("alertManage.searchForm.mine"),onChange:n},{default:t(()=>[e(p,{value:!0},{default:t(()=>[s("\u6211\u7684\u544A\u8B66")]),_:1}),e(p,{value:!1},{default:t(()=>[s("\u5168\u90E8\u544A\u8B66")]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])])}}}),Me={class:"page-container"},Ne={class:"page-panel"},Re={style:{display:"flex",width:"100%","padding-bottom":"6px"}},Tt=N({__name:"index",setup(V){const v=_({mine:!1,realTimeStatisticDuration:"TODAY",processStatuses:["PENDING"]}),c=_(),w=_(),f=()=>{c.value&&c.value.fetchDataDebounce(),w.value&&w.value.fetchDataDebounce()};z.on("close-alert-success-event",()=>{f()}),z.on("claim-alert-success-event",()=>{f()});const o=_([]),n=P=>{o.value=P},S=ue(()=>o.value.length>0?"calc(100vh - 425px)":"calc(100vh - 205px)");return(P,d)=>{const y=W("auto-refresh"),g=K,D=ce,l=de,a=pe,b=me,u=fe;return $(),A("div",Me,[k("div",Ne,[k("div",Re,[e(g,{style:{"margin-left":"auto"}},{default:t(()=>[e(y,{refresh:f})]),_:1})]),e(u,{gutter:5},{default:t(()=>[e(l,{xxl:4,xl:4,lg:6,md:6,sm:6,xs:6},{default:t(()=>[e(D,{style:{height:"calc(100vh - 150px)","overflow-y":"auto","overflow-x":"hidden"}},{default:t(()=>[e(Ee,{"search-param":v.value,"onUpdate:searchParam":[d[0]||(d[0]=h=>v.value=h),d[1]||(d[1]=h=>f())]},null,8,["search-param"])]),_:1})]),_:1}),e(l,{xxl:20,xl:20,lg:18,md:18,sm:18,xs:18},{default:t(()=>[e(u,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(l,{span:24},{default:t(()=>[e(b,{style:{width:"100%"},"active-key":o.value,onChange:n},{default:t(()=>[e(a,{key:"1",header:"\u5B9E\u65F6\u544A\u8B66\u7EDF\u8BA1"},{default:t(()=>[e(xe,{ref_key:"alertStatisticsRef",ref:w,"search-param":v.value},null,8,["search-param"])]),_:1})]),_:1},8,["active-key"])]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(l,{span:24},{default:t(()=>[e(Ae,{ref_key:"realTimeAlertListRef",ref:c,"search-param":v.value,height:S.value},null,8,["search-param","height"])]),_:1})]),_:1})]),_:1})]),_:1})])])}}});export{Tt as default};
