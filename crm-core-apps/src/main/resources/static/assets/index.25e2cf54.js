import{h as G,a0 as Je,a1 as Ye,l as $,b as Ke,a as fe,a2 as Xe,a3 as Qe}from"./index.e9d54774.js";/* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css               */import{d as ke,cu as ge,cv as et,f as b,w as le,o as be,D as f,E as q,aH as F,aI as e,aS as t,aY as r,aZ as y,aU as oe,aV as ve,bh as tt,aP as at,bo as ut,aO as Ee,bv as lt,aN as _e,bt as Fe,bp as ot,bg as j,g as nt,c as ue,r as st,b1 as it,aT as dt,H as L,u as h,aW as x,bz as rt,bq as ct,ch as mt,a$ as pt,a_ as ft,aM as gt,bE as Ct,bA as ht,P as kt,bG as bt,ag as vt,ah as Et,cw as _t,bH as Ft,b0 as Bt,bY as yt,bB as xt,bi as At}from"./arco.a97fe066.js";import{d as Dt}from"./index.127a6572.js";import{b as X}from"./bus.4c102fb6.js";import{p as wt}from"./pagination.72a5f225.js";import{u as Vt}from"./use-interval.90cad3f2.js";import{_ as Nt}from"./index.vue_vue_type_script_setup_true_lang.dff799f7.js";import{c as St}from"./index.0f61770a.js";import{_ as zt}from"./index.vue_vue_type_script_setup_true_lang.5f4a4784.js";import{_ as Pt}from"./index.vue_vue_type_script_setup_true_lang.615f3ac9.js";import{A as Rt}from"./index.47ae1652.js";/* empty css              *//* empty css               */import{q as Ht}from"./executable-script.a4963186.js";import{q as Ut}from"./credential.27b94543.js";import{g as Tt}from"./attach-file.ee7f1d15.js";import{E as ie,F as Be}from"./FileSaver.min.64c4208e.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";import"./vuedraggable.umd.d90dc502.js";/* empty css               *//* empty css                */import"./_commonjs-dynamic-modules.30ae7933.js";function ye(d){return G.post("/agent-hosts/save",d)}function It(d){return G.post("/agent-hosts/remove",{ids:d})}function ne(d){return G.post("/agent-hosts/list",d)}function Ot(d){return G.post("/agent-hosts/execute",d)}function de(){return G.get("/agent-hosts/get-extend-fields")}const $t=ke({__name:"agent-host-fields",props:ge({batchMode:{type:Boolean,default:!1},selectedHosts:{default:()=>[]}},{form:{},formModifiers:{}}),emits:ge(["afterSubmit"],["update:form"]),setup(d,{emit:m}){const k=d,o=et(d,"form"),A=m,D=b(),s={ip:[{type:"ip",required:!0}],hostname:[{maxLength:128,message:"\u4E3B\u673A\u540D\u6700\u5927\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7128\u5B57\u7B26"}],owner:[{maxLength:250,message:"\u6700\u5927\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7250\u5B57\u7B26"}],os:[{maxLength:128,message:"\u7CFB\u7EDF\u7C7B\u578B\u6700\u5927\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7128\u5B57\u7B26"}],version:[{maxLength:128,message:"\u7CFB\u7EDF\u7248\u672C\u6700\u5927\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7128\u5B57\u7B26"}],zabbixHosts:[{maxLength:200,message:"Zabbix\u670D\u52A1\u5668\u6216\u4EE3\u7406\u5730\u5740\u6700\u5927\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7200\u5B57\u7B26"}]},c=b(),_=b(),v=b(),C=b(),w=b(),N=b(""),R=b(""),S=()=>{D.value.validate(E=>{if(!E){let n;k.batchMode?n=k.selectedHosts.map(z=>(Object.entries(o.value).forEach(([H,p])=>{const g=typeof p,U=p,W=g!=="object"?!0:Object.values(U).join("").trim();U&&W&&Object.assign(z,{[H]:p})}),z)):n=[o.value],ye(n).finally(()=>{A("afterSubmit")})}})};return le(()=>o.value.credential.name,(E,n)=>{N.value=n},{once:!0}),le(()=>o.value.installPkg.fileName,(E,n)=>{R.value=n},{once:!0}),be(async()=>{const{data:E}=await de(),{data:n}=await Ht({language:"shell"}),{data:z}=await Ut(),{data:H}=await Tt(Je);_.value=n.map(p=>p.name),v.value=z.map(p=>p.name),C.value=H.map(p=>p.fileName),w.value=!!o.value.ip,c.value=E}),(E,n)=>{const z=Ye,H=tt,p=at,g=ut,U=Ee,W=lt,I=_e,J=Fe,Q=ot;return f(),q(oe,null,[k.batchMode?(f(),F(H,{key:0,banner:"",style:{"margin-bottom":"1em"}},{icon:e(()=>[t(z,{style:{color:"#e6a23c"}})]),default:e(()=>[r(" \u53EA\u66F4\u65B0\u6240\u586B\u5B57\u6BB5 ")]),_:1})):y("",!0),t(Q,{ref_key:"formRef",ref:D,"label-align":"right","auto-label-width":"",model:o.value,rules:s,onSubmit:i=>{}},{default:e(()=>[k.batchMode?y("",!0):(f(),F(g,{key:0,field:"ip",label:"\u4E3B\u673AIP"},{default:e(()=>[t(p,{modelValue:o.value.ip,"onUpdate:modelValue":n[0]||(n[0]=i=>o.value.ip=i),modelModifiers:{trim:!0},disabled:w.value},null,8,["modelValue","disabled"])]),_:1})),k.batchMode?y("",!0):(f(),F(g,{key:1,field:"hostname",label:"\u4E3B\u673A\u540D\u79F0"},{default:e(()=>[t(p,{modelValue:o.value.hostname,"onUpdate:modelValue":n[1]||(n[1]=i=>o.value.hostname=i),placeholder:"\u8BF7\u8F93\u5165..."},null,8,["modelValue"])]),_:1})),t(g,{field:"owner",label:"\u8D23\u4EFB\u4EBA"},{default:e(()=>[t(p,{modelValue:o.value.owner,"onUpdate:modelValue":n[2]||(n[2]=i=>o.value.owner=i),placeholder:"\u8BF7\u8F93\u5165..."},null,8,["modelValue"])]),_:1}),t(g,{field:"arch",label:"\u7CFB\u7EDF\u67B6\u6784"},{default:e(()=>[t(p,{modelValue:o.value.arch,"onUpdate:modelValue":n[3]||(n[3]=i=>o.value.arch=i),placeholder:"\u8BF7\u8F93\u5165..."},null,8,["modelValue"])]),_:1}),t(g,{field:"os",label:"\u7CFB\u7EDF\u7C7B\u578B"},{default:e(()=>[t(p,{modelValue:o.value.os,"onUpdate:modelValue":n[4]||(n[4]=i=>o.value.os=i),placeholder:"\u8BF7\u8F93\u5165..."},null,8,["modelValue"])]),_:1}),t(g,{field:"version",label:"\u7CFB\u7EDF\u7248\u672C"},{default:e(()=>[t(p,{modelValue:o.value.version,"onUpdate:modelValue":n[5]||(n[5]=i=>o.value.version=i),placeholder:"\u8BF7\u8F93\u5165..."},null,8,["modelValue"])]),_:1}),t(g,{field:"zabbixHosts",label:"Zabbix IP"},{default:e(()=>[t(p,{modelValue:o.value.zabbixHosts,"onUpdate:modelValue":n[6]||(n[6]=i=>o.value.zabbixHosts=i),placeholder:"\u8BF7\u8F93\u5165Zabbix\u670D\u52A1\u5668\u6216\u4EE3\u7406\u5730\u5740(\u591A\u4E2A\u7528,\u5206\u5272)..."},null,8,["modelValue"])]),_:1}),t(g,{field:"scriptName",label:"\u6267\u884C\u811A\u672C"},{default:e(()=>[t(U,{modelValue:o.value.scriptName,"onUpdate:modelValue":n[7]||(n[7]=i=>o.value.scriptName=i),options:_.value,placeholder:"\u8BF7\u9009\u62E9..."},null,8,["modelValue","options"])]),_:1}),t(g,{field:"credential",label:"\u6267\u884C\u51ED\u8BC1"},{default:e(()=>[t(U,{modelValue:o.value.credential.name,"onUpdate:modelValue":n[8]||(n[8]=i=>o.value.credential.name=i),options:v.value,placeholder:"\u8BF7\u9009\u62E9..."},null,8,["modelValue","options"])]),_:1}),t(g,{field:"installPkg",label:"\u5B89\u88C5\u4ECB\u8D28"},{default:e(()=>[t(U,{modelValue:o.value.installPkg.fileName,"onUpdate:modelValue":n[9]||(n[9]=i=>o.value.installPkg.fileName=i),options:C.value,placeholder:"\u8BF7\u9009\u62E9..."},null,8,["modelValue","options"])]),_:1}),t(g,{field:"metadata",label:"Agent\u5143\u6570\u636E"},{default:e(()=>[t(p,{modelValue:o.value.metadata,"onUpdate:modelValue":n[10]||(n[10]=i=>o.value.metadata=i),placeholder:"\u8BF7\u8F93\u5165Agent\u5143\u6570\u636E..."},null,8,["modelValue"])]),_:1}),(f(!0),q(oe,null,ve(c.value,i=>(f(),F(g,{key:i.id,field:i.code,label:i.name},{default:e(()=>[t(p,{modelValue:o.value[i.code],"onUpdate:modelValue":B=>o.value[i.code]=B,placeholder:"\u8BF7\u8F93\u5165...","max-length":200},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","label"]))),128)),t(g,{field:"description",label:"\u4E3B\u673A\u63CF\u8FF0"},{default:e(()=>[t(W,{modelValue:o.value.description,"onUpdate:modelValue":n[11]||(n[11]=i=>o.value.description=i),"max-length":256,"allow-clear":"","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(g,{class:"noAfter"},{default:e(()=>[t(J,null,{default:e(()=>[t(I,{type:"primary",size:"small",onClick:S},{default:e(()=>[r("\u63D0\u4EA4")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])],64)}}}),Z=[{key:"ip",header:"\u4E3B\u673AIP",width:40},{key:"owner",header:"\u8D23\u4EFB\u4EBA",width:40},{key:"hostname",header:"\u4E3B\u673A\u540D",width:40},{key:"description",header:"\u4E3B\u673A\u63CF\u8FF0",width:40},{key:"arch",header:"\u7CFB\u7EDF\u67B6\u6784",width:20},{key:"os",header:"\u7CFB\u7EDF\u7C7B\u578B",width:20},{key:"version",header:"\u7CFB\u7EDF\u7248\u672C",width:20},{key:"zabbixHosts",header:"Zabbix\u670D\u52A1\u5668",width:60},{key:"metadata",header:"Agent\u5143\u6570\u636E",width:60},{key:"scriptName",header:"\u6267\u884C\u811A\u672C",width:60},{key:"credentialName",header:"\u6267\u884C\u51ED\u8BC1",width:60},{key:"installPkgName",header:"\u5B89\u88C5\u4ECB\u8D28",width:60}],xe=[{key:"ip",header:"\u4E3B\u673AIP"},{key:"owner",header:"\u8D23\u4EFB\u4EBA"},{key:"hostname",header:"\u4E3B\u673A\u540D"},{key:"description",header:"\u4E3B\u673A\u63CF\u8FF0"},{key:"arch",header:"\u7CFB\u7EDF\u67B6\u6784"},{key:"os",header:"\u7CFB\u7EDF\u7C7B\u578B"},{key:"version",header:"\u7CFB\u7EDF\u7248\u672C"},{key:"zabbixHosts",header:"Zabbix\u670D\u52A1\u5668"},{key:"metadata",header:"Agent\u5143\u6570\u636E"},{key:"scriptName",header:"\u6267\u884C\u811A\u672C"},{key:"credential",header:"\u6267\u884C\u51ED\u8BC1"},{key:"installPkg",header:"\u5B89\u88C5\u4ECB\u8D28"},{key:"taskStatus",header:"\u6267\u884C\u7ED3\u679C"},{key:"taskStartTime",header:"\u6267\u884C\u5F00\u59CB\u65F6\u95F4"},{key:"taskEndTime",header:"\u6267\u884C\u7ED3\u675F\u65F6\u95F4"},{key:"taskResponse",header:"\u6267\u884C\u54CD\u5E94"}],se={NONE:"\u672A\u6267\u884C",CREATE:"\u6392\u961F\u4E2D",RUNNING:"\u6267\u884C\u4E2D",SUCCESS:"\u6210\u529F",FAILURE:"\u5931\u8D25"},Wt=async()=>{const{data:d}=await de();d&&d.length&&d.forEach(m=>{Z.push({key:m.code,header:m.name,width:60}),xe.push({key:m.code,header:m.name})})},Mt=()=>{const d=new ie.Workbook;d.creator="UMOP",d.keywords="ZabbixAgentInstall";const m=d.addWorksheet("Agent\u90E8\u7F72\u91C7\u96C6");m.columns=Z,m.getRow(1).eachCell(o=>{o.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"C0C0C0"}}}),d.xlsx.writeBuffer().then(o=>{const A=new Blob([o],{type:"application/octet-stream"});Be.saveAs(A,"Agent\u5BFC\u5165\u6A21\u677F.xlsx")})},Lt=d=>{const m=new FileReader;m.onloadend=()=>{const k=m.result;new ie.Workbook().xlsx.load(k).then(A=>{var C;const D=A.worksheets[0],{values:s}=D.getRow(1),c=s==null?void 0:s.filter(w=>!!w).join(","),_=Z.map(w=>w.header).join(",");if(c!==_){j.error("\u4E0A\u4F20Excel\u6587\u4EF6\u6821\u9A8C\u4E0D\u901A\u8FC7: \u8868\u5934\u4E0D\u5339\u914D!",(C=nt())==null?void 0:C.appContext);return}const v=[];D.eachRow((w,N)=>{if(N>1){const R={};w.eachCell((S,E)=>{const n=Z[E-1].key;n==="credentialName"?R.credential={username:"",name:S.text}:n==="installPkgName"?R.installPkg={fileName:S.text}:R[Z[E-1].key]=S.text}),v.push(R)}}),ye(v).then(()=>{X.emit("uploadAgents")}).catch(w=>{X.emit("uploadAgents",w)})})},m.readAsArrayBuffer(d)},Ce=(d,m)=>{const k=new ie.Workbook,o=k.addWorksheet(m);o.columns=xe,o.getRow(1).eachCell(s=>{s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"C0C0C0"}}});const D=d==null?void 0:d.map(s=>{var v,C;const c={},_=se[s.taskStatus]||"";return Object.assign(c,{ip:s.ip||"",owner:s.owner||"",hostname:s.hostname||"",description:s.description||"",arch:s.arch||"",os:s.os||"",version:s.version||"",zabbixHosts:s.zabbixHosts||"",metadata:s.metadata||"",scriptName:s.scriptName||"",credential:((v=s.credential)==null?void 0:v.name)||"",installPkg:((C=s.installPkg)==null?void 0:C.fileName)||"",taskStatus:_,taskStartTime:s.taskStartTime||"",taskEndTime:s.taskEndTime||"",taskResponse:s.taskResponse||"",filedExt1:s.filedExt1||"",filedExt2:s.filedExt2||"",filedExt3:s.filedExt3||"",filedExt4:s.filedExt4||"",filedExt5:s.filedExt5||""}),c});o.addRows(D),o.eachRow(s=>{s.eachCell(c=>{c.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),k.xlsx.writeBuffer().then(s=>{const c=new Blob([s],{type:"application/octet-stream"});Be.saveAs(c,`${m}.xlsx`)})},he=async(d,m)=>{if(!d)Mt();else if(d==="all"){const{data:k}=await ne({keywords:"",status:"",page:{current:1,pageSize:1}}),o=k.totalElements||0;if(o){let A=0;const D=100,s=[...new Array(Math.ceil(o/D))].map(()=>(A+=1,ne({keywords:"",status:"",page:{current:A,pageSize:D}})));Promise.all(s).then(c=>{const _=[...c].map(C=>C.data.content),v=$.flatten(_);Ce(v,"Agent\u90E8\u7F72\u8FDB\u5EA6\u8868")})}}else d==="selected"&&Ce(m,"Agent\u90E8\u7F72\u8FDB\u5EA6\u8868")};setTimeout(async()=>{await Wt()},1);const jt={class:"page-container"},qt={class:"page-panel"},Zt={key:0},Gt={style:{height:"calc(100vh - 146px)"}},Jt=["onClick"],Yt={style:{display:"flex",width:"100%","padding-top":"10px","justify-content":"space-between"}},Aa=ke({__name:"index",setup(d){const{isSuperAdmin:m}=Ke(),k={ip:"",hostname:"",arch:"",os:"",version:"",zabbixHosts:"",credential:{id:"",name:"",username:""},installPkg:{id:"",fileName:"",filePath:""}},{loading:o,setLoading:A}=fe(!1),{loading:D}=fe(!1),s=b([]),c=b(!1),_=b($.cloneDeep(k)),v=b(!1),{pagination:C,pageSizeOptions:w}=wt(),N=b(),R=b(),S=b(),E=b([{type:"checkbox",width:40,resizable:!1},{title:"\u4E3B\u673AIP",field:"ip",minWidth:120,slots:{default:"ip"}},{title:"\u8D23\u4EFB\u4EBA",field:"owner",minWidth:120},{title:"\u4E3B\u673A\u540D\u79F0",field:"hostname",minWidth:200},{title:"\u4E3B\u673A\u63CF\u8FF0",field:"description",minWidth:200},{title:"\u7CFB\u7EDF\u67B6\u6784",field:"arch",minWidth:120,slots:{default:"arch"}},{title:"\u7CFB\u7EDF\u7C7B\u578B",field:"os",minWidth:120,slots:{default:"os"}},{title:"\u7CFB\u7EDF\u7248\u672C",field:"version",minWidth:120,slots:{default:"version"}},{title:"Zabbix\u670D\u52A1\u5668",field:"zabbixHosts",minWidth:160,slots:{default:"zabbixHosts"}},{title:"Agent\u5143\u6570\u636E",field:"metadata",minWidth:160,slots:{default:"metadata"}},{title:"\u6267\u884C\u811A\u672C",field:"scriptName",minWidth:120,slots:{default:"scriptName"}},{title:"\u6267\u884C\u51ED\u8BC1",field:"credential.name",minWidth:120,slots:{default:"credentialName"}},{title:"\u5B89\u88C5\u4ECB\u8D28",field:"installPkg.fileName",minWidth:150,slots:{default:"installPkgName"}},{title:"\u6267\u884C\u7ED3\u679C",field:"taskStatus",minWidth:240,slots:{default:"taskStatus"}},{title:"\u6267\u884C\u5F00\u59CB\u65F6\u95F4",field:"taskStartTime",width:160},{title:"\u6267\u884C\u7ED3\u675F\u65F6\u95F4",field:"taskEndTime",width:160}]),n=ue(()=>{const a=N.value,u=[];return a&&(u.push(...a.getCheckboxRecords()),u.push(...a.getCheckboxReserveRecords())),u}),z=ue(()=>S.value?S.value.genActualColumnConfig("agent_install_preference",E.value):E.value),H=b({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"ip",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:z.value}),p=a=>{s.value=a;const u=a.find(V=>V.status==="init");u!=null&&u.file&&Lt(u==null?void 0:u.file),s.value=[]},g=()=>{const a=N.value;a&&a.getCheckboxRecords().push(...a.getCheckboxReserveRecords())},U=g,W=g,I=()=>{const a=N.value;a&&(a.clearCheckboxReserve(),a.clearCheckboxRow())},J=a=>{H.value.columns=a},Q={NONE:"",CREATE:"#ffb400",RUNNING:"#ff7d00",SUCCESS:"#00b42a",FAILURE:"#f53f3f"},i=st({keywords:"",status:"",advanceFilterList:[{field:"",condition:void 0,value:"",values:[]}]}),B=async(a={...i,page:C})=>{A(!0);const u=N.value;try{const{data:V}=await ne(a);C.total=V.totalElements,u&&await u.loadData(V.content)}catch(V){console.error(V)}finally{A(!1)}},Ae=a=>{C.current=a,setTimeout(()=>B(),1)},De=a=>{C.pageSize=a,setTimeout(()=>B(),1)},we=async()=>{await B(),I()},ee=Dt(async()=>{await B(),I()},500),re=a=>{_.value=$.cloneDeep(a),v.value=!1,c.value=!0},Ve=a=>{const u=$.cloneDeep(a);v.value=!1,c.value=!0,Object.assign(_.value,{...u,ip:"",taskStatus:"NONE",taskResponse:"",taskStartTime:"",taskEndTime:""})},Ne=a=>{const u=a.cell.getElementsByClassName("table-link")[0],{row:V,column:T}=a;return u&&u.scrollWidth>u.offsetWidth&&T.field==="displayName"&&V[T.field]?V[T.field]:null},Se=async()=>{const a=n.value.map(u=>u.ip);ct.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,content:`\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u60A8\u6240\u9009\u7684${a.length}\u6761\u8BB0\u5F55, \u662F\u5426\u7EE7\u7EED?`,onOk:async()=>{await It(a),I(),j.success("\u5220\u9664\u6210\u529F"),await B()}})},ze=async()=>{c.value=!1,await B()},ce=async a=>{let u;a?u=[a]:u=JSON.parse(JSON.stringify(n.value)),await Ot(u),j.loading("\u5F00\u59CB\u6267\u884C\u90E8\u7F72..."),await B()};X.on("uploadAgents",a=>{a?j.error(a):(I(),j.success("\u5BFC\u5165\u6210\u529F"),B())}),Vt(()=>{const a=N.value;if(a){const{fullData:u}=a.getTableData();u.filter(T=>T.taskStatus==="CREATE"||T.taskStatus==="RUNNING").length>0&&B()}},1e4),le(c,a=>{a||(_.value=$.cloneDeep(k))}),be(async()=>{const{data:a}=await de();a&&a.length&&a.forEach(u=>{E.value.push({title:u.name,field:u.code,width:120})}),E.value.push({title:"\u64CD\u4F5C",width:160,fixed:"right",resizable:!1,slots:{default:"action"}}),J(z.value),await B()});const Pe=["\u6267\u884C\u7ED3\u679C","\u6267\u884C\u5F00\u59CB\u65F6\u95F4","\u6267\u884C\u7ED3\u675F\u65F6\u95F4","\u64CD\u4F5C"],Re=ue(()=>E.value.filter(a=>!Pe.includes(a.title)&&a.title).map(a=>({title:a.title,field:a.field,valueType:"string"}))),He=()=>{B()};return it(()=>{X.off("uploadAgents")}),(a,u)=>{const V=mt,T=pt,Ue=Ee,M=Fe,me=ft,Y=gt,te=Ct,ae=_e,Te=ht,Ie=kt,Oe=Xe,K=bt,$e=vt,We=Et,pe=_t,Me=Qe,Le=Ft,je=Bt,P=yt,qe=xt,Ze=dt("vxe-grid"),Ge=At;return f(),q("div",jt,[L("div",qt,[t(je,null,{default:e(()=>[t(me,{span:14},{default:e(()=>[t(M,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(V,{modelValue:i.keywords,"onUpdate:modelValue":u[0]||(u[0]=l=>i.keywords=l),placeholder:"\u5173\u952E\u5B57","allow-clear":"",style:{width:"340px"},onSearch:we,onInput:h(ee),onClear:h(ee)},null,8,["modelValue","onInput","onClear"]),t(Ue,{modelValue:i.status,"onUpdate:modelValue":u[1]||(u[1]=l=>i.status=l),style:{width:"110px"},placeholder:"\u6267\u884C\u72B6\u6001","allow-clear":"",onChange:h(ee)},{default:e(()=>[(f(!0),q(oe,null,ve(h(se),(l,O)=>(f(),F(T,{key:O,value:O},{default:e(()=>[r(x(l),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onChange"]),t(Rt,{modelValue:i.advanceFilterList,"onUpdate:modelValue":u[2]||(u[2]=l=>i.advanceFilterList=l),"field-options":Re.value,onOk:He},null,8,["modelValue","field-options"])]),_:1})]),_:1}),t(me,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(M,{style:{"margin-bottom":"5px"}},{default:e(()=>[n.value.length>0?(f(),q("span",Zt,[L("span",null,"\u5DF2\u9009\u62E9\u4E86"+x(n.value.length)+"\u6761",1),t(Y,{onClick:I},{default:e(()=>[r("\u6E05\u7A7A")]),_:1})])):y("",!0),t(te,{content:"\u5237\u65B0",mini:""},{default:e(()=>[t(Nt,{onClick:B})]),_:1}),t(Pt,{"config-code":"agent-install"}),t(te,{content:"\u624B\u52A8\u5F55\u5165",mini:""},{default:e(()=>[h(m)?(f(),F(ae,{key:0,type:"primary",onClick:u[3]||(u[3]=l=>{c.value=!0,v.value=!1})},{default:e(()=>[r(" \u65B0\u5EFA ")]),_:1})):y("",!0)]),_:1}),t(te,{content:"Excel\u6A21\u677F\u53EF\u5728\u7BA1\u7406\u4E2D\u4E0B\u8F7D",mini:""},{default:e(()=>[h(m)?(f(),F(Te,{key:0,"file-list":s.value,"auto-upload":!1,"show-file-list":!1,onChange:p},{"upload-button":e(()=>[t(M,null,{default:e(()=>[t(ae,{type:"primary"},{default:e(()=>[r("\u5BFC\u5165")]),_:1})]),_:1})]),_:1},8,["file-list"])):y("",!0)]),_:1}),t(Le,{"popup-max-height":!1,position:"br"},{content:e(()=>[t(pe,{title:"\u6279\u91CF\u64CD\u4F5C"},{default:e(()=>[t(K,{disabled:n.value.length===0,onClick:u[4]||(u[4]=l=>ce(void 0))},{default:e(()=>[t(Oe),r(" \u6267\u884C\u811A\u672C ")]),_:1},8,["disabled"]),t(K,{disabled:n.value.length===0,onClick:Se},{default:e(()=>[t($e),r(" \u5220\u9664\u4E3B\u673A ")]),_:1},8,["disabled"]),t(K,{disabled:n.value.length===0,onClick:u[5]||(u[5]=l=>{c.value=!0,v.value=!0,_.value=h($).cloneDeep(k)})},{default:e(()=>[t(We),r(" \u66F4\u65B0\u4E3B\u673A ")]),_:1},8,["disabled"])]),_:1}),t(pe,{title:"\u90E8\u7F72\u914D\u7F6E"},{default:e(()=>[t(K,{onClick:u[6]||(u[6]=l=>h(he)("",null))},{default:e(()=>[t(Me),r(" Excel\u6A21\u677F ")]),_:1})]),_:1})]),default:e(()=>[t(ae,null,{default:e(()=>[r(" \u7BA1\u7406 "),t(Ie)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),L("div",Gt,[t(Ze,rt({ref_key:"xGrid",ref:N,loading:h(o),"tooltip-config":{contentMethod:Ne}},H.value,{onCheckboxChange:h(U),onCheckboxAll:h(W)}),{ip:e(({row:l})=>[L("div",{class:"table-link",onClick:O=>re(l)},x(l.ip),9,Jt)]),arch:e(({row:l})=>[l.arch?(f(),F(P,{key:0,color:"arcoblue",size:"small"},{default:e(()=>[r(x(l.arch),1)]),_:2},1024)):y("",!0)]),os:e(({row:l})=>[l.os?(f(),F(P,{key:0,color:"blue",size:"small"},{default:e(()=>[r(x(l.os),1)]),_:2},1024)):y("",!0)]),version:e(({row:l})=>[l.version?(f(),F(P,{key:0,size:"small"},{default:e(()=>[r(x(l.version),1)]),_:2},1024)):y("",!0)]),zabbixHosts:e(({row:l})=>[l.zabbixHosts?(f(),F(P,{key:0,size:"small"},{default:e(()=>[r(x(l.zabbixHosts),1)]),_:2},1024)):y("",!0)]),metadata:e(({row:l})=>[l.metadata?(f(),F(P,{key:0,size:"small"},{default:e(()=>[r(x(l.metadata),1)]),_:2},1024)):y("",!0)]),scriptName:e(({row:l})=>[l.scriptName?(f(),F(P,{key:0,size:"small"},{default:e(()=>[r(x(l.scriptName),1)]),_:2},1024)):y("",!0)]),credentialName:e(({row:l})=>[l.credential.name?(f(),F(P,{key:0,size:"small"},{default:e(()=>[r(x(l.credential.name),1)]),_:2},1024)):y("",!0)]),installPkgName:e(({row:l})=>[l.installPkg.fileName?(f(),F(P,{key:0,size:"small"},{default:e(()=>[r(x(l.installPkg.fileName),1)]),_:2},1024)):y("",!0)]),taskStatus:e(({row:l})=>[t(P,{size:"small",color:Q[l.taskStatus]},{default:e(()=>[r(x(h(se)[l.taskStatus]),1)]),_:2},1032,["color"]),r(" "+x(l.taskResponse),1)]),action:e(({row:l})=>[t(M,null,{default:e(()=>[t(Y,{style:{"font-size":"1em"},onClick:O=>ce(l)},{default:e(()=>[r(" \u6267\u884C\u811A\u672C ")]),_:2},1032,["onClick"]),t(Y,{style:{"font-size":"1em"},onClick:O=>re(l)},{default:e(()=>[r("\u7F16\u8F91")]),_:2},1032,["onClick"]),t(Y,{style:{"font-size":"1em"},onClick:O=>Ve(l)},{default:e(()=>[r(" \u590D\u5236 ")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:e(()=>[L("div",Yt,[t(qe,{ref_key:"xPagination",ref:R,current:h(C).current,"page-size":h(C).pageSize,total:h(C).total,"page-size-options":h(w),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:Ae,onPageSizeChange:De},null,8,["current","page-size","total","page-size-options"]),t(M,null,{default:e(()=>[t(zt,{"selected-data":n.value,loading:h(D),"show-condition":!1,onExport:h(he)},null,8,["selected-data","loading","onExport"]),t(St,{ref_key:"columnConfigRef",ref:S,"column-config":E.value,"config-id":"agent_install_preference",onSave:J},null,8,["column-config"])]),_:1})])]),_:1},16,["loading","tooltip-config","onCheckboxChange","onCheckboxAll"])]),t(Ge,{width:"50%",title:"\u4E3B\u673A\u8868\u5355",visible:c.value,"drawer-style":{padding:0},"mask-closable":!1,footer:!1,"unmount-on-close":"",onCancel:u[8]||(u[8]=l=>c.value=!1)},{default:e(()=>[t($t,{form:_.value,"onUpdate:form":u[7]||(u[7]=l=>_.value=l),"batch-mode":v.value,"selected-hosts":n.value,onAfterSubmit:ze},null,8,["form","batch-mode","selected-hosts"])]),_:1},8,["visible"])])])}}});export{Aa as default};
