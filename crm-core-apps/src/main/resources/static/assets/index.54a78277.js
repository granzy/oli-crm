import{h as H,a as le,T as Se,l as $}from"./index.e9d54774.js";/* empty css              *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               */import{d as ne,f as d,o as ie,aT as G,D as i,aH as s,aI as e,aS as t,aY as l,bz as se,u as b,aM as de,r as Me,E as K,H as p,br as qe,aW as A,aZ as B,aU as ae,aV as ue,bg as P,bq as Ke,h as W,aP as Ne,aN as Ue,bt as Ie,a_ as ze,b0 as Oe,bf as Re,bY as Le,bB as Te,bX as $e,bo as Pe,c7 as We,c8 as Ge,be as He,a$ as Ye,cg as Qe,aO as je,bv as Xe,bp as Ze,bi as Je}from"./arco.a97fe066.js";import{f as et}from"./app-model.480d8620.js";import{f as tt}from"./dict.7add4266.js";import{p as at}from"./pagination.72a5f225.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";function ut(f){return H.post("/compressionStrategy/pageList",f)}function oe(f){return H.post("/compressionStrategy",f)}function ot(f){return H.delete(`/compressionStrategy/${f}`)}const lt=ne({__name:"key-mapping",emits:["addKeyMapping"],setup(f,{emit:w}){const C=d(),{loading:N,setLoading:r}=le(!1),U=d({size:"mini",height:500,columnConfig:{resizable:!0},showOverflow:"tooltip",columns:[{title:"\u540D\u79F0",field:"name",width:180},{title:"\u503C\u63CF\u8FF0",field:"description",minWidth:220},{title:"\u64CD\u4F5C",minWidth:50,slots:{default:"action"}}]}),I=async()=>{r(!0);const c=C.value;try{const{data:_}=await Se("alert_compression_key_mapping");c&&await c.reloadData(_)}catch{}finally{r(!1)}},E=w,m=c=>{E("addKeyMapping",c)};return ie(()=>{I()}),(c,_)=>{const z=de,O=G("vxe-grid");return i(),s(O,se({ref_key:"xGrid",ref:C,loading:b(N)},U.value),{action:e(({row:x})=>[t(z,{onClick:g=>m(x.name)},{default:e(()=>[l("\u6DFB\u52A0")]),_:2},1032,["onClick"])]),_:1},16,["loading"])}}}),nt={class:"page-container"},it={class:"page-panel"},st={style:{height:"calc(100vh - 146px)"}},dt={style:{width:"90%"}},rt={key:1,style:{"padding-left":"10px"}},pt=p("span",{style:{"padding-left":"10px"}},"\u5206\u949F",-1),ct=p("div",null,[p("span",null,"\u538B\u7F29\u6761\u4EF6"),p("span",{style:{"margin-left":"30px",opacity:"0.5"}}," \u591A\u4E2A\u5206\u7EC4\u4E4B\u95F4\u662F'\u6216'\u7684\u5173\u7CFB ")],-1),mt={style:{width:"90%"}},ft={style:{width:"90%"}},xt=ne({__name:"index",setup(f){const{setLoading:w}=le(!1),C=d(),N=d(),{pagination:r,pageSizeOptions:U}=at(),I=d({size:"mini",height:"auto",columnConfig:{resizable:!0},showOverflow:"tooltip",columns:[{title:"\u7B56\u7565\u540D\u79F0",field:"name",width:120},{title:"\u542F\u7528\u72B6\u6001",field:"enable",minWidth:120,slots:{default:"enable"}},{title:"\u4F18\u5148\u7EA7",field:"seq",minWidth:40},{title:"\u5E94\u7528",field:"appKeys",minWidth:120,slots:{default:"appKeys"}},{title:"\u521B\u5EFA\u8005",field:"createUserName",minWidth:120},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",width:200},{title:"\u64CD\u4F5C",width:120,slots:{default:"action"}}]}),E=d({name:""}),m=async()=>{w(!0);const n=C.value;try{const{data:o}=await ut({page:r,...E.value});r.total=o.totalElements,n&&await n.reloadData(o.content)}catch{}finally{w(!1)}},c=d([]),_=d([]),z=n=>{r.current=n,m()},O=n=>{r.pageSize=n,m()},x=()=>{r.current=1,m()},g=d(!1),D=d(""),S=d(),h=d(!1),u=Me({id:"",name:"",description:"",compressionMode:"TIME",appKeys:[],duration:1,times:1,seq:1,priority:"DISASTER",enable:!0,information:"\u8FD9\u662F\u4E00\u6761\u805A\u5408\u544A\u8B66\uFF0C\u805A\u5408${(count)!}\u6761\u544A\u8B66",rules:[],recordEditable:!0});let Y=[];const re=async()=>{await S.value.validate()||(u.appKeys=$.join(u.appKeys),await oe(u),P.success("\u63D0\u4EA4\u6210\u529F"),g.value=!1,await m())},pe=async n=>{await oe(n),P.success("\u63D0\u4EA4\u6210\u529F")},ce=async()=>{Y=[{fieldName:"\u544A\u8B66\u6807\u9898",fieldCode:"information",operators:["eq","ne","like","notLike"],placeHolder:"\u8BF7\u8F93\u5165\u544A\u8B66\u6807\u9898"},{fieldName:"IP",fieldCode:"ip",operators:["eq","ne","like","notLike"],placeHolder:"\u8BF7\u8F93\u5165ip\u5730\u5740"},{fieldName:"\u7EA7\u522B",fieldCode:"priority",operators:["in","notIn"],placeHolder:"\u8BF7\u9009\u62E9\u544A\u8B66\u7EA7\u522B",meta:{type:"dict",options:(await tt("\u544A\u8B66\u7EA7\u522B")).data}},{fieldName:"\u76D1\u63A7\u5BF9\u8C61\u540D\u79F0",fieldCode:"displayName",operators:["eq","ne","like","notLike"],placeHolder:"\u8BF7\u8F93\u5165\u76D1\u63A7\u5BF9\u8C61\u540D\u79F0"}]},R=async()=>{c.value=(await et()).data,c.value.forEach(n=>{var o;(o=n.appInstances)==null||o.forEach(k=>{k.deleteTime||_.value.push(k.id)})})},me=async()=>{await R(),g.value=!0,D.value="\u65B0\u5EFA\u538B\u7F29\u7B56\u7565",S.value.resetFields(),u.duration=1,u.times=1,u.rules=[],u.id=""},fe=async n=>{await R(),g.value=!0,D.value="\u538B\u7F29\u7B56\u7565\u8BE6\u60C5",$.assign(u,n),u.appKeys=n.appKeys.split(",").filter(o=>_.value.indexOf(o)>-1)},_e=async n=>{await R(),g.value=!0,D.value="\u7F16\u8F91\u538B\u7F29\u7B56\u7565",$.assign(u,n),u.appKeys=n.appKeys.split(",").filter(o=>_.value.indexOf(o)>-1)},ge=async n=>{Ke.confirm({title:"\u63D0\u793A",simple:!1,draggable:!0,closable:!1,titleAlign:"start",content:()=>W("div",["\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45",W("span",{style:"color: rgb(var(--danger-6))"},"\u5220\u9664"),'\u538B\u7F29\u7B56\u7565"',W("span",{style:"color: rgb(var(--primary-6))"},n.name),'"\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F']),onOk:async()=>{await ot(n.id),P.success("\u5220\u9664\u6210\u529F"),await m()}})},ye=()=>{h.value=!0},Fe=()=>{h.value=!1},ve=()=>{h.value=!1},Be=n=>{h.value=!1,u.information+=n},Q=()=>{g.value=!1,S.value.resetFields()};return ie(()=>{m(),ce()}),(n,o)=>{const k=Ne,M=Ue,V=Ie,j=ze,be=Oe,Ce=Re,X=Le,q=de,Ee=Te,he=G("vxe-grid"),L=$e,y=Pe,F=We,Z=Ge,T=He,ke=Ye,Ve=Qe,Ae=je,J=Xe,we=G("Rule-Filter"),xe=Ze,ee=Je;return i(),K("div",nt,[p("div",it,[t(be,null,{default:e(()=>[t(j,{span:14},{default:e(()=>[t(V,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(k,{modelValue:E.value.name,"onUpdate:modelValue":o[0]||(o[0]=a=>E.value.name=a),style:{width:"320px"},placeholder:"\u8BF7\u8F93\u5165\u7B56\u7565\u540D\u79F0","allow-clear":"",onKeyup:qe(x,["enter"])},null,8,["modelValue"]),t(M,{type:"primary",size:"medium",onClick:x},{default:e(()=>[l(A(n.$t("button.search")),1)]),_:1})]),_:1})]),_:1}),t(j,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(M,{type:"primary",size:"medium",onClick:me},{default:e(()=>[l(A(n.$t("button.create")),1)]),_:1})]),_:1})]),_:1}),p("div",st,[t(he,se({ref_key:"xGrid",ref:C},I.value),{appKeys:e(({row:a})=>[l(A(a.appInstanceNames),1)]),enable:e(({row:a})=>[a.recordEditable?(i(),s(Ce,{key:0,modelValue:a.enable,"onUpdate:modelValue":v=>a.enable=v,onChange:v=>pe(a)},{checked:e(()=>[l("\u542F\u7528")]),unchecked:e(()=>[l("\u7981\u7528")]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):(i(),s(V,{key:1},{default:e(()=>[a.enable?(i(),s(X,{key:0,color:"green"},{default:e(()=>[l("\u542F\u7528")]),_:1})):(i(),s(X,{key:1,color:"red"},{default:e(()=>[l("\u7981\u7528")]),_:1}))]),_:2},1024))]),action:e(({row:a})=>[t(V,null,{default:e(()=>[a.recordEditable?B("",!0):(i(),s(q,{key:0,onClick:v=>fe(a)},{default:e(()=>[l(" \u8BE6\u60C5 ")]),_:2},1032,["onClick"])),a.recordEditable?(i(),s(q,{key:1,onClick:v=>_e(a)},{default:e(()=>[l(" \u7F16\u8F91 ")]),_:2},1032,["onClick"])):B("",!0),a.recordEditable?(i(),s(q,{key:2,type:"text",onClick:v=>ge(a)},{default:e(()=>[l(" \u5220\u9664 ")]),_:2},1032,["onClick"])):B("",!0)]),_:2},1024)]),pager:e(()=>[t(Ee,{ref_key:"xPagination",ref:N,current:b(r).current,"page-size":b(r).pageSize,total:b(r).total,"page-size-options":b(U),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:z,onPageSizeChange:O},null,8,["current","page-size","total","page-size-options"])]),_:1},16)])]),t(ee,{width:"50vw",visible:g.value,"mask-closable":!u.recordEditable,onCancel:Q},{title:e(()=>[l(A(D.value),1)]),footer:e(()=>[t(V,null,{default:e(()=>[u.recordEditable?(i(),s(M,{key:0,type:"primary",onClick:re},{default:e(()=>[l(" \u786E\u8BA4 ")]),_:1})):B("",!0),u.recordEditable?(i(),s(M,{key:1,onClick:Q},{default:e(()=>[l(" \u53D6\u6D88 ")]),_:1})):B("",!0)]),_:1})]),default:e(()=>[p("div",null,[l(" \u57FA\u672C\u4FE1\u606F "),t(L),t(xe,{ref_key:"submitFormRef",ref:S,model:u},{default:e(()=>[p("div",dt,[t(y,{field:"name",label:"\u7B56\u7565\u540D\u79F0",rules:[{required:!0,message:"\u7B56\u7565\u540D\u79F0\u5FC5\u586B"}],"validate-trigger":"input",required:""},{default:e(()=>[t(k,{modelValue:u.name,"onUpdate:modelValue":o[1]||(o[1]=a=>u.name=a),placeholder:"\u8BF7\u8F93\u5165\u7B56\u7565\u540D\u79F0","max-length":255,"show-word-limit":""},null,8,["modelValue"])]),_:1}),t(y,{field:"compressionMode",label:"\u538B\u7F29\u65B9\u5F0F",required:""},{default:e(()=>[t(Z,{modelValue:u.compressionMode,"onUpdate:modelValue":o[2]||(o[2]=a=>u.compressionMode=a),type:"button"},{default:e(()=>[t(F,{value:"TIME"},{default:e(()=>[l("\u6309\u65F6\u95F4")]),_:1}),t(F,{value:"FREQUENCY"},{default:e(()=>[l("\u6309\u6B21\u6570")]),_:1})]),_:1},8,["modelValue"]),u.compressionMode==="FREQUENCY"?(i(),s(T,{key:0,modelValue:u.times,"onUpdate:modelValue":o[3]||(o[3]=a=>u.times=a),min:1,precision:0,style:{width:"120px","margin-left":"20px"},mode:"button"},null,8,["modelValue"])):B("",!0),u.compressionMode==="FREQUENCY"?(i(),K("span",rt," \u6B21 ")):B("",!0),t(T,{modelValue:u.duration,"onUpdate:modelValue":o[4]||(o[4]=a=>u.duration=a),min:1,max:5,precision:0,style:{width:"140px","margin-left":"20px"},mode:"button"},null,8,["modelValue"]),pt]),_:1}),t(y,{field:"seq",label:"\u4F18\u5148\u7EA7",required:""},{default:e(()=>[t(T,{modelValue:u.seq,"onUpdate:modelValue":o[5]||(o[5]=a=>u.seq=a),min:1,max:100,precision:0,style:{width:"120px"},mode:"button"},null,8,["modelValue"])]),_:1}),t(y,{field:"appKeys",label:"\u5E94\u7528\u5B9E\u4F8B",rules:[{required:!0,message:"\u5E94\u7528\u5B9E\u4F8B\u5FC5\u586B"}],"validate-trigger":"blur",required:""},{default:e(()=>[t(Ae,{modelValue:u.appKeys,"onUpdate:modelValue":o[6]||(o[6]=a=>u.appKeys=a),placeholder:"\u8BF7\u9009\u62E9\u5E94\u7528\u5B9E\u4F8B",multiple:""},{default:e(()=>[(i(!0),K(ae,null,ue(c.value,(a,v)=>(i(),s(Ve,{key:v,label:a.type},{default:e(()=>[(i(!0),K(ae,null,ue(a.appInstances,(te,De)=>(i(),s(ke,{key:De,value:te.id||[]},{default:e(()=>[l(A(te.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{field:"description",label:"\u7B56\u7565\u63CF\u8FF0"},{default:e(()=>[t(J,{modelValue:u.description,"onUpdate:modelValue":o[7]||(o[7]=a=>u.description=a),placeholder:"\u8BF7\u8F93\u5165\u7B56\u7565\u63CF\u8FF0","max-length":1e3,"show-word-limit":""},null,8,["modelValue"])]),_:1}),ct]),t(L),p("div",mt,[t(we,{modelValue:u.rules,"onUpdate:modelValue":o[8]||(o[8]=a=>u.rules=a),"field-meta":b(Y)},null,8,["modelValue","field-meta"])]),l(" \u5408\u5E76\u4FE1\u606F "),t(L),p("div",ft,[t(y,{field:"information",label:"\u544A\u8B66\u6807\u9898","content-flex":!1,"merge-props":!1,rules:[{required:!0,message:"\u544A\u8B66\u6807\u9898\u5FC5\u586B"}],"validate-trigger":"input",required:""},{default:e(()=>[t(V,{style:{"padding-top":"5px"},direction:"vertical",fill:""},{default:e(()=>[t(q,{onClick:ye},{default:e(()=>[l("\u6DFB\u52A0")]),_:1}),t(J,{modelValue:u.information,"onUpdate:modelValue":o[9]||(o[9]=a=>u.information=a),"max-length":500,"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),t(y,{field:"priority",label:"\u544A\u8B66\u7EA7\u522B",required:""},{default:e(()=>[t(Z,{modelValue:u.priority,"onUpdate:modelValue":o[10]||(o[10]=a=>u.priority=a)},{default:e(()=>[t(F,{value:"DISASTER"},{default:e(()=>[l("\u707E\u96BE")]),_:1}),t(F,{value:"HIGH"},{default:e(()=>[l("\u4E25\u91CD")]),_:1}),t(F,{value:"AVERAGE"},{default:e(()=>[l("\u4E00\u822C")]),_:1}),t(F,{value:"WARN"},{default:e(()=>[l("\u8B66\u544A")]),_:1}),t(F,{value:"INFO"},{default:e(()=>[l("\u4FE1\u606F")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model"])])]),_:1},8,["visible","mask-closable"]),t(ee,{width:"35vw",visible:h.value,"unmount-on-close":"",onOk:Fe,onCancel:ve},{title:e(()=>[l("\u6620\u5C04\u503C")]),default:e(()=>[t(lt,{onAddKeyMapping:Be})]),_:1},8,["visible"])])}}});export{xt as default};
