import{h as X,a as be,L as le,l as J,ap as it,M as $e,_ as Et,c as Bt,J as ht,ao as Dt,aq as wt,ar as xt}from"./index.e9d54774.js";/* empty css               *//* empty css                */import{d as Z,f as r,r as se,aT as ve,D as _,E as Q,aS as t,aI as e,aY as i,H as z,aW as N,u as s,bz as ke,ch as je,bt as ge,a_ as Ee,aN as Be,b0 as he,aM as De,bB as we,aH as V,n as ie,bi as oe,c as ae,w as Ke,aU as Pe,aV as Ie,aZ as K,bg as Y,bq as me,aP as ot,bo as Re,a$ as _e,aO as Ce,c7 as ct,c8 as dt,bs as ft,be as pt,aj as St,a3 as At,bh as mt,bp as Le,b as Tt,G as Fe,b$ as Vt,c0 as $t,o as Qe,b1 as vt,ce as gt,bN as Ve,c9 as _t,bE as nt,bY as Pt,cM as It,bv as Ot,cC as Rt,bf as Ct,P as Lt,bG as zt,aw as Ut,a2 as Nt,bH as Mt,bZ as qt,cm as Wt,b_ as Gt,bK as Ht}from"./arco.a97fe066.js";/* empty css                *//* empty css               *//* empty css               *//* empty css               */import{p as xe}from"./pagination.72a5f225.js";import{g as jt,f as Je,a as Kt,s as Qt,b as Oe,c as Ge,v as st,e as Jt,q as Yt,u as Zt,t as Xt}from"./config-backup-device.df1a641e.js";import{d as at}from"./index.127a6572.js";/* empty css              *//* empty css                */import{f as ea,a as ta,b as aa,c as ua}from"./category-subtype.57fa85d0.js";import{f as oa}from"./device-series-info.a997e7a7.js";import{b as He}from"./bus.4c102fb6.js";/* empty css               *//* empty css                */import{_ as na,e as tt}from"./index.vue_vue_type_script_setup_true_lang.a6146e11.js";/* empty css                */import{d as la}from"./global.90f51a62.js";import{_ as lt}from"./index.vue_vue_type_script_setup_true_lang.dff799f7.js";/* empty css                */import{u as ia}from"./unit-util.2cbd6bbc.js";/* empty css               */import{s as Me,f as qe}from"./tree-util.a8ddc3e6.js";import{q as sa}from"./business.22e8b088.js";import{S as ra}from"./index.d4fbf381.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";import"./color.562bf6e9.js";import"./moment.a1678c09.js";function ca(F){return X.post("/automationProxy/pageList",F)}const da={style:{height:"calc(100vh - 176px)"}},fa=Z({__name:"automation-proxy-table",setup(F,{expose:x}){const{loading:n,setLoading:k}=be(!1),{pagination:c,pageSizeOptions:u}=xe(),a=r(),m=r(),C=r({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"id",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:[{type:"checkbox",width:40},{title:"\u540D\u79F0",field:"name",minWidth:80},{title:"IP",field:"ip",minWidth:80},{title:"\u72B6\u6001",minWidth:120,slots:{default:"status"}},{title:"\u5F02\u5E38\u4FE1\u606F",minWidth:120,slots:{default:"errorMessage"}},{title:"\u64CD\u4F5C",width:120,fixed:"right",slots:{default:"action"}}]}),S=se({queryStr:""}),L=async(l={...S,page:c})=>{k(!0);const p=a.value;try{const{data:h}=await ca(l);c.total=h.totalElements,p&&await p.reloadData(h.content)}catch(h){console.error(h)}finally{k(!1)}},v=l=>{c.current=l,L()},g=l=>{c.pageSize=l,L()};return x({backToFirstPageFetchData:()=>{c.current=1,L()}}),(l,p)=>{const h=je,O=ge,M=Ee,I=Be,E=he,f=De,U=we,W=ve("vxe-grid");return _(),Q("div",null,[t(E,null,{default:e(()=>[t(M,{span:14},{default:e(()=>[t(O,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(h,{modelValue:S.queryStr,"onUpdate:modelValue":p[0]||(p[0]=j=>S.queryStr=j),style:{width:"320px"},placeholder:"\u540D\u79F0/IP","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1}),t(M,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(O,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(I,{type:"primary"},{default:e(()=>[i("\u65B0\u5EFA")]),_:1})]),_:1})]),_:1})]),_:1}),z("div",da,[t(W,ke({ref_key:"xGrid",ref:a,loading:s(n)},C.value),{index:e(({rowIndex:j})=>[i(N(j+1+(s(c).current-1)*s(c).pageSize),1)]),status:e(()=>[i("\u6B63\u5E38")]),errorMessage:e(()=>[]),action:e(()=>[t(O,null,{default:e(()=>[t(f,{type:"text"},{default:e(()=>[i("\u7F16\u8F91")]),_:1}),t(f,{type:"text"},{default:e(()=>[i("\u5220\u9664")]),_:1})]),_:1})]),pager:e(()=>[t(U,{ref_key:"xPagination",ref:m,current:s(c).current,"page-size":s(c).pageSize,total:s(c).total,"page-size-options":s(u),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:v,onPageSizeChange:g},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])])}}}),pa=Z({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["ok","cancel"],setup(F,{emit:x}){const n=x,k=()=>{n("cancel")},c=()=>{n("ok")},u=r(),a=()=>{ie(()=>{u.value.backToFirstPageFetchData()})};return(m,C)=>{const S=oe;return _(),V(S,{width:"56vw",title:"\u4EE3\u7406\u7BA1\u7406","mask-closable":!1,visible:m.visible,onOk:c,onCancel:k,onOpen:a},{default:e(()=>[t(fa,{ref_key:"automationProxyTableRef",ref:u},null,512)]),_:1},8,["visible"])}}});var We=(F=>(F.SSH="SSH",F.TELNET="TELNET",F))(We||{});function ma(F){return X.post("/devicePublicAccount/pageList",F)}function va(F){return X.post("/devicePublicAccount",F)}function ga(F){return X.post("/devicePublicAccount/setDefaultConnectType",F)}function _a(){return X.get("/devicePublicAccount/list")}function Ca(F){return X.delete(`/devicePublicAccount/${F}`)}function ya(F){return X.get(`/devicePublicAccount/getVisiblePassword/${F}`)}function ut(F){return X.post("/configBackupExec/exec",{ids:F})}function Fa(F){return X.post("/configBackupExec/checkConnectivity",F)}const ba={key:0},ka={key:1},Ea=Z({__name:"index",props:{visible:{type:Boolean,default:!1},initFormData:{}},emits:["ok","cancel"],setup(F,{emit:x}){const n=F,k=x,c=()=>{k("cancel")},u=r(),a=r({displayName:"",deviceIp:"",certificateType:le.GLOBAL}),m=async()=>{await Qt(a.value),Y.success("\u63D0\u4EA4\u6210\u529F"),k("ok"),He.emit("edit-config-backup-device-success-event",a.value)},C=async()=>{if(!await u.value.validate()){let{sysObjectId:o}=a.value;const{manufacturerCode:P,appKey:R,hostId:G}=a.value;if(R&&G&&!o){const H=(await jt(R,G)).data;H?(o=H,a.value.sysObjectId=H):Y.error("\u8BBE\u5907\u5382\u5546\u66F4\u65B0\u5931\u8D25,\u65E0\u6CD5\u83B7\u53D6\u8BBE\u5907\u578B\u53F7\u4FE1\u606F,\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458")}if(o&&P){const H=(await oa(o)).data;H&&H.manufacturerCode!==P?me.confirm({title:"\u63D0\u793A",content:`\u8BE5\u8BBE\u5907\u88AB\u7CFB\u7EDF\u8BC6\u522B\u4E3A\u5382\u5546\u4E3A:${H.manufacturerName?H.manufacturerName:H.manufacturerCode},\u5982\u679C\u66F4\u6539\u5382\u5546,\u5219\u4F1A\u5F71\u54CD\u8BE5\u8BBE\u5907\u7C7B\u578B\u540C\u7C7B\u578B\u7684\u6240\u6709\u8BBE\u5907 , \u662F\u5426\u7EE7\u7EED?`,okText:"\u786E\u5B9A",async onOk(){try{await m()}catch{Y.error("\u7F16\u8F91\u5931\u8D25")}}}):await m()}else await m()}},S=r([]),L=r([]),v=r([]),g=ae(()=>{const{connectType:T}=a.value;return v.value.filter(o=>o.connectType===T)}),y=()=>{ie(()=>{var T,o;if(a.value&&a.value.certificateType===le.GLOBAL)if(!a.value.publicAccountId)a.value.publicAccountId=(T=J.find(g.value,{defaultConnectType:!0}))==null?void 0:T.id;else{const P=J.find(v.value,{id:a.value.publicAccountId});P?P.connectType!==a.value.connectType?a.value.publicAccountId=(o=J.find(g.value,{defaultConnectType:!0}))==null?void 0:o.id:a.value.publicAccountId=P.id:a.value.publicAccountId=""}})},l=r(!1),p=r(!1),h=r(""),O=r(!1),M=()=>{l.value=!1,p.value=!1,h.value=""},I=async()=>{M();const{data:T}=await ea();S.value=T,L.value=(await ta("network_device")).data,v.value=(await _a()).data,await ie(()=>{y()})},E=async()=>{if(!await u.value.validate()){O.value=!0;try{const{data:o}=await Fa(a.value);p.value=o.result,o.result||(h.value=`\u6D4B\u8BD5\u5931\u8D25:${Je(o.errorMessage)}`)}catch(o){console.error(o),O.value=!1,h.value="\u6D4B\u8BD5\u5931\u8D25"}finally{l.value=!0,O.value=!1}}},f=r("");Ke(()=>n.initFormData,T=>{u.value&&u.value.resetFields(),T&&(a.value=J.cloneDeep(T),f.value=J.cloneDeep(a.value.loginPassword||""))},{immediate:!0,deep:!0});const U=T=>{T===le.CUSTOM&&(a.value.connectType=$e.SSH),a.value.loginAccount="",a.value.loginPassword="",a.value.loginPort=22,y()},W=ae(()=>{const T={manufacturerCode:[{required:!0,message:"\u8BF7\u9009\u62E9\u5382\u5546"}]},o={loginAccount:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7"}],loginPassword:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}],loginPort:[{required:!0,message:"\u8BF7\u8F93\u5165\u7AEF\u53E3"}]},P={publicAccountId:[{required:!0,message:"\u8BF7\u9009\u62E9\u8D26\u53F7"}]};let R={};return a.value.certificateType===le.CUSTOM?R=J.assign(T,o):R=J.assign(T,P),R}),j=async T=>{if(!T&&a.value.id&&f.value===a.value.loginPassword){const o=(await Kt(a.value.id)).data;o&&(a.value.loginPassword=o)}};return(T,o)=>{const P=ot,R=Re,G=_e,H=Ce,A=ct,te=dt,ue=ft,re=pt,ce=St,ee=Be,D=At,B=mt,b=Le,d=oe;return _(),V(d,{width:"35vw",visible:T.visible,"mask-closable":!1,"destroy-on-close":!0,"unmount-on-close":"",title:"\u7F16\u8F91\u7F51\u7EDC\u8BBE\u5907",onOk:C,onCancel:c,onBeforeOpen:I},{default:e(()=>[t(b,{ref_key:"submitFormRef",ref:u,model:a.value,rules:W.value},{default:e(()=>[t(R,{field:"name",label:"\u8BBE\u5907\u540D\u79F0","validate-trigger":"blur"},{default:e(()=>[t(P,{modelValue:a.value.displayName,"onUpdate:modelValue":o[0]||(o[0]=w=>a.value.displayName=w),disabled:a.value.source===s(it).MONITOR},null,8,["modelValue","disabled"])]),_:1}),t(R,{field:"ip",label:"IP","validate-trigger":"blur"},{default:e(()=>[t(P,{modelValue:a.value.ip,"onUpdate:modelValue":o[1]||(o[1]=w=>a.value.ip=w),disabled:a.value.source===s(it).MONITOR},null,8,["modelValue","disabled"])]),_:1}),t(R,{field:"manufacturerCode",label:"\u5382\u5546"},{default:e(()=>[t(H,{modelValue:a.value.manufacturerCode,"onUpdate:modelValue":o[2]||(o[2]=w=>a.value.manufacturerCode=w),placeholder:"\u8BF7\u9009\u62E9\u5382\u5546"},{default:e(()=>[(_(!0),Q(Pe,null,Ie(S.value,w=>(_(),V(G,{key:w.code,value:w.code},{default:e(()=>[i(N(w.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(R,{field:"deviceType",label:"\u8BBE\u5907\u7C7B\u578B"},{default:e(()=>[t(H,{modelValue:a.value.deviceType,"onUpdate:modelValue":o[3]||(o[3]=w=>a.value.deviceType=w),placeholder:"\u8BF7\u9009\u62E9\u8BBE\u5907\u7C7B\u578B"},{default:e(()=>[(_(!0),Q(Pe,null,Ie(L.value,w=>(_(),V(G,{key:w.code,value:w.code},{default:e(()=>[i(N(w.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(R,{field:"deviceModel",label:"\u8BBE\u5907\u578B\u53F7","validate-trigger":"blur"},{default:e(()=>[t(P,{modelValue:a.value.deviceModel,"onUpdate:modelValue":o[4]||(o[4]=w=>a.value.deviceModel=w)},null,8,["modelValue"])]),_:1}),t(R,{field:"certificateType",label:"\u8D26\u53F7\u7C7B\u578B"},{default:e(()=>[t(te,{modelValue:a.value.certificateType,"onUpdate:modelValue":o[5]||(o[5]=w=>a.value.certificateType=w),onChange:U},{default:e(()=>[t(A,{value:s(le).GLOBAL},{default:e(()=>[i(" \u516C\u5171\u8D26\u53F7 ")]),_:1},8,["value"]),t(A,{value:s(le).CUSTOM},{default:e(()=>[i(" \u81EA\u5B9A\u4E49\u8D26\u53F7 ")]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1}),t(R,{field:"connectType",label:"\u8FDE\u63A5\u65B9\u5F0F",onChange:y},{default:e(()=>[t(te,{modelValue:a.value.connectType,"onUpdate:modelValue":o[6]||(o[6]=w=>a.value.connectType=w),type:"button"},{default:e(()=>[t(A,{value:s($e).SSH},{default:e(()=>[i("SSH")]),_:1},8,["value"]),t(A,{value:s($e).TELNET},{default:e(()=>[i(" TELNET ")]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1}),a.value.certificateType===s(le).GLOBAL?(_(),V(R,{key:0,field:"publicAccountId",label:"\u8D26\u53F7","validate-trigger":"blur"},{default:e(()=>[t(H,{modelValue:a.value.publicAccountId,"onUpdate:modelValue":o[7]||(o[7]=w=>a.value.publicAccountId=w),placeholder:"\u8BF7\u9009\u62E9\u8D26\u53F7","allow-search":"","allow-clear":""},{default:e(()=>[(_(!0),Q(Pe,null,Ie(g.value,w=>(_(),V(G,{key:w.id,value:w.id},{default:e(()=>[i(N(w.loginAccount)+" "+N(w.defaultConnectType?"(\u9ED8\u8BA4)":""),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})):K("",!0),a.value.certificateType===s(le).CUSTOM?(_(),V(R,{key:1,field:"loginAccount",label:"\u8D26\u53F7","validate-trigger":"blur"},{default:e(()=>[t(P,{modelValue:a.value.loginAccount,"onUpdate:modelValue":o[8]||(o[8]=w=>a.value.loginAccount=w)},null,8,["modelValue"])]),_:1})):K("",!0),a.value.certificateType===s(le).CUSTOM?(_(),V(R,{key:2,field:"loginPassword",label:"\u5BC6\u7801","validate-trigger":"blur"},{default:e(()=>[t(ue,{modelValue:a.value.loginPassword,"onUpdate:modelValue":o[9]||(o[9]=w=>a.value.loginPassword=w),onVisibilityChange:j},null,8,["modelValue"])]),_:1})):K("",!0),a.value.certificateType===s(le).CUSTOM?(_(),V(R,{key:3,field:"loginPort",label:"\u7AEF\u53E3","validate-trigger":"blur"},{default:e(()=>[t(re,{modelValue:a.value.loginPort,"onUpdate:modelValue":o[10]||(o[10]=w=>a.value.loginPort=w)},null,8,["modelValue"])]),_:1})):K("",!0),z("div",null,[t(ee,{type:"text",loading:O.value,onClick:E},{icon:e(()=>[t(ce)]),default:e(()=>[i(" \u767B\u5F55\u6D4B\u8BD5 ")]),_:1},8,["loading"]),l.value?(_(),V(B,{key:0,type:p.value?"success":"error"},{action:e(()=>[t(D,{style:{cursor:"pointer"},onClick:o[11]||(o[11]=w=>l.value=!1)})]),default:e(()=>[p.value?(_(),Q("span",ba,"\u6D4B\u8BD5\u6210\u529F")):(_(),Q("span",ka,N(h.value),1))]),_:1},8,["type"])):K("",!0)])]),_:1},8,["model","rules"])]),_:1},8,["visible"])}}});function Ba(F){return X.post("/configBackupExecDetail/pageList",F)}function ha(F){return X.post("/configBackupExecDetail/downloadConfigFile",F,{responseType:"blob",timeout:36e5})}const Da={class:"top_title"},wa={key:1,style:{"text-align":"center","font-size":"16px"}},xa=Z({__name:"index",props:{visible:{type:Boolean,default:!1},viewConfigFile:{},row:{}},emits:["ok","cancel"],setup(F,{emit:x}){const n=F,k=x,c=r("");return Ke(()=>n.viewConfigFile,u=>{u&&u.success?c.value=u.fileContent:c.value=""}),(u,a)=>{const m=oe;return _(),V(m,{width:"60vw",visible:u.visible,title:"\u914D\u7F6E\u4FE1\u606F","unmount-on-close":"","mask-closable":!1,footer:null,onCancel:a[1]||(a[1]=C=>k("cancel")),onOk:a[2]||(a[2]=C=>k("ok"))},{default:e(()=>{var C;return[z("div",Da,[z("div",null,"\u8BBE\u5907\u540D\u79F0:"+N(u.row.deviceName),1),z("div",null,"\u5907\u4EFD\u5F00\u59CB\u65F6\u95F4:"+N(u.row.startTime),1),z("div",null,"\u5907\u4EFD\u7ED3\u675F\u65F6\u95F4:"+N(u.row.endTime),1)]),(C=u.viewConfigFile)!=null&&C.success?(_(),V(na,{key:0,ref:"MonacoEditRef",modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=S=>c.value=S),"editor-option":{readOnly:!0,minimap:{enabled:!0},contextmenu:!1},language:"text"},null,8,["modelValue"])):(_(),Q("div",wa,"\u914D\u7F6E\u6587\u4EF6\u4E0D\u5B58\u5728"))]}),_:1},8,["visible"])}}});const Sa=Et(xa,[["__scopeId","data-v-f4529eb8"]]),Aa=Bt();function Ta(F="javascript"){let x=null;const n=r(null);function k(C,S,L={}){if(!!n.value){if(C==null||S===null||S===void 0){console.error("Invalid input for diff editor");return}x=tt.createDiffEditor(n.value,{minimap:{enabled:!0},theme:Aa.theme==="dark"?"vs-dark":"vs",multiCursorModifier:"ctrlCmd",scrollbar:{verticalScrollbarSize:8,horizontalScrollbarSize:8},fontSize:12,...L}),x.setModel({original:tt.createModel(C,F),modified:tt.createModel(S,F)})}}function c(C){var S,L;(L=(S=x==null?void 0:x.getModel())==null?void 0:S.original)==null||L.setValue(C)}function u(C){var S,L;(L=(S=x==null?void 0:x.getModel())==null?void 0:S.modified)==null||L.setValue(C)}function a(C){x==null||x.updateOptions(C)}function m(){return x}return Tt(()=>{x&&x.dispose()}),{monacoEditorRef:n,createDiffEditor:k,getEditor:m,updateOptions:a,updateOriginalModel:c,updateModifiedModel:u}}const rt=Z({__name:"index",props:{width:{default:"100%"},height:{default:"100%"},language:{default:"text"},editorOption:{default:()=>({})},originalValue:{default:""},modifiedValue:{default:""}},setup(F,{expose:x}){const n=F,k=ae(()=>({width:typeof n.width=="string"?n.width:`${n.width}px`,height:typeof n.height=="string"?n.height:`${n.height}px`})),{monacoEditorRef:c,createDiffEditor:u,getEditor:a,updateOptions:m,updateOriginalModel:C,updateModifiedModel:S}=Ta(n.language);return x({createDiffEditor:u,getEditor:a,updateOptions:m,updateOriginalModel:C,updateModifiedModel:S}),(L,v)=>(_(),Q("div",{ref_key:"monacoEditorRef",ref:c,style:Fe(k.value)},null,4))}}),Va={key:0,style:{display:"flex","margin-bottom":"10px"}},$a={style:{"margin-left":"40%"}},Pa=Z({__name:"index",props:{visible:{type:Boolean,default:!1},rows:{},rowConfigData:{},baseLineConfId:{}},emits:["ok","cancel"],setup(F,{emit:x}){const n=F,k=x,c=r(""),u=r(""),a=r({}),m=r(),C=v=>{ie(()=>{m.value&&m.value[v[0]]&&(m.value[v[0]].getEditor()?(m.value[v[0]].updateOriginalModel(a.value[v[0]].original),m.value[v[0]].updateModifiedModel(a.value[v[0]].modified)):m.value[v[0]].createDiffEditor(a.value[v[0]].original,a.value[v[0]].modified))})},S=()=>{const v=Object.keys(n.rowConfigData);v.length===2?(c.value=n.rowConfigData[v[0]].fileContent,u.value=n.rowConfigData[v[1]].fileContent,ie(()=>{m.value.getEditor()?(m.value.updateOriginalModel(c.value),m.value.updateModifiedModel(u.value)):m.value.createDiffEditor(c.value,u.value)})):v.length>2&&(a.value=[],v.forEach(g=>{const y=J.find(n.rows,{id:g}),l=J.find(n.rows,{id:n.baseLineConfId});if(y&&l&&g!==n.baseLineConfId){let p=n.rowConfigData[n.baseLineConfId].fileContent;p||(p="");let h=n.rowConfigData[g].fileContent;h||(h=""),a.value.push({title:`\u914D\u7F6E\u57FA\u51C6\u300A${l.startTime}\u300B\u4E0E\u300A${y.startTime}\u300B\u5BF9\u6BD4`,original:p,modified:h})}}))};Ke(()=>n.rowConfigData,v=>{v&&S()});const L=ae(()=>{var v;return`\u914D\u7F6E\u4FE1\u606F(${n.rows?(v=n.rows[0])==null?void 0:v.deviceName:""})`});return(v,g)=>{const y=Vt,l=$t,p=oe;return _(),V(p,{width:"100vw",visible:v.visible,title:L.value,"unmount-on-close":!1,"mask-closable":!1,footer:!1,onCancel:g[0]||(g[0]=h=>k("cancel"))},{default:e(()=>[Object.keys(v.rowConfigData).length==2?(_(),Q("div",Va,[z("div",null,"\u5907\u4EFD\u65F6\u95F4:"+N(v.rows[0]?v.rows[0].startTime:""),1),z("div",$a," \u5907\u4EFD\u65F6\u95F4:"+N(v.rows[1]?v.rows[1].startTime:""),1)])):K("",!0),Object.keys(v.rowConfigData).length==2?(_(),V(rt,{key:1,ref_key:"monacoEditRef",ref:m,"original-value":c.value,"modified-value":u.value,height:"92%","editor-option":{readOnly:!1,minimap:{enabled:!0},contextmenu:!1},language:"text/plain"},null,8,["original-value","modified-value"])):(_(),V(l,{key:2,accordion:"",onChange:C},{default:e(()=>[(_(!0),Q(Pe,null,Ie(a.value,(h,O)=>(_(),V(y,{key:O,header:h.title},{default:e(()=>[t(rt,{ref_for:!0,ref_key:"monacoEditRef",ref:m,"original-value":h.original,"modified-value":h.modified,height:600,"editor-option":{readOnly:!0,minimap:{enabled:!0},contextmenu:!1},language:"text"},null,8,["original-value","modified-value"])]),_:2},1032,["header"]))),128))]),_:1}))]),_:1},8,["visible","title"])}}}),Ia=Z({__name:"base-line-select",props:{visible:{type:Boolean,default:!1},rows:{}},emits:["ok","cancel"],setup(F,{emit:x}){const n=x,k=se({baseLineConfId:""}),c=r(),u=async()=>{await c.value.validate()||n("ok",k.baseLineConfId)},a=()=>{k.baseLineConfId=""};return(m,C)=>{const S=_e,L=Ce,v=Re,g=Le,y=oe;return _(),V(y,{width:"30vw",visible:m.visible,title:"\u8BF7\u9009\u62E9\u57FA\u51C6\u6587\u4EF6","unmount-on-close":"","mask-closable":!1,onBeforeOpen:a,onCancel:C[1]||(C[1]=l=>n("cancel")),onOk:u},{default:e(()=>[t(g,{ref_key:"submitFormRef",ref:c,autocomplete:"off",model:k},{default:e(()=>[t(v,{field:"baseLineConfId",label:"\u57FA\u51C6\u9009\u62E9",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u57FA\u51C6"}],"validate-trigger":"blur"},{default:e(()=>[t(L,{modelValue:k.baseLineConfId,"onUpdate:modelValue":C[0]||(C[0]=l=>k.baseLineConfId=l),placeholder:"\u8BF7\u9009\u62E9\u57FA\u51C6","allow-clear":""},{default:e(()=>[(_(!0),Q(Pe,null,Ie(m.rows,l=>(_(),V(S,{key:l.id,value:l.id},{default:e(()=>[i(N(l.startTime),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),Oa={style:{display:"flex","justify-content":"flex-end"}},Ra={key:0},La={style:{color:"rgb(var(--primary-6))"}},za=Z({__name:"detail-list",props:{rowData:{},taskId:{},height:{default:"calc(100vh - 120px)"},isMonitorDetailPage:{type:Boolean}},setup(F,{expose:x}){const n=F,{pagination:k,pageSizeOptions:c}=xe(),u=r(),a=r(),m=ae(()=>{var b;return((b=n.rowData)==null?void 0:b.displayName)===void 0?[{title:"\u8BBE\u5907\u540D\u79F0",field:"deviceName",minWidth:120},{title:"\u8BBE\u5907IP",field:"deviceIp",width:120},{title:"\u5907\u4EFD\u5F00\u59CB\u65F6\u95F4",field:"startTime",minWidth:120,slots:{default:"startTime"}},{title:"\u5907\u4EFD\u7ED3\u675F\u65F6\u95F4",field:"endTime",minWidth:120},{title:"\u5907\u4EFD\u72B6\u6001",field:"taskStatus",width:100,slots:{default:"taskStatus"}},{title:"\u5907\u4EFD\u5F02\u5E38\u4FE1\u606F",field:"taskTrace",minWidth:120,slots:{default:"taskTrace"}},{title:"\u64CD\u4F5C",width:120,slots:{default:"action"}}]:[{type:"checkbox",width:40},{title:"\u5907\u4EFD\u5F00\u59CB\u65F6\u95F4",field:"startTime",minWidth:120,slots:{default:"startTime"}},{title:"\u5907\u4EFD\u7ED3\u675F\u65F6\u95F4",field:"endTime",minWidth:120},{title:"\u5907\u4EFD\u72B6\u6001",field:"taskStatus",width:100,slots:{default:"taskStatus"}},{title:"\u5907\u4EFD\u5F02\u5E38\u4FE1\u606F",field:"taskTrace",minWidth:120,slots:{default:"taskTrace"}},{title:"\u64CD\u4F5C",width:200,slots:{default:"action"}}]}),C=r({size:"mini",height:"auto",columnConfig:{resizable:!0},showOverflow:"tooltip",rowConfig:{isHover:!0,keyField:"id"},checkboxConfig:{reserve:!0,checkMethod:({row:b})=>b.taskStatus==="SUCCESS"},columns:m.value}),S=()=>{const b=u.value;b&&b.getCheckboxRecords().push(...b.getCheckboxReserveRecords())},L=S,v=S,g=()=>{const b=u.value;b&&(b.clearCheckboxReserve(),b.clearCheckboxRow())},y=ae(()=>{const b=u.value,d=[];return b&&(d.push(...b.getCheckboxRecords()),d.push(...b.getCheckboxReserveRecords())),d}),l=se({keyword:"",deviceName:"",deviceIp:"",taskId:n.taskId,taskStatus:""}),p=async(b={...l,page:k})=>{const d=u.value;try{const{data:w}=await Ba(b);k.total=w.totalElements,d&&await d.loadData(w.content)}catch(w){console.error(w)}},h=b=>{k.current=b,p()},O=b=>{k.pageSize=b,p()},M=async()=>{k.current=1,await p()},I=r(!1),E=r(!1),f=r(!1),U=r({}),W=r(),j=b=>{b?[l.startBeginTime,l.startEndTime]=b:(l.startBeginTime=void 0,l.startEndTime=void 0),M()},T=async b=>{const d=(await st([b])).data;Object.keys(d).forEach(w=>{U.value=d[w]}),W.value=b,I.value=!0},o=async b=>{try{b.downloadConfigFileLoading=!0,la(await ha(b))}catch(d){console.error(d)}finally{b.downloadConfigFileLoading=!1}},P=r({}),R=r(""),G=async b=>{f.value=!1,P.value=(await st(y.value)).data,b&&(R.value=b),E.value=!0},H=async()=>{y.value.length>2?f.value=!0:await G()},A=r([]),te=()=>{k.current=1,A.value=[],l.taskStatus=void 0,l.startBeginTime=void 0,l.startEndTime=void 0,p()};let ue;const re=async()=>{await p()},ce=()=>{ue&&clearInterval(ue)},ee=r(),D=async()=>{var d,w;const b=(await Jt([{displayName:(d=n.rowData)==null?void 0:d.displayName,ip:(w=n.rowData)==null?void 0:w.ip}])).data;b.length>0&&([ee.value]=b)},B=()=>{var b;me.confirm({title:"\u63D0\u793A",content:`\u6B64\u64CD\u4F5C\u5C06\u5907\u4EFD\u7F51\u7EDC\u8BBE\u5907${(b=n.rowData)==null?void 0:b.displayName}\u914D\u7F6E , \u662F\u5426\u7EE7\u7EED?`,okText:"\u786E\u5B9A",async onOk(){try{ee.value?(await ut([ee.value.id]),Y.success("\u5F00\u59CB\u5907\u4EFD..."),await p()):Y.error("\u672A\u627E\u5230\u8BE5\u8BBE\u5907")}catch{Y.error("\u6267\u884C\u5931\u8D25")}}})};return Qe(()=>{n.rowData&&(l.deviceIp=n.rowData.ip,p(),D()),n.taskId&&(l.taskId=n.taskId,p()),ce(),ue=setInterval(re,5e3)}),vt(()=>{ce()}),x({initData:te}),(b,d)=>{const w=je,Se=_t,ye=_e,fe=Ce,Ae=ge,ze=Ee,Te=De,pe=nt,Ue=Be,Ye=he,Ze=we,Xe=ve("vxe-grid"),et=gt("read-only");return _(),Q("div",null,[t(Ye,null,{default:e(()=>[t(ze,{span:12},{default:e(()=>[t(Ae,null,{default:e(()=>{var q;return[((q=b.rowData)==null?void 0:q.displayName)===void 0?(_(),V(w,{key:0,modelValue:l.keyword,"onUpdate:modelValue":d[0]||(d[0]=ne=>l.keyword=ne),placeholder:"\u8BBE\u5907\u540D\u79F0/IP",style:{width:"280px"},"allow-clear":"",onSearch:M,onClear:M,onInput:M},null,8,["modelValue"])):(_(),V(Se,{key:1,"model-value":A.value,"onUpdate:modelValue":d[1]||(d[1]=ne=>A.value=ne),style:{width:"360px"},"show-time":"",onChange:j},null,8,["model-value"])),t(fe,{modelValue:l.taskStatus,"onUpdate:modelValue":d[2]||(d[2]=ne=>l.taskStatus=ne),placeholder:"\u5907\u4EFD\u72B6\u6001",style:{width:"140px"},"allow-clear":"",onChange:d[3]||(d[3]=ne=>M())},{default:e(()=>[t(ye,{value:"SUCCESS"},{default:e(()=>[i("\u6210\u529F")]),_:1}),t(ye,{value:"FAILURE"},{default:e(()=>[i("\u5931\u8D25")]),_:1}),t(ye,{value:"RUNNING"},{default:e(()=>[i("\u8FDB\u884C\u4E2D")]),_:1})]),_:1},8,["modelValue"])]}),_:1})]),_:1}),t(ze,{span:12},{default:e(()=>[z("div",Oa,[t(Ae,null,{default:e(()=>{var q;return[y.value.length>0?(_(),Q("span",Ra,[z("span",La," \u5DF2\u9009\u62E9\u4E86"+N(y.value.length)+"\u6761 ",1),t(Te,{onClick:g},{default:e(()=>[i("\u6E05\u7A7A")]),_:1})])):K("",!0),t(pe,{content:"\u5F53\u524D\u5217\u8868\u6BCF5\u79D2\u4F1A\u81EA\u52A8\u5237\u65B0,\u60A8\u4E5F\u53EF\u4EE5\u70B9\u51FB\u5237\u65B0\u6309\u94AE\u624B\u52A8\u5237\u65B0",position:"lt"},{default:e(()=>[t(lt,{onClick:re})]),_:1}),b.isMonitorDetailPage?Ve((_(),V(Ue,{key:1,type:"primary",disabled:ee.value===void 0||!((q=ee.value)!=null&&q.manufacturerCode),onClick:B},{default:e(()=>[i(" \u914D\u7F6E\u5907\u4EFD ")]),_:1},8,["disabled"])),[[et]]):K("",!0),b.taskId===void 0?(_(),V(Ue,{key:2,type:"primary",disabled:y.value.length<2,onClick:H},{default:e(()=>[i(" \u6587\u4EF6\u6BD4\u5BF9 ")]),_:1},8,["disabled"])):K("",!0)]}),_:1})])]),_:1})]),_:1}),z("div",{style:Fe([{"margin-top":"10px"},{height:b.height}])},[t(Xe,ke({ref_key:"xGrid",ref:u,size:"small"},C.value,{onCheckboxChange:s(L),onCheckboxAll:s(v)}),{startTime:e(({row:q})=>[z("div",null,N(q.startTime?q.startTime:"\u4EFB\u52A1\u8C03\u5EA6\u4E2D..."),1)]),taskStatus:e(({row:q})=>[z("div",{style:Fe({color:s(Oe)(q.taskStatus)})},N(s(Ge)(q.taskStatus)),5)]),taskTrace:e(({row:q})=>[i(N(s(Je)(q.taskTrace)),1)]),action:e(({row:q})=>[t(Ae,null,{default:e(()=>[t(Te,{disabled:q.taskStatus==="RUNNING"||q.taskStatus==="FAILURE",onClick:ne=>T(q)},{default:e(()=>[i(" \u67E5\u770B ")]),_:2},1032,["disabled","onClick"]),t(Te,{disabled:q.taskStatus==="RUNNING"||q.taskStatus==="FAILURE",loading:q.downloadConfigFileLoading,onClick:ne=>o(q)},{default:e(()=>[i(" \u4E0B\u8F7D ")]),_:2},1032,["disabled","loading","onClick"])]),_:2},1024)]),pager:e(()=>[t(Ze,{ref_key:"xPagination",ref:a,current:s(k).current,"page-size":s(k).pageSize,total:s(k).total,"page-size-options":s(c),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:h,onPageSizeChange:O},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["onCheckboxChange","onCheckboxAll"])],4),t(Sa,{visible:I.value,"onUpdate:visible":d[4]||(d[4]=q=>I.value=q),"view-config-file":U.value,row:W.value,onOk:d[5]||(d[5]=q=>I.value=!1),onCancel:d[6]||(d[6]=q=>I.value=!1)},null,8,["visible","view-config-file","row"]),t(Ia,{visible:f.value,"onUpdate:visible":d[7]||(d[7]=q=>f.value=q),rows:y.value,onOk:G,onCancel:d[8]||(d[8]=q=>f.value=!1)},null,8,["visible","rows"]),t(Pa,{visible:E.value,"onUpdate:visible":d[9]||(d[9]=q=>E.value=q),"row-config-data":P.value,rows:y.value,"base-line-conf-id":R.value,onCancel:d[10]||(d[10]=q=>E.value=!1)},null,8,["visible","row-config-data","rows","base-line-conf-id"])])}}}),yt=Z({__name:"index",props:{visible:{type:Boolean,default:!1},rowData:{},taskId:{}},emits:["cancel"],setup(F,{emit:x}){const n=F,k=x,c=r(),u=()=>{ie(()=>{var m;(m=c.value)==null||m.initData()})},a=ae(()=>{var m,C;return((m=n.rowData)==null?void 0:m.displayName)===void 0?"\u5907\u4EFD\u8BB0\u5F55":`\u5907\u4EFD\u8BB0\u5F55(${(C=n.rowData)==null?void 0:C.displayName})`});return(m,C)=>{const S=oe;return _(),V(S,{width:"60vw",visible:m.visible,title:a.value,"unmount-on-close":"","mask-closable":!0,footer:!1,onOpen:u,onCancel:C[0]||(C[0]=L=>k("cancel"))},{default:e(()=>[t(za,{ref_key:"detailListRef",ref:c,"row-data":m.rowData,"task-id":m.taskId},null,8,["row-data","task-id"])]),_:1},8,["visible","title"])}}});function Ua(F){return X.post("/configBackupExecSummary/pageList",F)}const Na={style:{display:"flex","justify-content":"flex-end"}},Ma={key:0},qa={style:{color:"rgb(var(--primary-6))"}},Wa={style:{height:"calc(100vh - 120px)","margin-top":"10px"}},Ga={style:{display:"flex"}},Ha=Z({__name:"summary-list",setup(F,{expose:x}){const{pagination:n,pageSizeOptions:k}=xe(),c=r(),u=r(),a=r({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{isHover:!0,keyField:"id"},checkboxConfig:{reserve:!0},columns:[{title:"\u5907\u4EFD\u5F00\u59CB\u65F6\u95F4",field:"startTime",width:160},{title:"\u5907\u4EFD\u7ED3\u675F\u65F6\u95F4",field:"endTime",width:160},{title:"\u8FDB\u5EA6",field:"process",width:140,slots:{default:"process"}},{title:"\u6267\u884C\u72B6\u6001",field:"execStatus",width:70,slots:{default:"execStatus"}},{title:"\u5907\u4EFD\u6570\u91CF",slots:{default:"backupCount"},minWidth:180},{title:"\u64CD\u4F5C",width:80,slots:{default:"action"}}]}),m=()=>{const o=c.value;o&&o.getCheckboxRecords().push(...o.getCheckboxReserveRecords())},C=m,S=m,L=()=>{const o=c.value;o&&(o.clearCheckboxReserve(),o.clearCheckboxRow())},v=ae(()=>{const o=c.value,P=[];return o&&(P.push(...o.getCheckboxRecords()),P.push(...o.getCheckboxReserveRecords())),P}),g=se({execStatus:""}),y=async(o={...g,page:n})=>{const P=c.value;try{const{data:R}=await Ua(o);n.total=R.totalElements,P&&await P.loadData(R.content)}catch(R){console.error(R)}},l=o=>{n.current=o,y()},p=o=>{n.pageSize=o,y()},h=async()=>{n.current=1,await y()},O=o=>{o?[g.startBeginTime,g.startEndTime]=o:(g.startBeginTime=void 0,g.startEndTime=void 0),h()},M=r(void 0),I=r(!1),E=o=>{if(!o.taskId){Y.error("\u4EFB\u52A1id\u4E3A\u7A7A");return}M.value=o.taskId,I.value=!0},f=r([]),U=()=>{n.current=1,f.value=[],g.execStatus=void 0,g.startBeginTime=void 0,g.startEndTime=void 0,y()};let W;const j=async()=>{await y()},T=()=>{W&&clearInterval(W)};return Qe(()=>{T(),W=setInterval(j,5e3)}),vt(()=>{T()}),x({initData:U}),(o,P)=>{const R=_t,G=_e,H=Ce,A=ge,te=Ee,ue=De,re=nt,ce=he,ee=Pt,D=It,B=we,b=ve("vxe-grid");return _(),Q("div",null,[t(ce,null,{default:e(()=>[t(te,{span:12},{default:e(()=>[t(A,null,{default:e(()=>[t(R,{"model-value":f.value,"onUpdate:modelValue":P[0]||(P[0]=d=>f.value=d),style:{width:"360px"},"show-time":"",onChange:O},null,8,["model-value"]),t(H,{modelValue:g.execStatus,"onUpdate:modelValue":P[1]||(P[1]=d=>g.execStatus=d),placeholder:"\u6267\u884C\u72B6\u6001",style:{width:"140px"},"allow-clear":"",onChange:P[2]||(P[2]=d=>h())},{default:e(()=>[t(G,{value:"SUCCESS"},{default:e(()=>[i("\u6210\u529F")]),_:1}),t(G,{value:"FAILURE"},{default:e(()=>[i("\u5931\u8D25")]),_:1}),t(G,{value:"FINISH"},{default:e(()=>[i("\u90E8\u5206\u5931\u8D25")]),_:1}),t(G,{value:"RUNNING"},{default:e(()=>[i("\u8FDB\u884C\u4E2D")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(te,{span:12},{default:e(()=>[z("div",Na,[t(A,null,{default:e(()=>[v.value.length>0?(_(),Q("span",Ma,[z("span",qa," \u5DF2\u9009\u62E9\u4E86"+N(v.value.length)+"\u6761 ",1),t(ue,{onClick:L},{default:e(()=>[i("\u6E05\u7A7A")]),_:1})])):K("",!0),t(re,{content:"\u5F53\u524D\u5217\u8868\u6BCF5\u79D2\u4F1A\u81EA\u52A8\u5237\u65B0,\u60A8\u4E5F\u53EF\u4EE5\u70B9\u51FB\u5237\u65B0\u6309\u94AE\u624B\u52A8\u5237\u65B0",position:"lt"},{default:e(()=>[t(lt,{onClick:j})]),_:1})]),_:1})])]),_:1})]),_:1}),z("div",Wa,[t(b,ke({ref_key:"xGrid",ref:c,size:"small"},a.value,{onCheckboxChange:s(C),onCheckboxAll:s(S)}),{backupCount:e(({row:d})=>[z("div",null,[i(" \u603B\u6570: "),t(ee,null,{default:e(()=>[i(N(d.total),1)]),_:2},1024),i(" \u6210\u529F: "),t(ee,{color:"green"},{default:e(()=>[i(N(d.successCount),1)]),_:2},1024),i(" \u5931\u8D25: "),t(ee,{color:"red"},{default:e(()=>[i(N(d.failureCount),1)]),_:2},1024),i(" \u8FDB\u884C\u4E2D: "),t(ee,{color:"blue"},{default:e(()=>[i(N(d.runningCount),1)]),_:2},1024)])]),process:e(({row:d})=>[t(D,{percent:Number(s(ia)("%",d.process/100,!1)),size:"small",color:s(Oe)(d.execStatus)},null,8,["percent","color"])]),execStatus:e(({row:d})=>[z("div",Ga,[d.execStatus==="FAILURE"&&d.taskTrace?(_(),V(re,{key:0,position:"lt",content:s(Je)(d.taskTrace)},{default:e(()=>[z("div",{style:Fe({color:s(Oe)(d.execStatus)})},N(s(Ge)(d.execStatus)),5)]),_:2},1032,["content"])):(_(),Q("div",{key:1,style:Fe({color:s(Oe)(d.execStatus)})},N(s(Ge)(d.execStatus)),5))])]),action:e(({row:d})=>[t(A,null,{default:e(()=>[t(ue,{type:"text",onClick:w=>E(d)},{default:e(()=>[i("\u8BE6\u60C5")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:e(()=>[t(B,{ref_key:"xPagination",ref:u,current:s(n).current,"page-size":s(n).pageSize,total:s(n).total,"page-size-options":s(k),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:l,onPageSizeChange:p},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["onCheckboxChange","onCheckboxAll"])]),t(yt,{visible:I.value,"task-id":M.value,onCancel:P[3]||(P[3]=d=>I.value=!1)},null,8,["visible","task-id"])])}}}),ja=Z({__name:"index",props:{visible:{type:Boolean,default(){return!1}}},emits:["cancel"],setup(F,{emit:x}){const n=x,k=()=>{n("cancel")},c=r(),u=()=>{ie(()=>{var a;(a=c.value)==null||a.initData()})};return(a,m)=>{const C=oe;return _(),V(C,{width:"66vw",title:"\u6267\u884C\u5907\u4EFD\u8FDB\u5EA6",visible:F.visible,footer:!1,"unmount-on-close":"",onCancel:k,onOpen:u},{default:e(()=>[t(Ha,{ref_key:"execProcessListRef",ref:c},null,512)]),_:1},8,["visible"])}}}),Ka=Z({__name:"form",props:{visible:{type:Boolean,default:!1},initForm:{}},emits:["ok","cancel"],setup(F,{emit:x}){const n=F,k=x,c=r(),u=se({connectType:We.SSH,loginAccount:"",loginPassword:"",loginPort:22,defaultConnectType:!1,description:""}),a=r(""),m=r(""),C=async()=>{await c.value.validate()?console.warn("\u9A8C\u8BC1\u4E0D\u901A\u8FC7"):(await va(u),Y.success("\u63D0\u4EA4\u6210\u529F"),k("ok"))},S=r(""),L=async()=>{n.initForm?(J.assign(u,n.initForm),a.value=n.initForm.connectType,m.value=n.initForm.loginAccount,S.value=J.cloneDeep(u.loginPassword),await ie(()=>{c.value.validate()})):(u.id="",u.connectType=We.SSH,u.loginAccount="",u.loginPassword="",u.description="",u.loginPort=22,u.defaultConnectType=!1,a.value="",m.value="",await ie(()=>{c.value.resetFields()}))},v=l=>{u.id||(l===We.SSH?u.loginPort=22:u.loginPort=23),u.loginAccount&&c.value.validateField("loginAccount")},g=()=>{k("cancel")},y=async l=>{if(!l&&u.id&&S.value===u.loginPassword){const p=(await ya(u.id)).data;p&&(u.loginPassword=p)}};return(l,p)=>{const h=ct,O=dt,M=Re,I=ot,E=ft,f=pt,U=Ot,W=Le,j=oe;return _(),V(j,{visible:l.visible,width:"auto","title-align":"start","mask-closable":!1,"unmount-on-close":"",onOk:C,onCancel:g,onBeforeOpen:L},{title:e(()=>[i(N(u.id?"\u7F16\u8F91\u516C\u5171\u8D26\u53F7":"\u65B0\u5EFA\u516C\u5171\u8D26\u53F7"),1)]),default:e(()=>[z("div",null,[t(W,{ref_key:"submitFormRef",ref:c,model:u,style:{width:"600px"}},{default:e(()=>[t(M,{field:"connectType",label:"\u8FDE\u63A5\u65B9\u5F0F"},{default:e(()=>[t(O,{modelValue:u.connectType,"onUpdate:modelValue":p[0]||(p[0]=T=>u.connectType=T),type:"button",onChange:v},{default:e(()=>[t(h,{value:s($e).SSH},{default:e(()=>[i(" SSH ")]),_:1},8,["value"]),t(h,{value:s($e).TELNET},{default:e(()=>[i(" TELNET ")]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1}),t(M,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7"}],field:"loginAccount",label:"\u8D26\u53F7","validate-trigger":"blur"},{default:e(()=>[t(I,{modelValue:u.loginAccount,"onUpdate:modelValue":p[1]||(p[1]=T=>u.loginAccount=T),autocomplete:"new-password","max-length":64,"show-word-limit":""},null,8,["modelValue"])]),_:1}),t(M,{field:"loginPassword",label:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}],"validate-trigger":"blur"},{default:e(()=>[t(E,{modelValue:u.loginPassword,"onUpdate:modelValue":p[2]||(p[2]=T=>u.loginPassword=T),autocomplete:"new-password",onVisibilityChange:y},null,8,["modelValue"])]),_:1}),t(M,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7AEF\u53E3"}],field:"loginPort",label:"\u7AEF\u53E3","validate-trigger":"blur"},{default:e(()=>[t(f,{modelValue:u.loginPort,"onUpdate:modelValue":p[3]||(p[3]=T=>u.loginPort=T)},null,8,["modelValue"])]),_:1}),t(M,{field:"description",label:"\u63CF\u8FF0","validate-trigger":"blur",rules:[{maxLength:500,message:"\u63CF\u8FF0\u957F\u5EA6\u6700\u5927\u4E0D\u80FD\u8D85\u8FC7500"}]},{default:e(()=>[t(U,{modelValue:u.description,"onUpdate:modelValue":p[4]||(p[4]=T=>u.description=T),"show-word-limit":"","max-length":500},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),Qa={style:{height:"calc(100vh - 116px)"}},Ja=Z({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["cancel"],setup(F,{expose:x,emit:n}){const k=n,{loading:c,setLoading:u}=be(!1),{pagination:a,pageSizeOptions:m}=xe(),C=r(),S=r(),L=r({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"id",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:[{title:"\u8FDE\u63A5\u65B9\u5F0F",field:"connectType",width:80},{title:"\u8D26\u6237",field:"loginAccount",minWidth:80},{title:"\u7AEF\u53E3",field:"loginPort",width:80},{title:"\u662F\u5426\u9ED8\u8BA4",field:"defaultConnectType",width:80,formatter:({cellValue:f})=>f?"\u662F":"\u5426"},{title:"\u63CF\u8FF0",field:"description",minWidth:120},{title:"\u521B\u5EFA\u4EBA",field:"createUser",width:120},{title:"\u64CD\u4F5C",width:180,fixed:"right",slots:{default:"action"}}]}),v=se({}),g=async(f={...v,page:a})=>{u(!0);const U=C.value;try{const{data:W}=await ma(f);a.total=W.totalElements,U&&await U.reloadData(W.content)}catch(W){console.error(W)}finally{u(!1)}},y=f=>{a.current=f,g()},l=f=>{a.pageSize=f,g()};x({backToFirstPageFetchData:()=>{a.current=1,g()}});const h=r(!1),O=r(),M=f=>{O.value=J.cloneDeep(f),h.value=!0},I=async f=>{me.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,content:`\u786E\u5B9A\u5C06\u8D26\u53F7${f.loginAccount}\u8BBE\u7F6E\u4E3A${f.connectType}\u7684\u9ED8\u8BA4\u8FDE\u63A5\u65B9\u5F0F?`,onOk:async()=>{await ga(f),Y.success("\u8BBE\u7F6E\u6210\u529F"),await g()}})},E=async f=>{me.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,content:"\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u8BE5\u8D26\u53F7,\u662F\u5426\u7EE7\u7EED?",onOk:async()=>{await Ca(f.id),Y.success("\u5220\u9664\u6210\u529F"),await g()}})};return(f,U)=>{const W=Ee,j=Be,T=ge,o=he,P=De,R=we,G=ve("vxe-grid"),H=oe;return _(),V(H,{width:"55vw",visible:F.visible,"mask-closable":!0,footer:null,"destroy-on-close":!0,title:"\u516C\u5171\u8D26\u53F7\u914D\u7F6E",onCancel:U[4]||(U[4]=A=>k("cancel")),onOpen:g},{default:e(()=>[z("div",null,[t(o,null,{default:e(()=>[t(W,{span:14}),t(W,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(T,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(j,{type:"primary",onClick:U[0]||(U[0]=A=>{O.value=void 0,h.value=!0})},{default:e(()=>[i(" \u65B0\u5EFA ")]),_:1})]),_:1})]),_:1})]),_:1}),z("div",Qa,[t(G,ke({ref_key:"xGrid",ref:C,loading:s(c)},L.value),{index:e(({rowIndex:A})=>[i(N(A+1+(s(a).current-1)*s(a).pageSize),1)]),action:e(({row:A})=>[t(T,null,{default:e(()=>[t(P,{type:"text",disabled:A.defaultConnectType,onClick:te=>I(A)},{default:e(()=>[i(" \u8BBE\u4E3A\u9ED8\u8BA4 ")]),_:2},1032,["disabled","onClick"]),t(P,{type:"text",onClick:te=>M(A)},{default:e(()=>[i("\u7F16\u8F91")]),_:2},1032,["onClick"]),t(P,{type:"text",onClick:te=>E(A)},{default:e(()=>[i(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:e(()=>[t(R,{ref_key:"xPagination",ref:S,current:s(a).current,"page-size":s(a).pageSize,total:s(a).total,"page-size-options":s(m),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:y,onPageSizeChange:l},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),t(Ka,{visible:h.value,"onUpdate:visible":U[1]||(U[1]=A=>h.value=A),"init-form":O.value,onOk:U[2]||(U[2]=A=>{h.value=!1,g()}),onCancel:U[3]||(U[3]=A=>h.value=!1)},null,8,["visible","init-form"])]),_:1},8,["visible"])}}});function Ya(F){return X.post("/deviceManufacturerConfigBackupCommand/pageList",F)}function Za(F){return X.post("/deviceManufacturerConfigBackupCommand/saveOrUpdateConfigBackupCommand",F)}const Xa=Z({__name:"form",props:{visible:{type:Boolean,default:!1},initForm:{}},emits:["ok","cancel"],setup(F,{emit:x}){const n=F,k=x,c=r(),u=se({name:"",configBackupCommand:""}),a=async()=>{await c.value.validate()?console.warn("\u9A8C\u8BC1\u4E0D\u901A\u8FC7"):(await Za(u),Y.success("\u63D0\u4EA4\u6210\u529F"),k("ok"))},m=r(""),C=r(""),S=at(async(y,l)=>{if(y.toLowerCase()!==m.value.toLowerCase()){const{data:p}=await aa(y);p&&l("\u8BBE\u5907\u5382\u5546\u540D\u79F0\u5DF2\u5B58\u5728")}},500),L=at(async(y,l)=>{if(y.toLowerCase()!==C.value.toLowerCase()){const{data:p}=await ua(y);p&&l("\u8BBE\u5907\u5382\u5546\u7F16\u7801\u5DF2\u5B58\u5728")}},500),v=async()=>{n.initForm?(J.assign(u,n.initForm),m.value=n.initForm.name,C.value=n.initForm.code,c.value.validate()):(u.name="",u.configBackupCommand="",u.id="",u.buildIn=!1,m.value="",C.value="",c.value.resetFields())},g=()=>{k("cancel")};return(y,l)=>{const p=ot,h=Re,O=Le,M=oe;return _(),V(M,{visible:y.visible,width:"auto","title-align":"start","mask-closable":!1,onOk:a,onCancel:g,onBeforeOpen:v},{title:e(()=>[i(N(u.id?"\u7F16\u8F91\u5907\u4EFD\u547D\u4EE4":"\u65B0\u5EFA"),1)]),default:e(()=>[z("div",null,[t(O,{ref_key:"submitFormRef",ref:c,model:u,style:{width:"600px"}},{default:e(()=>[t(h,{field:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5382\u5546\u540D\u79F0"},{validator:s(S)}],label:"\u5382\u5546\u540D\u79F0","validate-trigger":"blur"},{default:e(()=>[t(p,{modelValue:u.name,"onUpdate:modelValue":l[0]||(l[0]=I=>u.name=I),disabled:u.buildIn,"max-length":64},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),t(h,{field:"code",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5382\u5546\u7F16\u7801"},{validator:s(L)}],label:"\u5382\u5546\u7F16\u7801","validate-trigger":"blur"},{default:e(()=>[t(p,{modelValue:u.code,"onUpdate:modelValue":l[1]||(l[1]=I=>u.code=I),disabled:u.buildIn,"max-length":64},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),t(h,{field:"configBackupCommand",label:"\u5907\u4EFD\u547D\u4EE4","validate-trigger":"blur"},{default:e(()=>[t(p,{modelValue:u.configBackupCommand,"onUpdate:modelValue":l[2]||(l[2]=I=>u.configBackupCommand=I)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),eu={style:{height:"calc(100vh - 116px)"}},tu=Z({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["cancel"],setup(F,{expose:x,emit:n}){const k=n,{loading:c,setLoading:u}=be(!1),{pagination:a,pageSizeOptions:m}=xe(),C=r(),S=r(),L=r({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"id",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:[{title:"\u5382\u5546\u540D\u79F0",field:"name",minWidth:80},{title:"\u5907\u4EFD\u547D\u4EE4",field:"configBackupCommand",minWidth:200},{title:"\u64CD\u4F5C",width:80,fixed:"right",slots:{default:"action"}}]}),v=se({}),g=async(I={...v,page:a})=>{u(!0);const E=C.value;try{const{data:f}=await Ya(I);a.total=f.totalElements,E&&await E.reloadData(f.content)}catch(f){console.error(f)}finally{u(!1)}},y=I=>{a.current=I,g()},l=I=>{a.pageSize=I,g()};x({backToFirstPageFetchData:()=>{a.current=1,g()}});const h=r(!1),O=r(),M=I=>{O.value=J.cloneDeep(I),h.value=!0};return(I,E)=>{const f=Ee,U=Be,W=ge,j=he,T=De,o=we,P=ve("vxe-grid"),R=oe;return _(),V(R,{width:"55vw",visible:F.visible,"mask-closable":!0,footer:null,"destroy-on-close":!0,title:"\u5907\u4EFD\u547D\u4EE4\u914D\u7F6E",onCancel:E[4]||(E[4]=G=>k("cancel")),onOpen:g},{default:e(()=>[z("div",null,[t(j,null,{default:e(()=>[t(f,{span:14}),t(f,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(W,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(U,{type:"primary",onClick:E[0]||(E[0]=G=>{O.value=void 0,h.value=!0})},{default:e(()=>[i(" \u65B0\u5EFA ")]),_:1})]),_:1})]),_:1})]),_:1}),z("div",eu,[t(P,ke({ref_key:"xGrid",ref:C,loading:s(c)},L.value),{index:e(({rowIndex:G})=>[i(N(G+1+(s(a).current-1)*s(a).pageSize),1)]),action:e(({row:G})=>[t(W,null,{default:e(()=>[t(T,{type:"text",onClick:H=>M(G)},{default:e(()=>[i("\u7F16\u8F91")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:e(()=>[t(o,{ref_key:"xPagination",ref:S,current:s(a).current,"page-size":s(a).pageSize,total:s(a).total,"page-size-options":s(m),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:y,onPageSizeChange:l},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),t(Xa,{visible:h.value,"onUpdate:visible":E[1]||(E[1]=G=>h.value=G),"init-form":O.value,onOk:E[2]||(E[2]=G=>{h.value=!1,g()}),onCancel:E[3]||(E[3]=G=>h.value=!1)},null,8,["visible","init-form"])]),_:1},8,["visible"])}}});function au(F){return X.post("/configBackupScheduler/updateConfigBackupJobInfo",F)}function uu(){return X.get("/configBackupScheduler/getConfigBackupJobInfo")}const ou=Z({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["ok","cancel"],setup(F,{emit:x}){const n=x,{loading:k,setLoading:c}=be(!1),u=se({cycle:"WEEK",dayOfWeek:"",time:"",triggerStatus:!1}),a=r(),m=async()=>{if(!await a.value.validate()){c(!0);try{await au(u),Y.success("\u8BBE\u7F6E\u6210\u529F"),n("ok")}catch(g){console.error(g)}finally{c(!1)}}},C=r(""),S=async()=>{C.value="",u.cycle="",u.dayOfWeek="",u.time="";const{data:v}=await uu();if(v.success){if(u.triggerStatus=v.result.triggerStatus!==0,v.result.scheduleType==="CRON"){const y=v.result.scheduleConf.split(" ");y[3]==="*"&&y[5]==="?"?u.cycle="DAY":(u.cycle="WEEK",u.dayOfWeek=y[5]),u.time=`${y[2].padStart(2,"0")}:${y[1].padStart(2,"0")}:${y[0].padStart(2,"0")}`}}else C.value=v.message},L=ae(()=>{const v={cycle:[{required:!0,message:"\u8BF7\u9009\u62E9\u5468\u671F"}],time:[{required:!0,message:"\u8BF7\u9009\u62E9\u65F6\u95F4"}]};return u.cycle==="WEEK"&&(v.dayOfWeek=[{required:!0,message:"\u8BF7\u9009\u62E9\u661F\u671F"}]),v});return(v,g)=>{const y=_e,l=Ce,p=Re,h=Rt,O=Ct,M=mt,I=Le,E=me;return _(),V(E,{width:500,visible:v.visible,title:"\u5B9A\u65F6\u5468\u671F\u8BBE\u7F6E","mask-closable":!1,"title-align":"start","ok-loading":s(k),onOk:m,onCancel:g[4]||(g[4]=f=>n("cancel")),onBeforeOpen:S},{default:e(()=>[t(I,{ref_key:"submitFormRef",ref:a,model:u,rules:L.value},{default:e(()=>[t(p,{field:"cycle",label:"\u5468\u671F"},{default:e(()=>[t(l,{modelValue:u.cycle,"onUpdate:modelValue":g[0]||(g[0]=f=>u.cycle=f),style:{width:"100%"}},{default:e(()=>[t(y,{value:"DAY"},{default:e(()=>[i("\u6BCF\u5929")]),_:1}),t(y,{value:"WEEK"},{default:e(()=>[i("\u6BCF\u5468")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u.cycle==="WEEK"?(_(),V(p,{key:0,field:"dayOfWeek",label:"\u661F\u671F"},{default:e(()=>[t(l,{modelValue:u.dayOfWeek,"onUpdate:modelValue":g[1]||(g[1]=f=>u.dayOfWeek=f),style:{width:"100%"}},{default:e(()=>[t(y,{value:"2"},{default:e(()=>[i("\u661F\u671F\u4E00")]),_:1}),t(y,{value:"3"},{default:e(()=>[i("\u661F\u671F\u4E8C")]),_:1}),t(y,{value:"4"},{default:e(()=>[i("\u661F\u671F\u4E09")]),_:1}),t(y,{value:"5"},{default:e(()=>[i("\u661F\u671F\u56DB")]),_:1}),t(y,{value:"6"},{default:e(()=>[i("\u661F\u671F\u4E94")]),_:1}),t(y,{value:"7"},{default:e(()=>[i("\u661F\u671F\u516D")]),_:1}),t(y,{value:"1"},{default:e(()=>[i("\u661F\u671F\u65E5")]),_:1})]),_:1},8,["modelValue"])]),_:1})):K("",!0),t(p,{field:"time",label:"\u65F6\u95F4"},{default:e(()=>[t(h,{modelValue:u.time,"onUpdate:modelValue":g[2]||(g[2]=f=>u.time=f),style:{width:"100%"},"allow-clear":!1},null,8,["modelValue"])]),_:1}),t(p,{field:"triggerStatus",label:"\u4EFB\u52A1\u72B6\u6001"},{default:e(()=>[C.value===""?(_(),V(O,{key:0,modelValue:u.triggerStatus,"onUpdate:modelValue":g[3]||(g[3]=f=>u.triggerStatus=f)},{checked:e(()=>[i("\u5F00\u542F")]),unchecked:e(()=>[i("\u505C\u6B62")]),_:1},8,["modelValue"])):(_(),V(M,{key:1,type:"error"},{default:e(()=>[i(N(C.value),1)]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","ok-loading"])}}}),nu={key:0},lu={style:{height:"calc(100vh - 146px)"}},iu=["onClick"],su=Z({__name:"config-backup-device-table",props:{extraParams:{}},setup(F){const x=F,{loading:n,setLoading:k}=be(!1),{pagination:c,pageSizeOptions:u}=xe(),a=r(),m=r(),C=r({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"id",isHover:!0},checkboxConfig:{reserve:!0,checkMethod:({row:D})=>D.manufacturerCode&&D.enable},showOverflow:"tooltip",columns:[{type:"checkbox",width:40},{title:"\u8BBE\u5907\u540D\u79F0",field:"displayName",minWidth:200,slots:{default:"displayName"}},{title:"IP",field:"ip",minWidth:120},{title:"\u5382\u5546",field:"manufacturerName",minWidth:80},{title:"\u8BBE\u5907\u7C7B\u578B",field:"deviceTypeName",minWidth:80},{title:"\u6267\u884C\u72B6\u6001",field:"latestBackupStatus",minWidth:80,slots:{default:"latestBackupStatus"}},{title:"\u6267\u884C\u5F02\u5E38\u4FE1\u606F",field:"latestBackupErrorMessage",minWidth:120,slots:{default:"latestBackupErrorMessage"}},{title:"\u8BBE\u5907\u578B\u53F7",field:"deviceModel",minWidth:120},{title:"\u542F\u7528\u5907\u4EFD",field:"enable",width:80,slots:{default:"enable"}},{title:"\u5F00\u59CB\u65F6\u95F4",field:"latestBackupTime",width:160},{title:"\u64CD\u4F5C",width:220,fixed:"right",slots:{default:"action"}}]}),S=()=>{const D=a.value;D&&D.getCheckboxRecords().push(...D.getCheckboxReserveRecords())},L=S,v=S,g=()=>{const D=a.value;D&&(D.clearCheckboxReserve(),D.clearCheckboxRow())},y=ae(()=>{const D=a.value,B=[];return D&&(B.push(...D.getCheckboxRecords()),B.push(...D.getCheckboxReserveRecords())),B});let l=se({queryStr:"",deviceTypeGroupQueryStr:"",latestBackupStatus:"",enable:!0});const p=async(D={...l,page:c})=>{k(!0);const B=a.value;try{const{data:b}=await Yt(D);c.total=b.totalElements,B&&await B.loadData(b.content)}catch(b){console.error(b)}finally{k(!1)}};Ke(()=>x.extraParams,D=>{D&&(l=J.assign(l,D),c.current=1,p())},{deep:!0});const h=D=>{c.current=D,p()},O=D=>{c.pageSize=D,p()},M=()=>{p()},I=at(async()=>{await p(),He.emit("refresh-config-backup-left-tree-list",l)},500),E=r(!1),f=r(!1),U=r(!1),W=r(!1),j=r(!1),T=r(!1),o=r(!1),P=r(),R=r(),G=D=>{D==="automation-proxy-manage"&&(E.value=!0)},H=D=>{R.value=J.cloneDeep(D),U.value=!0},A=async D=>{R.value=J.cloneDeep(D),f.value=!0},te=async()=>{me.confirm({title:"\u63D0\u793A",content:`\u6B64\u64CD\u4F5C\u5C06\u5907\u4EFD\u6240\u9009${y.value.length}\u6761\u7F51\u7EDC\u8BBE\u5907\u914D\u7F6E , \u662F\u5426\u7EE7\u7EED?`,okText:"\u786E\u5B9A",async onOk(){try{const D=y.value.map(B=>B.id);await ut(D),Y.success("\u5F00\u59CB\u5907\u4EFD..."),g()}catch{Y.error("\u6267\u884C\u5931\u8D25")}}})},ue=async D=>{me.confirm({title:"\u63D0\u793A",content:`\u6B64\u64CD\u4F5C\u5C06\u5907\u4EFD\u7F51\u7EDC\u8BBE\u5907${D.displayName}\u914D\u7F6E , \u662F\u5426\u7EE7\u7EED?`,okText:"\u786E\u5B9A",async onOk(){try{await ut([D.id]),Y.success("\u5F00\u59CB\u5907\u4EFD...")}catch{Y.error("\u6267\u884C\u5931\u8D25")}}})},re=D=>D.manufacturerCode?D.enable?"":"\u672A\u542F\u7528":"\u672A\u914D\u7F6E\u5382\u5546",ce=async(D,B)=>{try{await Zt({id:B.id,enable:D});const b="".concat(D?"\u542F\u7528":"\u7981\u7528").concat("\u6210\u529F");Y.success(b)}catch{Y.error("\u64CD\u4F5C\u5931\u8D25")}};Qe(()=>{p()});const ee=D=>{const B=D.cell.getElementsByClassName("table-link")[0],{row:b}=D,{column:d}=D;return B&&B.scrollWidth>B.offsetWidth&&d.field==="displayName"&&b[d.field]?b[d.field]:null};return(D,B)=>{const b=je,d=_e,w=Ce,Se=ge,ye=Ee,fe=De,Ae=Lt,ze=Be,Te=Dt,pe=zt,Ue=Ut,Ye=Nt,Ze=wt,Xe=xt,et=Mt,q=he,ne=Ct,Ft=nt,bt=we,kt=ve("vxe-grid"),Ne=gt("read-only");return _(),Q("div",null,[t(q,null,{default:e(()=>[t(ye,{span:14},{default:e(()=>[t(Se,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(b,{modelValue:s(l).queryStr,"onUpdate:modelValue":B[0]||(B[0]=$=>s(l).queryStr=$),style:{width:"320px"},placeholder:"\u8BBE\u5907\u540D\u79F0/IP","allow-clear":"",onSearch:M,onInput:s(I),onClear:s(I)},null,8,["modelValue","onInput","onClear"]),t(w,{modelValue:s(l).enable,"onUpdate:modelValue":B[1]||(B[1]=$=>s(l).enable=$),style:{width:"120px"},placeholder:"\u542F\u7528\u72B6\u6001","allow-clear":"",onChange:s(I)},{default:e(()=>[t(d,{value:!0},{default:e(()=>[i("\u542F\u7528")]),_:1}),t(d,{value:!1},{default:e(()=>[i("\u505C\u7528")]),_:1})]),_:1},8,["modelValue","onChange"]),t(w,{modelValue:s(l).latestBackupStatus,"onUpdate:modelValue":B[2]||(B[2]=$=>s(l).latestBackupStatus=$),style:{width:"120px"},placeholder:"\u6267\u884C\u72B6\u6001","allow-clear":"",onChange:s(I)},{default:e(()=>[t(d,{value:"SUCCESS"},{default:e(()=>[i("\u6210\u529F")]),_:1}),t(d,{value:"FAILURE"},{default:e(()=>[i("\u5931\u8D25")]),_:1}),t(d,{value:"RUNNING"},{default:e(()=>[i("\u8FDB\u884C\u4E2D")]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),t(ye,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(Se,{style:{"margin-bottom":"5px"}},{default:e(()=>[y.value.length>0?(_(),Q("span",nu,[z("span",null,"\u5DF2\u9009\u62E9\u4E86"+N(y.value.length)+"\u6761",1),t(fe,{onClick:g},{default:e(()=>[i("\u6E05\u7A7A")]),_:1})])):K("",!0),t(lt,{onClick:p}),t(et,{"popup-max-height":!1,position:"br",onSelect:G},{content:e(()=>[t(pe,{disabled:y.value.length===0,onClick:te},{default:e(()=>[t(Te),i(" \u6267\u884C\u5907\u4EFD ")]),_:1},8,["disabled"]),t(pe,{onClick:B[3]||(B[3]=$=>W.value=!0)},{default:e(()=>[t(Ue),i(" \u6267\u884C\u5907\u4EFD\u8FDB\u5EA6 ")]),_:1}),t(pe,{onClick:B[4]||(B[4]=$=>o.value=!0)},{default:e(()=>[t(Ye),i(" \u5B9A\u65F6\u5468\u671F\u8BBE\u7F6E ")]),_:1}),t(pe,{onClick:B[5]||(B[5]=$=>j.value=!0)},{default:e(()=>[t(Ze),i(" \u516C\u5171\u8D26\u53F7\u914D\u7F6E ")]),_:1}),t(pe,{onClick:B[6]||(B[6]=$=>T.value=!0)},{default:e(()=>[t(Xe),i(" \u5907\u4EFD\u547D\u4EE4\u914D\u7F6E ")]),_:1})]),default:e(()=>[Ve((_(),V(ze,null,{default:e(()=>[i(" \u7BA1\u7406 "),t(Ae)]),_:1})),[[Ne]])]),_:1})]),_:1})]),_:1})]),_:1}),z("div",lu,[t(kt,ke({ref_key:"xGrid",ref:a,loading:s(n)},C.value,{"tooltip-config":{contentMethod:ee},onCheckboxChange:s(L),onCheckboxAll:s(v)}),{index:e(({rowIndex:$})=>[i(N($+1+(s(c).current-1)*s(c).pageSize),1)]),displayName:e(({row:$})=>[z("div",{class:"table-link",onClick:de=>H($)},N($.displayName),9,iu)]),latestBackupStatus:e(({row:$})=>[z("div",{style:Fe({color:s(Oe)($.latestBackupStatus)})},N(s(Ge)($.latestBackupStatus)),5)]),latestBackupErrorMessage:e(({row:$})=>[i(N(s(Je)($.latestBackupErrorMessage)),1)]),enable:e(({row:$})=>[t(ne,{"model-value":$.enable,"onUpdate:modelValue":de=>$.enable=de,size:"small",type:"line",disabled:s(ht)(),onChange:de=>ce(de,$)},{checked:e(()=>[i("\u542F\u7528")]),unchecked:e(()=>[i("\u7981\u7528")]),_:2},1032,["model-value","onUpdate:modelValue","disabled","onChange"])]),action:e(({row:$})=>[t(Se,null,{default:e(()=>[$.manufacturerCode&&$.enable?Ve((_(),V(fe,{key:1,disabled:!($.manufacturerCode&&$.enable),onClick:de=>ue($)},{default:e(()=>[i(" \u6267\u884C\u5907\u4EFD ")]),_:2},1032,["disabled","onClick"])),[[Ne]]):(_(),V(Ft,{key:0,content:re($)},{default:e(()=>[Ve((_(),V(fe,{disabled:!($.manufacturerCode&&$.enable),onClick:de=>ue($)},{default:e(()=>[i(" \u6267\u884C\u5907\u4EFD ")]),_:2},1032,["disabled","onClick"])),[[Ne]])]),_:2},1032,["content"])),t(fe,{type:"text",onClick:de=>H($)},{default:e(()=>[i("\u5907\u4EFD\u8BB0\u5F55")]),_:2},1032,["onClick"]),Ve((_(),V(fe,{type:"text",onClick:de=>A($)},{default:e(()=>[i("\u7F16\u8F91")]),_:2},1032,["onClick"])),[[Ne]])]),_:2},1024)]),pager:e(()=>[t(bt,{ref_key:"xPagination",ref:m,current:s(c).current,"page-size":s(c).pageSize,total:s(c).total,"page-size-options":s(u),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:h,onPageSizeChange:O},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading","tooltip-config","onCheckboxChange","onCheckboxAll"])]),t(pa,{visible:E.value,onOk:B[7]||(B[7]=$=>E.value=!1),onCancel:B[8]||(B[8]=$=>E.value=!1)},null,8,["visible"]),t(Ea,{visible:f.value,"init-form-data":R.value,onOk:B[9]||(B[9]=$=>{f.value=!1,p()}),onCancel:B[10]||(B[10]=$=>f.value=!1)},null,8,["visible","init-form-data"]),t(yt,{visible:U.value,"row-data":R.value,onCancel:B[11]||(B[11]=$=>{U.value=!1,p()})},null,8,["visible","row-data"]),t(ja,{ref_key:"execProcessRef",ref:P,visible:W.value,onCancel:B[12]||(B[12]=$=>{W.value=!1,p()})},null,8,["visible"]),t(Ja,{visible:j.value,onCancel:B[13]||(B[13]=$=>j.value=!1)},null,8,["visible"]),t(tu,{visible:T.value,onCancel:B[14]||(B[14]=$=>T.value=!1)},null,8,["visible"]),t(ou,{visible:o.value,onOk:B[15]||(B[15]=$=>o.value=!1),onCancel:B[16]||(B[16]=$=>o.value=!1)},null,8,["visible"])])}}}),ru={class:"page-container"},cu={class:"page-panel"},du={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"6px","margin-top":"6px"}},fu={style:{width:"50%"}},pu={style:{display:"flex","align-items":"center"}},mu={style:{"padding-left":"4px"}},vu={style:{height:"24px",display:"flex","align-items":"center",width:"58vw"}},gu={style:{"white-space":"nowrap"}},_u={class:"page-panel",style:{height:"calc(100vh - 84px)","overflow-y":"auto"}},Ju=Z({__name:"index",setup(F){const{loading:x,setLoading:n}=be(),k=r(""),c=r(!0),u=r(!0),a=r({queryStr:"",configEnable:!0,latestBackupStatus:void 0}),m=r([]),C=r([]),S=async()=>{try{n(!0),C.value=(await sa({category:"network_device",...a.value})).data}catch(E){console.error(E)}finally{n(!1)}},L=async()=>{try{n(!0);const E=J.cloneDeep(a.value);E.enable=a.value.configEnable,m.value=(await Xt(E)).data}catch(E){console.error(E)}finally{n(!1)}},v=ae(()=>k.value!==""?c.value?Me(k.value,qe("data.total",m.value)):Me(k.value,m.value):c.value?qe("data.total",m.value):m.value),g=ae(()=>k.value!==""?u.value?Me(k.value,qe("data.count",C.value)):Me(k.value,C.value):u.value?qe("data.count",C.value):C.value),y=r(),l=r({deviceTypeGroupQueryStr:"",businessId:""}),p=E=>{[l.value.deviceTypeGroupQueryStr]=E,l.value.businessId=""},h=(E,f)=>{console.log(f),[l.value.businessId]=E,l.value.deviceTypeGroupQueryStr=""},O=r("business"),M=E=>{E==="business"?S():E==="manufacturer"&&L()},I=r();return He.on("refresh-config-backup-left-tree-list",E=>{E&&(a.value.queryStr=E.queryStr,a.value.configEnable=E.enable,a.value.latestBackupStatus=E.latestBackupStatus),M(O.value)}),He.on("edit-config-backup-device-success-event",async E=>{const f=E;await M(O.value);const U=`${f.manufacturerCode}###${f.deviceType}###${f.deviceModel}`;l.value.deviceTypeGroupQueryStr!==""&&l.value.deviceTypeGroupQueryStr.split("###").length===3&&l.value.deviceTypeGroupQueryStr!==U&&await ie(()=>{I.value.selectNode([U],!0)})}),Qe(()=>{S()}),(E,f)=>{const U=je,W=_e,j=Ce,T=qt,o=ve("icon-font"),P=Wt,R=ge,G=Gt,H=Ht;return _(),Q("div",ru,[t(ra,{"left-width":{xxl:4,xl:4,lg:4,md:6,sm:6,xs:6},mode:"space",height:"calc(100vh - 84px)"},{left:e(()=>[z("div",cu,[t(U,{modelValue:k.value,"onUpdate:modelValue":f[0]||(f[0]=A=>k.value=A),"allow-clear":!0,placeholder:O.value==="business"?"\u8BF7\u8F93\u5165\u76EE\u5F55\u540D\u79F0\u641C\u7D22":"\u8BF7\u8F93\u5165\u8BBE\u5907\u7C7B\u578B/\u578B\u53F7\u641C\u7D22"},null,8,["modelValue","placeholder"]),z("div",du,[z("div",fu,[t(j,{modelValue:O.value,"onUpdate:modelValue":f[1]||(f[1]=A=>O.value=A),size:"mini",bordered:!1,onChange:M},{default:e(()=>[t(W,{value:"business"},{default:e(()=>[i("\u76EE\u5F55\u89C6\u56FE")]),_:1}),t(W,{value:"manufacturer"},{default:e(()=>[i("\u8BBE\u5907\u7C7B\u578B\u89C6\u56FE")]),_:1})]),_:1},8,["modelValue"])]),z("div",null,[O.value==="manufacturer"?(_(),V(T,{key:0,modelValue:c.value,"onUpdate:modelValue":f[2]||(f[2]=A=>c.value=A)},{default:e(()=>[i(" \u8FC7\u6EE4\u7A7A\u7C7B\u578B ")]),_:1},8,["modelValue"])):K("",!0),O.value==="business"?(_(),V(T,{key:1,modelValue:u.value,"onUpdate:modelValue":f[3]||(f[3]=A=>u.value=A)},{default:e(()=>[i(" \u8FC7\u6EE4\u7A7A\u76EE\u5F55 ")]),_:1},8,["modelValue"])):K("",!0)])]),t(H,{loading:s(x),tip:"\u6B63\u5728\u52A0\u8F7D...",style:{width:"100%",height:"100%"}},{default:e(()=>[t(G,{style:{height:"calc(100vh - 177px)",overflow:"auto","padding-bottom":"20px"}},{default:e(()=>[O.value==="manufacturer"&&v.value.length>0?(_(),V(P,{key:0,ref_key:"manufacturerTreeRef",ref:I,style:{"white-space":"nowrap"},"block-node":"","default-expand-all":!1,data:v.value,onSelect:p},{title:e(A=>[z("div",pu,[A.data.logoIcon?(_(),V(o,{key:0,type:A.data.logoIcon},null,8,["type"])):K("",!0),A.data.level==="1"&&!A.data.logoIcon?(_(),V(o,{key:1,type:"icon-device-manufacturer"})):K("",!0),A.data.level==="2"?(_(),V(o,{key:2,type:"icon-device"})):K("",!0),A.isLeaf?(_(),V(o,{key:3,type:"icon-device"})):K("",!0),z("div",mu,N(A.title+" ("+A.data.total+")"),1)])]),_:1},8,["data"])):K("",!0),O.value==="business"&&g.value.length>0?(_(),V(P,{key:1,ref:"treeRef",size:"mini","default-expand-all":!1,data:g.value,"action-on-node-click":"expand",onSelect:h},{title:e(A=>[z("div",vu,[t(R,null,{default:e(()=>[A.id!=="0"?(_(),V(o,{key:0,type:A.data.type==="FOLDER"?"icon-folder":"icon-cube",size:16,style:{color:"var(--color-text-2)"}},null,8,["type"])):K("",!0),z("div",gu,N(A.title+"("+A.data.count+")"),1)]),_:2},1024)])]),_:1},8,["data"])):K("",!0)]),_:1})]),_:1},8,["loading"])])]),right:e(()=>[z("div",_u,[t(su,{ref_key:"configBackupDeviceTableRef",ref:y,"extra-params":l.value},null,8,["extra-params"])])]),_:1})])}}});export{Ju as default};
