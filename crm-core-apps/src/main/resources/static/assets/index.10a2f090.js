import{d as M,c as Y,D as l,E as p,H as i,aS as o,aI as e,aU as U,aV as q,bm as J,aH as y,aW as v,bn as X,f as E,u as k,aY as f,aZ as V,aP as O,bo as R,bp as T,aO as ee,aN as H,bq as oe,a$ as se,r as ae,br as ne,bg as te,ba as N,bs as le,aM as ue,bt as re}from"./arco.a97fe066.js";import{e as ie,F as ce}from"./index.21d6b8e1.js";import{l as de}from"./logo.d5f33f3a.js";import{u as K,_ as L,a as W,r as P,I as Z,b as _e,c as me,d as pe,e as ge,f as fe,g as ve}from"./index.e9d54774.js";/* empty css              *//* empty css               */import{f as be,g as ye}from"./vue.4eb70094.js";import{s as he,l as Fe,i as we}from"./sys-license.fc422dc6.js";/* empty css               */import"./chart.a235fbdf.js";/* empty css               */const I="/umop/assets/login-banner.426fb77f.png",Ee={class:"banner"},Be={class:"banner-inner"},Ce={class:"carousel-title"},Se={class:"carousel-sub-title"},$e=["src"],Ie=M({__name:"banner",setup(A){const{t:s}=K(),a=Y(()=>[{slogan:s("login.banner.slogan1"),subSlogan:s("login.banner.subSlogan1"),image:I},{slogan:s("login.banner.slogan2"),subSlogan:s("login.banner.subSlogan2"),image:I},{slogan:s("login.banner.slogan3"),subSlogan:s("login.banner.subSlogan3"),image:I},{slogan:s("login.banner.slogan4"),subSlogan:s("login.banner.subSlogan4"),image:I},{slogan:s("login.banner.slogan5"),subSlogan:s("login.banner.subSlogan5"),image:I}]);return(r,B)=>{const t=X,b=J;return l(),p("div",Ee,[i("div",Be,[o(b,{class:"carousel","animation-name":"fade"},{default:e(()=>[(l(!0),p(U,null,q(a.value,c=>(l(),y(t,{key:c.slogan},{default:e(()=>[(l(),p("div",{key:c.slogan,class:"carousel-item"},[i("div",Ce,v(c.slogan),1),i("div",Se,v(c.subSlogan),1),i("img",{class:"carousel-image",src:c.image},null,8,$e)]))]),_:2},1024))),128))]),_:1})])])}}});const ke=L(Ie,[["__scopeId","data-v-043fff32"]]),Ae={key:0},Me={key:1},xe={key:2},De=M({__name:"reset-password-form",props:{visible:{type:Boolean,required:!0,default:!1}},emits:["close"],setup(A,{emit:s}){const a=E({account:"",selectedMediaId:""}),r=E({sysUserMedias:[],mailAddress:""}),B=s,t=E("inputAccount"),{loading:b,setLoading:c}=W(!1),h=async()=>{try{c(!0),t.value==="inputAccount"?(r.value=(await P({userAccount:a.value.account})).data,r.value.result==="1"?t.value="resetSuccess":t.value="selectEmail"):t.value==="selectEmail"&&(r.value=(await P({userAccount:a.value.account,selectedMediaId:a.value.selectedMediaId})).data,r.value.result==="1"&&(t.value="resetSuccess"))}catch(_){console.error(_)}finally{c(!1)}},C=()=>{a.value={account:"",selectedMediaId:""},B("close")};return(_,m)=>{const x=Z,u=O,n=R,g=T,S=se,F=ee,$=H,D=oe;return l(),y(D,{"title-align":"start",title:"\u91CD\u7F6E\u5BC6\u7801",visible:A.visible,top:"20vh","align-center":!1,"mask-closable":!1,draggable:"","unmount-on-close":"",onBeforeOpen:m[2]||(m[2]=d=>t.value="inputAccount"),onCancel:C},{footer:e(()=>[t.value==="inputAccount"?(l(),y($,{key:0,type:"primary",loading:k(b),onClick:h},{default:e(()=>[f(" \u91CD\u7F6E\u5BC6\u7801 ")]),_:1},8,["loading"])):t.value==="selectEmail"?(l(),y($,{key:1,type:"primary",loading:k(b),onClick:h},{default:e(()=>[f(" \u786E\u8BA4 ")]),_:1},8,["loading"])):["resetSuccess","noEmail"].includes(t.value)?(l(),y($,{key:2,type:"primary",onClick:C},{default:e(()=>[f(" \u5B8C\u6210 ")]),_:1})):V("",!0)]),default:e(()=>[t.value==="inputAccount"?(l(),p("div",Ae,[o(g,{ref:"loginForm",model:a.value,layout:"vertical"},{default:e(()=>[o(n,{field:"account",rules:[{required:!0,message:_.$t("login.form.userName.errMsg")}],"validate-trigger":["change","blur"],"hide-label":""},{default:e(()=>[o(u,{modelValue:a.value.account,"onUpdate:modelValue":m[0]||(m[0]=d=>a.value.account=d),placeholder:_.$t("login.form.userName.placeholder")},{prefix:e(()=>[o(x)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"])]),_:1},8,["model"])])):t.value==="selectEmail"?(l(),p("div",Me,[f(" \u7531\u4E8E\u7528\u6237\u914D\u7F6E\u591A\u4E2A\u90AE\u7BB1\u5730\u5740\u8BF7\u9009\u62E9\u4E00\u4E2A\u90AE\u7BB1\u5730\u5740 "),o(g,{ref:"selectEmailForm",model:a.value,layout:"vertical"},{default:e(()=>[o(n,{field:"selectedMediaId",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u90AE\u7BB1\u5730\u5740"}],"validate-trigger":["change","blur"],"hide-label":""},{default:e(()=>[o(F,{modelValue:a.value.selectedMediaId,"onUpdate:modelValue":m[1]||(m[1]=d=>a.value.selectedMediaId=d),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u90AE\u7BB1\u5730\u5740"},{default:e(()=>[(l(!0),p(U,null,q(r.value.sysUserMedias,d=>(l(),y(S,{key:d.id,value:d.id},{default:e(()=>[f(v(d.hiddenAccount),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])):t.value==="resetSuccess"?(l(),p("div",xe," \u65B0\u7684\u5BC6\u7801\u5DF2\u53D1\u9001\u5230"+v(r.value.mailAddress)+"\u8BF7\u6CE8\u610F\u67E5\u6536 ",1)):V("",!0)]),_:1},8,["visible"])}}}),Ve={class:"login-form-wrapper"},Le={class:"login-form-title"},Ne={class:"login-form-error-msg"},Pe={style:{width:"100%",flex:"1","text-align":"right"}},Ue=M({__name:"login-form",setup(A){const s=be(),{t:a}=K(),r=E(""),{loading:B,setLoading:t}=W(),b=_e(),c=me(),h=E(!1),C=ye("login-config",{username:"",password:""}),_=ae({username:C.value.username,rawPassword:C.value.password}),m=async({errors:u,values:n})=>{if(!B.value&&!u){t(!0);try{const g={username:n.username,password:ie(n.rawPassword)};await b.login(g),await c.fetchServerPermissionMenu(b.userInfo.id),await c.fetchZabbixMonitorObjectTypeList();const{redirect:S,...F}=s.currentRoute.value.query;pe(s),await s.push({name:S||"Workplace",query:{...F}}),te.success(a("login.form.login.success"))}catch(g){r.value=g.message}finally{t(!1)}}},x=async()=>{const u=Fe.value.computedValue;if(u&&u.trim()){const{data:n}=await we({licenseContent:u.trim()});n.installed?(N.success({title:"\u66F4\u6539\u6388\u6743",content:"\u5DF2\u6210\u529F\u66F4\u65B0\u6388\u6743"}),window.location.reload()):N.error({title:"\u66F4\u6539\u6388\u6743",content:"\u66F4\u65B0\u5931\u8D25, \u6388\u6743\u7801\u5DF2\u8FC7\u671F!"})}};return(u,n)=>{const g=Z,S=O,F=R,$=ge,D=le,d=H,j=fe,z=ue,G=re,Q=T;return l(),p("div",Ve,[i("div",Le,v(u.$t("login.form.title")),1),i("div",Ne,v(r.value),1),o(Q,{ref:"loginForm",model:_,class:"login-form",layout:"vertical",onSubmit:m},{default:e(()=>[o(F,{field:"username",rules:[{required:!0,message:u.$t("login.form.userName.errMsg")}],"validate-trigger":["change","blur"],"hide-label":""},{default:e(()=>[o(S,{modelValue:_.username,"onUpdate:modelValue":n[0]||(n[0]=w=>_.username=w),placeholder:u.$t("login.form.userName.placeholder")},{prefix:e(()=>[o(g)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),o(F,{field:"rawPassword",rules:[{required:!0,message:u.$t("login.form.password.errMsg")}],"validate-trigger":["change","blur"],"hide-label":""},{default:e(()=>[o(D,{modelValue:_.rawPassword,"onUpdate:modelValue":n[1]||(n[1]=w=>_.rawPassword=w),placeholder:u.$t("login.form.password.placeholder"),"allow-clear":""},{prefix:e(()=>[o($)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),o(G,{size:16,direction:"vertical"},{default:e(()=>[o(d,{type:"primary","html-type":"submit",long:"",loading:k(B),onKeyup:ne(m,["enter"])},{default:e(()=>[f(v(u.$t("login.form.login")),1)]),_:1},8,["loading"]),i("div",Pe,[r.value&&r.value.indexOf("\u8BC1\u4E66\u5DF2\u8FC7\u671F")!==-1?(l(),y(d,{key:0,class:"license-btn",type:"text",onClick:n[2]||(n[2]=w=>k(he)(x))},{icon:e(()=>[o(j)]),default:e(()=>[f(" \u66F4\u6539\u6388\u6743 ")]),_:1})):V("",!0),o(z,{hoverable:!1,onClick:n[3]||(n[3]=w=>h.value=!0)},{default:e(()=>[f("\u5FD8\u8BB0\u5BC6\u7801")]),_:1})])]),_:1})]),_:1},8,["model"]),o(De,{visible:h.value,onClose:n[4]||(n[4]=w=>h.value=!1)},null,8,["visible"])])}}});const qe=L(Ue,[["__scopeId","data-v-3b1d4ca9"]]),Oe={class:"container"},Re={class:"logo"},Te=["src"],He={class:"logo-text"},Ke={class:"content"},We={class:"content-inner"},Ze={class:"footer"},je=M({__name:"index",setup(A){const s=E("\u7EDF\u4E00\u76D1\u63A7\u8FD0\u7EF4\u5E73\u53F0");return ve("\u7CFB\u7EDF\u914D\u7F6E","system_name").then(a=>{a&&(s.value=a.data.content)}),(a,r)=>(l(),p("div",Oe,[i("div",Re,[i("img",{alt:"logo",src:k(de)},null,8,Te),i("div",He,v(s.value),1)]),o(ke),i("div",Ke,[i("div",We,[o(qe)]),i("div",Ze,[o(ce)])])]))}});const to=L(je,[["__scopeId","data-v-308c5301"]]);export{to as default};
