import{a as ee,l as z,_ as Ee,T as Ie}from"./index.e9d54774.js";/* empty css              *//* empty css                *//* empty css               *//* empty css               */import{d as ie,f as p,o as me,ce as Te,D as l,E as F,aS as t,H as x,aW as V,aI as e,bN as Ke,aH as c,u as g,aY as v,aU as H,aV as te,aZ as N,bg as W,bX as Ve,aN as pe,c3 as Se,c4 as Oe,ca as $e,w as se,n as _e,bE as Le,bt as fe,cs as ze,cK as Pe,ct as Ue,bZ as Me,bi as ye,a$ as he,aO as ve,bo as ge,bp as be,bq as ke,bI as Re,bJ as je,r as re,aT as Ge,bz as qe,ch as He,a_ as We,b0 as Ye,aM as Ze,bB as Je,aP as Qe}from"./arco.a97fe066.js";import{_ as Xe}from"./index.vue_vue_type_script_setup_true_lang.d3e8b168.js";/* empty css                *//* empty css               */import{D as et}from"./vuedraggable.umd.d90dc502.js";import{_ as de,f as tt,s as at}from"./template-monitor-object-detail-tab.6cd41bfa.js";import{d as ot,h as lt,i as nt,x as ut}from"./monitor-object.647fdfa2.js";import{l as st}from"./app-instance.ab836c4c.js";/* empty css                *//* empty css                */import{p as it,_ as pt,a as rt,b as dt,c as ct,d as mt}from"./ap-list.vue_vue_type_script_setup_true_lang.3fbff1db.js";import{_ as _t,a as ft,b as yt}from"./index.vue_vue_type_script_setup_true_lang.f5ea2a4a.js";import{q as ht,s as vt,f as gt,d as bt}from"./template-config.6a02d42f.js";import{p as kt}from"./pagination.72a5f225.js";import{d as ce}from"./index.127a6572.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";/* empty css                *//* empty css                */import"./category.8586a983.js";/* empty css               *//* empty css                */import"./date-time.3a778351.js";import"./moment.a1678c09.js";import"./config-backup-device.df1a641e.js";import"./color.562bf6e9.js";/* empty css                */import"./unit-util.2cbd6bbc.js";import"./item-instance.4f13cfef.js";import"./index.vue_vue_type_script_setup_true_lang.8d2e7b7f.js";import"./performance-data.vue_vue_type_script_setup_true_lang.419c45ec.js";/* empty css                */import"./text-data-table.vue_vue_type_script_setup_true_lang.2f77f7d2.js";import"./chart-option.8bf8c179.js";import"./global.90f51a62.js";import"./index.vue_vue_type_script_setup_true_lang.bb709029.js";/* empty css                *//* empty css               *//* empty css               *//* empty css                */import"./alert-record.078e7032.js";import"./router.2bf8d2ce.js";import"./bus.4c102fb6.js";import"./alert-original.vue_vue_type_script_setup_true_lang.52196415.js";import"./notice-strategy-drawer.vue_vue_type_script_setup_true_lang.ef7ea06b.js";import"./dict.7add4266.js";import"./index.vue_vue_type_script_setup_true_lang.365d06f6.js";import"./app-model.480d8620.js";import"./index.vue_vue_type_script_setup_true_lang.5f4a4784.js";/* empty css               */import"./index.0f61770a.js";import"./port.4583bc07.js";import"./index.vue_vue_type_script_setup_true_lang.dff799f7.js";import"./assetMonitorObjectRelation.e72f2147.js";import"./model.9705abc9.js";import"./assets.d172e35e.js";import"./logo.d5f33f3a.js";import"./download.430d1db4.js";import"./validate.dea67cb4.js";import"./v4.cf9713fe.js";import"./monitor-object-table.vue_vue_type_script_setup_true_lang.322c60e6.js";import"./host-group.ed397ed1.js";/* empty css                */import"./index.d4fbf381.js";const Ct={class:"page-container"},Ft={key:0,class:"page-panel",style:{height:"calc(100vh - 160px)"}},At={key:1,class:"page-panel",style:{"align-items":"center","justify-content":"center",height:"calc(100vh - 84px)",display:"flex"}},Dt=ie({__name:"preview",props:{appKey:{default:""},hostId:{default:""},templateConfig:{default:()=>[]}},setup(S){const o=S,O=p(),b=p({checkId:"",appKey:"",appName:"",available:!1,enable:!1,category:"",displayName:"",hostGroupDtos:[],hostId:"",hostName:"",hostPriority:"",ip:"",subtype:"",templateName:"",tagDtos:[]}),E=p("\u76D1\u63A7\u6982\u89C8"),_=p(!1),A=async()=>{b.value=(await lt(o.appKey,o.hostId)).data,O.value=[],o.templateConfig.forEach(u=>{var D;u.enable&&((D=O.value)==null||D.push({id:"",tabName:u.name,templateName:"",type:u.code,createTime:"",createUser:"",updateUser:"",updateTime:""}))})},{loading:k,setLoading:y}=ee(),U=async()=>{y(!0);try{await nt(o.appKey,o.hostId),W.success("\u6267\u884C\u6210\u529F,\u8BF7\u7A0D\u5019\u5237\u65B0\u9875\u9762\u67E5\u770B\u6700\u65B0\u6570\u636E...")}catch{W.error("\u6267\u884C\u5931\u8D25")}finally{y(!1)}};return me(async()=>{_.value=(await ot(o.appKey,o.hostId)).data,_.value&&await A()}),(u,D)=>{const I=Ve,M=pe,T=Se,$=Oe,C=$e,G=Te("read-only");return l(),F("div",Ct,[_.value?(l(),F("div",Ft,[t(I,{direction:"vertical"}),x("span",null,V(b.value.displayName+"\uFF5C"+b.value.ip),1),t($,{"active-key":E.value,"onUpdate:activeKey":D[0]||(D[0]=i=>E.value=i)},{extra:e(()=>[Ke((l(),c(M,{loading:g(k),disabled:!b.value.enable,onClick:U},{default:e(()=>[v(" \u76D1\u63A7\u6570\u636E\u540C\u6B65 ")]),_:1},8,["loading","disabled"])),[[G]])]),default:e(()=>[(l(!0),F(H,null,te(O.value,i=>(l(),c(T,{key:i.tabName,title:i.tabName},{default:e(()=>[i.type==="OVERVIEW"?(l(),F("div",{key:i.tabName},[t(_t,{"app-key":o.appKey,"host-id":o.hostId},null,8,["app-key","host-id"]),b.value.category==="network_device"?(l(),c(it,{key:0,"app-key":o.appKey,"host-id":o.hostId,style:{"margin-top":"8px"}},null,8,["app-key","host-id"])):(l(),c(de,{key:1,style:{"margin-top":"8px"},"app-key":o.appKey,"host-id":o.hostId,"tab-name":"\u76D1\u63A7\u6982\u89C8"},null,8,["app-key","host-id"]))])):N("",!0),i.type==="GRAFANA"?(l(),c(de,{key:1,"app-key":o.appKey,"host-id":o.hostId,"tab-name":i.tabName,height:"calc(100vh - 305px)"},null,8,["app-key","host-id","tab-name","height"])):N("",!0),i.type==="LOKI_LOG"?(l(),c(pt,{key:2,"app-key":o.appKey,"host-id":o.hostId,"tab-name":i.tabName,height:"calc(100vh - 302px)"},null,8,["app-key","host-id","tab-name","height"])):N("",!0),i.type==="ALERT"?(l(),c(ft,{key:3,"app-key":o.appKey,"host-id":o.hostId,height:"calc(100vh - 302px)"},null,8,["app-key","host-id","height"])):N("",!0),i.type==="QUOTA"?(l(),c(rt,{key:4,"app-key":o.appKey,"host-id":o.hostId,height:"calc(100vh - 348px)"},null,8,["app-key","host-id","height"])):N("",!0),i.type==="PORT"&&E.value==="\u7AEF\u53E3\u5217\u8868"?(l(),c(dt,{key:5,"app-key":o.appKey,"host-id":o.hostId,height:"calc(100vh - 294px)"},null,8,["app-key","host-id","height"])):N("",!0),i.type==="TOPOLOGY"?(l(),c(yt,{key:6,"app-key":o.appKey,"host-id":o.hostId,height:"calc(100vh - 286px)","topology-body-height":"calc(100vh - 332px)","left-scroll-height":"calc(100vh - 316px)"},null,8,["app-key","host-id","height","topology-body-height","left-scroll-height"])):N("",!0),i.type==="ASSET"?(l(),c(ct,{key:7,"app-key":o.appKey,"host-id":o.hostId},null,8,["app-key","host-id"])):N("",!0),i.type==="AP"?(l(),c(mt,{key:8,"app-key":o.appKey,"host-id":o.hostId},null,8,["app-key","host-id"])):N("",!0)]),_:2},1032,["title"]))),128))]),_:1},8,["active-key"])])):(l(),F("div",At,[t(C,{description:"\u6682\u65E0\u6743\u9650"})]))])}}}),Ce=S=>(Re("data-v-1df0671c"),S=S(),je(),S),wt=Ce(()=>x("span",null,"\u9884\u89C8",-1)),Bt={key:1},Nt={style:{"margin-bottom":"5px"}},xt={class:"field-draggable"},Et=Ce(()=>x("span",null,"\u22EE\u22EE",-1)),It=ie({__name:"index",props:{visible:{type:Boolean,default:!1},templateName:{default:""}},emits:["ok","cancel"],setup(S,{emit:o}){const{loading:O}=ee(!1),b=p(!1),E=o,_=S,A=p(!1),k=p(!1),y=p([]),U=()=>{z.every(y.value,"enable")?(A.value=!0,k.value=!1):z.every(y.value,["enable",!1])?(A.value=!1,k.value=!1):(A.value=!1,k.value=!0)},u=p({appKey:"",hostName:""}),D=async()=>{try{b.value=!0;const{data:s}=await tt({templateName:_.templateName});y.value=s}catch(s){console.log(s)}finally{b.value=!1}},I=p([]),M=async()=>{const{data:s}=await st();I.value=s.filter(r=>r.enable&&z.isEmpty(r.deleteTime)),I.value.length>0&&(u.value.appKey=I.value[0].id)},T=p([]),$=async(s,r)=>{u.value.hostName="";const{data:L}=await ut({appKey:s,templateName:r});T.value=L,T.value.length>0&&(u.value.hostName=T.value[0].hostId)};se(()=>u.value.appKey,s=>{s&&_.templateName&&$(s,_.templateName)}),se(()=>_.templateName,s=>{u.value.appKey&&s&&$(u.value.appKey,s)});const C=()=>{M(),D(),U()};se(()=>y,()=>{U()},{deep:!0,immediate:!0});const G=async()=>{E("ok",y.value)},i=()=>{E("cancel")},q=p(!1),Y=s=>{k.value=!1,s?(A.value=!0,y.value.forEach(r=>{r.enable=!0})):(A.value=!1,y.value.forEach(r=>{r.enable=!1}))},w=p(!1),R=()=>{w.value=!0},h=s=>{w.value=!1,u.value.hostName=s,_e(()=>{w.value=!0})},B=()=>{q.value=!0};return(s,r)=>{const L=pe,ae=Le,Z=fe,j=ze,oe=Pe,le=Ue,J=Me,a=ye,n=he,f=ve,P=ge,Q=be,ne=ke;return l(),F(H,null,[t(a,{visible:s.visible,width:"15vw","title-align":"start","ok-loading":g(O),"mask-closable":!1,"unmount-on-close":!0,onCancel:i,onBeforeOpen:C},{title:e(()=>[v("\u9875\u9762\u5206\u914D")]),footer:e(()=>[t(Z,null,{default:e(()=>[t(L,{type:"primary",onClick:G},{default:e(()=>[v("\u786E\u8BA4")]),_:1}),T.value.length===0?(l(),c(ae,{key:0,content:"\u8BE5\u6A21\u677F\u6682\u65E0\u5339\u914D\u7684\u76D1\u63A7\u5BF9\u8C61"},{default:e(()=>[t(L,{type:"primary",status:"success",disabled:"",onClick:B},{default:e(()=>[wt]),_:1})]),_:1})):(l(),c(L,{key:1,type:"primary",status:"success",onClick:B},{default:e(()=>[v(" \u9884\u89C8 ")]),_:1})),t(L,{onClick:i},{default:e(()=>[v("\u53D6\u6D88")]),_:1})]),_:1})]),default:e(()=>[b.value?(l(),c(le,{key:0,animation:!0},{default:e(()=>[t(Z,{direction:"vertical",style:{width:"100%"},size:"large"},{default:e(()=>[t(j,{rows:3}),t(oe)]),_:1})]),_:1})):(l(),F("div",Bt,[x("div",Nt,"\u6A21\u677F\u540D\u79F0:"+V(s.templateName),1),t(J,{"model-value":A.value,indeterminate:k.value,onChange:Y},{default:e(()=>[v(" \u5168\u9009 ")]),_:1},8,["model-value","indeterminate"]),t(g(et),{modelValue:y.value,"onUpdate:modelValue":r[0]||(r[0]=d=>y.value=d),"item-key":"title"},{item:e(({element:d})=>[x("div",xt,[Et,t(J,{modelValue:d.enable,"onUpdate:modelValue":K=>d.enable=K},{default:e(()=>[v(V(d.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:1},8,["modelValue"])]))]),_:1},8,["visible","ok-loading"]),t(ne,{visible:q.value,"onUpdate:visible":r[3]||(r[3]=d=>q.value=d),fullscreen:"","unmount-on-close":!0,footer:!1,onBeforeOpen:R},{title:e(()=>[]),default:e(()=>[x("div",null,[t(Q,{model:u.value,layout:"inline"},{default:e(()=>[t(P,{field:"appKey",label:"\u5E94\u7528"},{default:e(()=>[t(f,{modelValue:u.value.appKey,"onUpdate:modelValue":r[1]||(r[1]=d=>u.value.appKey=d),style:{width:"320px"},"allow-clear":"",disabled:I.value.length<=1},{default:e(()=>[(l(!0),F(H,null,te(I.value,(d,K)=>(l(),c(n,{key:K,value:d.id},{default:e(()=>[v(V(d.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(P,{field:"hostName",label:"\u4E3B\u673A\u540D"},{default:e(()=>[t(f,{modelValue:u.value.hostName,"onUpdate:modelValue":r[2]||(r[2]=d=>u.value.hostName=d),style:{width:"320px"},"allow-search":"","allow-clear":"",onChange:h},{default:e(()=>[(l(!0),F(H,null,te(T.value,(d,K)=>(l(),c(n,{key:K,value:d.hostId},{default:e(()=>[v(V(d.displayName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),w.value?(l(),c(Dt,{key:0,"app-key":u.value.appKey,"host-id":u.value.hostName,"template-config":y.value},null,8,["app-key","host-id","template-config"])):N("",!0)])]),_:1},8,["visible"])],64)}}});const Tt=Ee(It,[["__scopeId","data-v-1df0671c"]]),Kt={class:"page-container"},Vt={class:"page-panel"},St={style:{height:"calc(100vh - 146px)"}},Ja=ie({__name:"index",setup(S){const{loading:o,setLoading:O}=ee(!1),{loading:b,setLoading:E}=ee(!1),{pagination:_,pageSizeOptions:A}=kt(),k=p(),y=p(),U=p({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{isHover:!0,keyField:"id"},showOverflow:"tooltip",columns:[{title:"\u6A21\u677F\u540D\u79F0",field:"templateName",minWidth:120},{title:"\u5B50\u7C7B\u578B",slots:{default:"subtypeName"},minWidth:120},{title:"\u76D1\u63A7\u7C7B\u578B",field:"monitorType",minWidth:120},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",width:200},{title:"\u64CD\u4F5C",width:200,fixed:"right",slots:{default:"action"}}]}),u=p([]);let D=[];const I=()=>{const a=k.value;D.forEach(n=>{const f=n.id,P=u.value.indexOf(f)!==-1;a.getRowById(f)&&a.setCheckboxRow(a.getRowById(f),P)})},M=p([]),T=async()=>{const{data:a}=await Ie("\u6A21\u7248\u76D1\u63A7\u7C7B\u578B");M.value=a},$=re({keywords:""}),C=async(a={...$,page:_})=>{O(!0);const n=k.value;try{const{data:f}=await ht(a);D=f.content,_.total=f.totalElements,n&&await n.reloadData(f.content)}catch(f){console.error(f)}finally{O(!1),I()}},G=a=>{_.current=a,C()},i=a=>{_.pageSize=a,C()},q=()=>{C()},Y=ce(async()=>{await C()},500),w=p(!1),R=p(),h=re({id:"",templateName:"",categoryCode:"",subtypeCode:"",monitorType:"SNMP",icon:"",enable:!0});let B;const s=()=>{h.id="",B="",w.value=!0,_e(()=>{R.value.resetFields()})},r=async()=>{try{if(E(!0),await R.value.validate())console.warn("\u9A8C\u8BC1\u4E0D\u901A\u8FC7");else{const n=z.assign(h,{oldTemplateName:B});await vt(n),W.success(h.id?"\u6A21\u677F\u66F4\u65B0\u6210\u529F":"\u6A21\u677F\u4FDD\u5B58\u6210\u529F"),w.value=!1,await C()}}catch(a){console.log(a)}finally{E(!1)}},L=a=>{w.value=!0,B=z.cloneDeep(a.templateName),z.assign(h,z.cloneDeep(a)),R.value.validate()};me(()=>{T(),C()});const ae=ce(async(a,n)=>{if(a!==B){const{data:f}=await gt(a);f&&n("\u6A21\u7248\u540D\u79F0\u5DF2\u5B58\u5728")}},500),Z=async a=>{ke.warning({title:"\u63D0\u793A",simple:!1,draggable:!0,closable:!1,titleAlign:"start",hideCancel:!1,content:`\u5F53\u524D\u6A21\u677F${a.templateName}\u5220\u9664\u540E\uFF0C\u5173\u8054\u8BE5\u6A21\u677F\u7684\u76D1\u63A7\u5BF9\u8C61\u5C06\u65E0\u6CD5\u5C55\u793A\u76D1\u63A7\u4FE1\u606F\uFF0C\u662F\u5426\u786E\u8BA4\uFF1F`,onOk:async()=>{await bt(a.id),W.success("\u5220\u9664\u6210\u529F"),await C(),u.value=u.value.filter(n=>n!==a.id)}})},j=p(!1),oe=async a=>{B=z.cloneDeep(a.templateName),j.value=!0},le=async a=>{await at({templateName:B,sysConfigList:a}),W.success("\u8BE6\u60C5\u5206\u914D\u6210\u529F"),j.value=!1},J=a=>{h.categoryCode=a};return(a,n)=>{const f=He,P=fe,Q=We,ne=pe,d=Ye,K=Ze,Fe=Je,Ae=Ge("vxe-grid"),De=Qe,ue=ge,we=he,Be=ve,Ne=be,xe=ye;return l(),F("div",Kt,[x("div",Vt,[t(d,null,{default:e(()=>[t(Q,{span:14},{default:e(()=>[t(P,{style:{"margin-bottom":"5px"}},{default:e(()=>[t(f,{modelValue:$.keywords,"onUpdate:modelValue":n[0]||(n[0]=m=>$.keywords=m),style:{width:"320px"},placeholder:"\u6A21\u677F\u540D\u79F0","allow-clear":"",onSearch:q,onInput:g(Y),onClear:g(Y)},null,8,["modelValue","onInput","onClear"])]),_:1})]),_:1}),t(Q,{span:10,style:{"text-align":"right"}},{default:e(()=>[t(ne,{type:"primary",size:"medium",onClick:s},{default:e(()=>[v(V(a.$t("button.create")),1)]),_:1})]),_:1})]),_:1}),x("div",St,[t(Ae,qe({ref_key:"xGrid",ref:k,loading:g(o)},U.value),{subtypeName:e(({row:m})=>[x("span",null,V(m.subtypeName||"--"),1)]),action:e(({row:m})=>[t(P,null,{default:e(()=>[t(K,{onClick:X=>L(m)},{default:e(()=>[v("\u7F16\u8F91")]),_:2},1032,["onClick"]),t(K,{type:"text",onClick:X=>oe(m)},{default:e(()=>[v(" \u9875\u9762\u5206\u914D ")]),_:2},1032,["onClick"]),t(K,{type:"text",onClick:X=>Z(m)},{default:e(()=>[v("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:e(()=>[t(Fe,{ref_key:"xPagination",ref:y,current:g(_).current,"page-size":g(_).pageSize,total:g(_).total,"page-size-options":g(A),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:G,onPageSizeChange:i},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),t(xe,{visible:w.value,width:"auto","title-align":"start","ok-loading":g(b),"mask-closable":!1,onOk:r,onCancel:n[4]||(n[4]=m=>w.value=!1)},{title:e(()=>[v(V(h.id?"\u7F16\u8F91\u6A21\u677F":"\u65B0\u5EFA\u6A21\u677F"),1)]),default:e(()=>[x("div",null,[t(Ne,{ref_key:"submitFormRef",ref:R,autocomplete:"off",model:h,style:{width:"600px"}},{default:e(()=>[t(ue,{field:"templateName",label:"\u6A21\u677F\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6A21\u677F\u540D\u79F0"},{maxLength:64,message:"\u6A21\u677F\u540D\u79F0\u957F\u5EA6\u6700\u5927\u4E0D\u80FD\u8D85\u8FC764"},{validator:g(ae)}],"validate-trigger":"blur"},{default:e(()=>[t(De,{modelValue:h.templateName,"onUpdate:modelValue":n[1]||(n[1]=m=>h.templateName=m),"max-length":255,autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["rules"]),t(ue,{field:"subtypeCode",label:"\u7C7B\u578B"},{default:e(()=>[t(Xe,{modelValue:h.subtypeCode,"onUpdate:modelValue":n[2]||(n[2]=m=>h.subtypeCode=m),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B",onGetCategoryCode:J},null,8,["modelValue"])]),_:1}),t(ue,{field:"monitorType","validate-trigger":"blur",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u76D1\u63A7\u7C7B\u578B"}],label:"\u76D1\u63A7\u7C7B\u578B"},{default:e(()=>[t(Be,{modelValue:h.monitorType,"onUpdate:modelValue":n[3]||(n[3]=m=>h.monitorType=m),placeholder:"\u8BF7\u9009\u62E9\u76D1\u63A7\u7C7B\u578B"},{default:e(()=>[(l(!0),F(H,null,te(M.value,(m,X)=>(l(),c(we,{key:X,value:m.code},{default:e(()=>[v(V(m.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["visible","ok-loading"]),t(Tt,{"template-name":g(B),visible:j.value,onCancel:n[5]||(n[5]=m=>j.value=!1),onOk:le},null,8,["template-name","visible"])])}}});export{Ja as default};
