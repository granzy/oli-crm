import{l as M,a as w}from"./index.e9d54774.js";/* empty css               *//* empty css              *//* empty css                *//* empty css                */import{d as D,f as y,c as N,r as R,D as u,aH as r,aI as a,aY as m,aS as n,E as U,aU as L,aV as O,aZ as T,u as x,bg as H,c7 as S,c8 as j,bo as q,c3 as Z,c4 as $,bp as X,bq as Y}from"./arco.a97fe066.js";import{_ as v}from"./index.vue_vue_type_script_setup_true_lang.6079a524.js";import{f as z}from"./app-instance.ab836c4c.js";import{b as J}from"./host-group.ed397ed1.js";const ue=D({__name:"batch-assign-host-group",props:{visible:{type:Boolean,default:!1},records:{},checkKeys:{}},emits:["ok","cancel"],setup(b,{emit:k}){const p=b,o=y([]),h=N(()=>M.uniq(p.records.map(l=>l.appKey))),g=l=>p.records.filter(s=>s.appKey===l).length,f=k,I=()=>{f("cancel")},d=y("APPEND"),t=R({hostGroupId:{}}),V=async()=>{t.hostGroupId={},d.value="APPEND";const{data:l}=await z("ZABBIX");o.value=l.filter(s=>h.value.includes(s.id))},{loading:C,setLoading:i}=w(!1),G=async()=>{i(!0);try{await J({monitorObjectCheckIds:p.checkKeys,appendModel:d.value,appKeyHostGroupIdMap:t.hostGroupId}),H.success("\u5206\u7EC4\u6210\u529F"),f("ok")}catch(l){console.error(l)}finally{i(!1)}i(!1)};return(l,s)=>{const _=S,E=j,c=q,F=Z,A=$,B=X,P=Y;return u(),r(P,{width:500,visible:l.visible,"mask-closable":!1,"title-align":"start","ok-loading":x(C),onOk:G,onCancel:I,onBeforeOpen:V},{title:a(()=>[m("\u6279\u91CF\u5206\u7EC4")]),default:a(()=>[n(B,{model:t},{default:a(()=>[n(c,{field:"name",label:"\u6A21\u5F0F"},{default:a(()=>[n(E,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=e=>d.value=e),type:"button"},{default:a(()=>[n(_,{value:"APPEND"},{default:a(()=>[m("\u8FFD\u52A0")]),_:1}),n(_,{value:"REPLACE"},{default:a(()=>[m("\u66FF\u6362")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.value.length>1?(u(),r(A,{key:0,"default-active-key":o.value[0].id},{default:a(()=>[(u(!0),U(L,null,O(o.value,e=>(u(),r(F,{key:e.id,title:e.name+`(${g(e.id)})`},{default:a(()=>[n(c,{field:t.hostGroupId[e.id],label:"\u5206\u7EC4"},{default:a(()=>[n(v,{modelValue:t.hostGroupId[e.id],"onUpdate:modelValue":K=>t.hostGroupId[e.id]=K,"app-keys":[e.id]},null,8,["modelValue","onUpdate:modelValue","app-keys"])]),_:2},1032,["field"])]),_:2},1032,["title"]))),128))]),_:1},8,["default-active-key"])):o.value.length===1?(u(),r(c,{key:1,field:t.hostGroupId[o.value[0].id],label:"\u5206\u7EC4"},{default:a(()=>[n(v,{modelValue:t.hostGroupId[o.value[0].id],"onUpdate:modelValue":s[1]||(s[1]=e=>t.hostGroupId[o.value[0].id]=e),"app-keys":[o.value[0].id]},null,8,["modelValue","app-keys"])]),_:1},8,["field"])):T("",!0)]),_:1},8,["model"])]),_:1},8,["visible","ok-loading"])}}});export{ue as _};
