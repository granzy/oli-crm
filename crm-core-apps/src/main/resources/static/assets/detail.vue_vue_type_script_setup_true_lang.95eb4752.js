import{h as g,l as h,a as L,a8 as se,_ as re,$ as te}from"./index.e9d54774.js";/* empty css                */import{d as q,f as F,c as Y,o as Z,D as i,aH as m,aI as t,aS as e,E as I,aV as U,aU as E,aY as r,u as j,bg as R,c2 as ce,aQ as W,bX as ie,aN as X,bt as G,bp as de,ca as pe,bK as _e,cB as me,aW as ee,H as T,bI as fe,bJ as ye,c1 as ve,aP as ae,bo as he,a_ as J,b0 as Q,bv as ge,bs as be,a$ as xe,aO as Ce,c3 as we,c4 as Fe}from"./arco.a97fe066.js";/* empty css              *//* empty css               *//* empty css                *//* empty css                *//* empty css               */function Ge(o,l=!1){return g.post("/zabbixMonitorObject/list",{typeName:o,useGlobalAccount:l})}function Ve(o,l,a){return g.get(`/zabbixMonitorObject/getOne/${o}/${l}/${a}`)}function De(o){return g.post("/zabbixMonitorObject/updateInventory",o)}function ke(o,l){return g.get(`/zabbixMonitorObject/getTags/${o}/${l}`)}function Ie(o,l,a){return g.post(`/zabbixMonitorObject/updateTags/${o}/${l}`,a)}function Be(o,l){return g.get(`/zabbixMonitorObject/getMacros/${o}/${l}`)}function $e(o,l,a){return g.post(`/zabbixMonitorObject/updateMacros/${o}/${l}`,a)}function Je(o){return g.post("/zabbixMonitorObject/export",o,{responseType:"blob",timeout:36e5})}function Qe(o,l){const a=new FormData;return a.append("file",o),g.post(`/zabbixMonitorObject/import/${l}`,a)}const Ye=(o,l)=>l.length>0?h.filter(o,a=>h.every(l,s=>{var _;return s.field&&s.condition?s.condition==="eq"&&s.value?a[s.field].toLowerCase()===((_=s.value)==null?void 0:_.toLowerCase()):s.condition==="contains"&&s.values?s.values.some(b=>a[s.field].toLowerCase().includes(b.toLowerCase())):!0:!0})):o,ze=o=>(fe("data-v-a2e0cb5e"),o=o(),ye(),o),Ee=ze(()=>T("div",{class:"arco-descriptions-title"},"\u8D44\u4EA7\u4FE1\u606F",-1)),Me={class:"form-attr-group-name"},Ne=q({__name:"inventory-tab",props:{typeName:{type:String,required:!0},appKey:{type:String,required:!0},hostId:{type:String,required:!0}},setup(o){const l=o,a=F({}),s=F({}),_=F({}),b=F(),V=Y(()=>{var u;return h.groupBy((u=b.value)==null?void 0:u.fields,"fieldGroup")}),{loading:D,setLoading:B}=L(!1),{loading:k,setLoading:$}=L(!1),p=Y(()=>[{label:"\u4E3B\u673A\u540D",value:a.value.host},{label:"\u540D\u79F0",value:a.value.name},{label:"\u6A21\u677F",value:a.value.templateNames},{label:"\u4E3B\u673A\u7EC4",value:a.value.groupNames},{label:"\u63A5\u53E3",value:a.value.interfaceNames},{label:"\u4EE3\u7406",value:a.value.proxyName},{label:"\u72B6\u6001",value:a.value.statusName},{label:"\u63CF\u8FF0",value:a.value.description}]),M=()=>{B(!0),Promise.all([Ve(l.typeName,l.appKey,l.hostId),se(l.typeName)]).then(u=>{a.value=u[0].data,s.value=h.cloneDeep(u[0].data),b.value=u[1].data,B(!1)})},n=async()=>{try{$(!0),await De(a.value),R.success("\u4FDD\u5B58\u6210\u529F"),M()}catch(u){console.error(u)}finally{$(!1)}};Z(()=>{M()});const x=()=>{a.value=h.cloneDeep(s.value)};return(u,f)=>{const y=ve,N=ce,C=W,w=ie,z=ae,v=he,K=J,H=Q,c=X,O=G,d=de,oe=pe,ne=_e;return i(),m(ne,{loading:j(D)},{default:t(()=>[e(O,{direction:"vertical"},{default:t(()=>[e(C,null,{default:t(()=>[e(N,{title:"\u76D1\u63A7\u4FE1\u606F",align:{label:"left"},layout:"horizontal","label-style":{width:"120px"},"value-style":{overflow:"hidden",minWidth:"200px",textOverflow:"ellipsis",whiteSpace:"nowrap"},"table-layout":"fixed",bordered:"",column:4},{default:t(()=>[(i(!0),I(E,null,U(p.value,(S,P)=>(i(),m(y,{key:P,label:S.label},{default:t(()=>[e(j(me),null,{default:t(()=>[r(ee(S.value),1)]),_:2},1024)]),_:2},1032,["label"]))),128))]),_:1})]),_:1}),e(C,null,{default:t(()=>[Ee,e(w),a.value.zbxHostInventory?(i(),m(d,{key:0,ref:"form",model:_.value,style:{width:"100%"},"auto-label-width":""},{default:t(()=>[(i(!0),I(E,null,U(Object.keys(V.value),(S,P)=>(i(),I(E,{key:P},[T("div",Me,ee(S),1),e(H,{gutter:10},{default:t(()=>[(i(!0),I(E,null,U(V.value[S],(A,le)=>(i(),m(K,{key:le,xxl:6,xl:6,lg:12,md:12,sm:24,xs:24},{default:t(()=>[e(v,{label:A.fieldName,field:A.fieldName},{default:t(()=>[e(z,{modelValue:a.value.zbxHostInventory[A.inventoryField],"onUpdate:modelValue":ue=>a.value.zbxHostInventory[A.inventoryField]=ue},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","field"])]),_:2},1024))),128))]),_:2},1024)],64))),128)),e(O,{style:{"justify-content":"right"}},{default:t(()=>[e(c,{onClick:x},{default:t(()=>[r("\u91CD\u7F6E")]),_:1}),e(c,{type:"primary",loading:j(k),onClick:n},{default:t(()=>[r(" \u4FDD\u5B58 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])):(i(),m(oe,{key:1}))]),_:1})]),_:1})]),_:1},8,["loading"])}}});const Oe=re(Ne,[["__scopeId","data-v-a2e0cb5e"]]),Se={style:{width:"1000px"}},Ue=q({__name:"tags-tab",props:{typeName:{type:String,required:!0},appKey:{type:String,required:!0},hostId:{type:String,required:!0}},setup(o){const l=o,a=F([]),s=F([]),_=()=>{a.value.push({tag:"",value:""})},b=p=>{a.value.splice(p,1)},V=()=>{a.value=h.cloneDeep(s.value)},D=()=>{ke(l.appKey,l.hostId).then(p=>{p.data.length===0?(a.value.length===0&&_(),s.value=[]):(s.value=h.cloneDeep(p.data),a.value=p.data)})},{loading:B,setLoading:k}=L(!1),$=async()=>{try{k(!0),await Ie(l.appKey,l.hostId,h.filter(a.value,p=>!!p.tag)),D(),R.success("\u4FDD\u5B58\u6210\u529F")}catch(p){console.error(p)}finally{k(!1)}};return Z(()=>{D()}),(p,M)=>{const n=J,x=Q,u=ge,f=te,y=X,N=G,C=W;return i(),m(C,null,{default:t(()=>[T("div",Se,[e(x,{gutter:[4,4]},{default:t(()=>[e(n,{span:10},{default:t(()=>[r("\u540D\u79F0")]),_:1}),e(n,{span:10},{default:t(()=>[r("\u503C")]),_:1}),e(n,{span:4},{default:t(()=>[r("\u64CD\u4F5C")]),_:1})]),_:1}),(i(!0),I(E,null,U(a.value,(w,z)=>(i(),m(x,{key:z,gutter:[4,4]},{default:t(()=>[e(n,{span:10},{default:t(()=>[e(u,{modelValue:w.tag,"onUpdate:modelValue":v=>w.tag=v,placeholder:"\u6807\u7B7E","max-length":255,"allow-clear":"","auto-size":"","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{span:10},{default:t(()=>[e(u,{modelValue:w.value,"onUpdate:modelValue":v=>w.value=v,placeholder:"\u503C","max-length":255,"allow-clear":"","auto-size":"","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{span:4},{default:t(()=>[e(f,{style:{"margin-top":"5px",color:"var(--color-danger-light-4)",cursor:"pointer"},size:"25",onClick:v=>b(z)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(x,{gutter:[4,4]},{default:t(()=>[e(n,{span:20},{default:t(()=>[e(y,{style:{width:"100%"},type:"dashed",onClick:_},{default:t(()=>[r(" \u6DFB\u52A0 ")]),_:1})]),_:1})]),_:1})]),e(N,{style:{width:"100%","justify-content":"right"}},{default:t(()=>[e(y,{onClick:V},{default:t(()=>[r("\u91CD\u7F6E")]),_:1}),e(y,{type:"primary",onClick:$,onLoad:j(B)},{default:t(()=>[r("\u4FDD\u5B58")]),_:1},8,["onLoad"])]),_:1})]),_:1})}}}),je={style:{width:"1500px"}},Te=q({__name:"macros-tab",props:{typeName:{type:String,required:!0},appKey:{type:String,required:!0},hostId:{type:String,required:!0}},setup(o){const l=o,a=F([]),s=F([]),_=()=>{a.value.push({macro:"",macroVal:"",context:"",value:"",type:"0",description:""})},b=n=>{a.value.splice(n,1)},V=n=>{const x=/\{\$(.*?)(?::(.*?))?}/;return n.map(u=>{const f=u.macro.match(x);return f?{...u,macroVal:f[1],context:f[2]||""}:u})},D=n=>{n.context?n.macro=`{$${n.macroVal}:${n.context}}`:n.macro=`{$${n.macroVal}}`},B=()=>{a.value=V(s.value)},k=()=>{Be(l.appKey,l.hostId).then(n=>{n.data.length===0?(a.value.length===0&&_(),s.value=[]):(s.value=h.cloneDeep(n.data),a.value=V(n.data))})},{loading:$,setLoading:p}=L(!1),M=async()=>{try{p(!0),await $e(l.appKey,l.hostId,h.filter(a.value.map(n=>({hostmacroid:n.hostmacroid,macro:n.macro,value:n.type==="1"&&!n.value?void 0:n.value,type:n.type,description:n.description})),n=>!!n.macro)),k(),R.success("\u4FDD\u5B58\u6210\u529F")}catch(n){console.error(n)}finally{p(!1)}};return Z(()=>{k()}),(n,x)=>{const u=J,f=Q,y=ae,N=be,C=xe,w=Ce,z=te,v=X,K=G,H=W;return i(),m(H,null,{default:t(()=>[T("div",je,[e(f,{gutter:[4,4]},{default:t(()=>[e(u,{span:5},{default:t(()=>[r("\u5B8F\u540D\u79F0")]),_:1}),e(u,{span:5},{default:t(()=>[r("\u4E0A\u4E0B\u6587")]),_:1}),e(u,{span:4},{default:t(()=>[r("\u503C")]),_:1}),e(u,{span:2},{default:t(()=>[r("\u7C7B\u578B")]),_:1}),e(u,{span:4},{default:t(()=>[r("\u63CF\u8FF0")]),_:1}),e(u,{span:4},{default:t(()=>[r("\u64CD\u4F5C")]),_:1})]),_:1}),(i(!0),I(E,null,U(a.value,(c,O)=>(i(),m(f,{key:O,gutter:[4,4]},{default:t(()=>[e(u,{span:5},{default:t(()=>[e(y,{modelValue:c.macroVal,"onUpdate:modelValue":d=>c.macroVal=d,placeholder:"MACRO","max-length":100,"allow-clear":"","auto-size":"","show-word-limit":"",onInput:d=>D(c)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),e(u,{span:5},{default:t(()=>[e(y,{modelValue:c.context,"onUpdate:modelValue":d=>c.context=d,placeholder:"CONTEXT","max-length":100,"allow-clear":"","auto-size":"","show-word-limit":"",onInput:d=>D(c)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),e(u,{span:4},{default:t(()=>[c.type==="1"?(i(),m(N,{key:0,modelValue:c.value,"onUpdate:modelValue":d=>c.value=d,placeholder:c.value==null?"\u503C\u5DF2\u88AB\u9690\u85CF\uFF0C\u8BF7\u8F93\u5165\u65B0\u503C\u8986\u76D6\u65E7\u503C":"\u503C","max-length":255,"allow-clear":"","auto-size":"","invisible-button":!1,"show-word-limit":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])):(i(),m(y,{key:1,modelValue:c.value,"onUpdate:modelValue":d=>c.value=d,placeholder:"\u503C","max-length":255,"allow-clear":"","auto-size":"","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024),e(u,{span:2},{default:t(()=>[e(w,{modelValue:c.type,"onUpdate:modelValue":d=>c.type=d},{default:t(()=>[e(C,{value:"0"},{default:t(()=>[r("\u6587\u672C")]),_:1}),e(C,{value:"1"},{default:t(()=>[r("\u5BC6\u6587")]),_:1}),e(C,{value:"2"},{default:t(()=>[r("Vault\u5BC6\u94A5")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:4},{default:t(()=>[e(y,{modelValue:c.description,"onUpdate:modelValue":d=>c.description=d,placeholder:"\u63CF\u8FF0","max-length":255,"allow-clear":"","auto-size":"","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:4},{default:t(()=>[e(z,{style:{"margin-top":"5px",color:"var(--color-danger-light-4)",cursor:"pointer"},size:"25",onClick:d=>b(O)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e(f,{gutter:[4,4]},{default:t(()=>[e(u,{span:20},{default:t(()=>[e(v,{style:{width:"100%"},type:"dashed",onClick:_},{default:t(()=>[r(" \u6DFB\u52A0 ")]),_:1})]),_:1})]),_:1})]),e(K,{style:{width:"100%","justify-content":"right"}},{default:t(()=>[e(v,{onClick:B},{default:t(()=>[r("\u91CD\u7F6E")]),_:1}),e(v,{type:"primary",onClick:M,onLoad:j($)},{default:t(()=>[r("\u4FDD\u5B58")]),_:1},8,["onLoad"])]),_:1})]),_:1})}}}),Ae={class:"page-container"},Le={class:"page-panel",style:{height:"calc(100vh - 100px)"}},et=q({__name:"detail",props:{typeName:{type:String,required:!0},appKey:{type:String,required:!0},hostId:{type:String,required:!0}},setup(o){return(l,a)=>{const s=we,_=Fe;return i(),I("div",Ae,[T("div",Le,[e(_,null,{default:t(()=>[e(s,{key:"1",title:"\u8D44\u4EA7\u4FE1\u606F"},{default:t(()=>[e(Oe,{"app-key":o.appKey,"host-id":o.hostId,"type-name":o.typeName},null,8,["app-key","host-id","type-name"])]),_:1}),e(s,{key:"3",title:"\u5B8F"},{default:t(()=>[e(Te,{"app-key":o.appKey,"host-id":o.hostId,"type-name":o.typeName},null,8,["app-key","host-id","type-name"])]),_:1}),e(s,{key:"2",title:"\u6807\u7B7E"},{default:t(()=>[e(Ue,{"app-key":o.appKey,"host-id":o.hostId,"type-name":o.typeName},null,8,["app-key","host-id","type-name"])]),_:1})]),_:1})])])}}});export{et as _,Je as e,Ye as f,Ve as g,Qe as i,Ge as l};
