import{l as K,_ as Q}from"./index.e9d54774.js";/* empty css               *//* empty css               *//* empty css              *//* empty css                */import{d as X,cu as $,cv as Z,f as y,D as d,E as _,aS as l,aI as e,H as v,aU as F,aV as k,aY as f,ai as ee,aM as oe,ck as le,bp as ae,a7 as te,aN as ne,bt as ue,bD as se,aH as C,aW as S,bI as ie,bJ as de,a$ as ce,aO as re,bo as pe,a_ as _e,aP as fe,ag as ve,b0 as me}from"./arco.a97fe066.js";const ge=c=>(ie("data-v-68c5dfbe"),c=c(),de(),c),be=ge(()=>v("span",{style:{"margin-left":"4px"}},"\u9AD8\u7EA7\u641C\u7D22",-1)),Ce={class:"panel-box__content"},Be={class:"condition-list"},Ve={class:"panel-box__footer"},ye=X({__name:"index",props:$({fieldOptions:{type:Array,required:!0}},{modelValue:{},modelModifiers:{}}),emits:$(["ok","cancel"],["update:modelValue"]),setup(c,{emit:A}){const r=Z(c,"modelValue"),h=c,E=A,m=y(!1),q={string:[{label:"\u7B49\u4E8E",value:"eq"},{label:"\u5305\u542B",value:"contains"}]},s=y({conditions:[{field:"",condition:"",value:"",values:[],conditionOptions:[]}]}),x=()=>{s.value.conditions.push({field:"",condition:"",value:"",values:[],conditionOptions:[]})},M=u=>{s.value.conditions.splice(u,1)},D=u=>{var o,t;return(o=h.fieldOptions.find(p=>p.field===u))!=null&&o.valueType?q[(t=h.fieldOptions.find(p=>p.field===u))==null?void 0:t.valueType]:[]},N=(u,o)=>{const{field:t}=u;s.value.conditions[o].conditionOptions=D(t)},P=(u,o)=>{const{condition:t}=u;t==="contains"?s.value.conditions[o].values=[]:s.value.conditions[o].value=""},R=(u,o)=>{s.value.conditions[o].condition="",s.value.conditions[o].value="",s.value.conditions[o].values=[]},O=y(),z=async()=>{var o;await((o=O.value)==null?void 0:o.validate())||(r.value=K.cloneDeep(s.value.conditions.map(t=>({field:t.field,condition:t.condition,value:t.value,values:t.values}))),m.value=!1,E("ok"))},I=u=>{var o;u&&r.value&&((o=r.value)==null?void 0:o.length)>0&&(s.value.conditions=r.value.map(t=>({field:t.field,condition:t.condition,value:t.value,values:t.values,conditionOptions:D(t.field)})))};return(u,o)=>{const t=ee,p=oe,T=le,w=ce,B=re,g=pe,b=_e,H=fe,L=ve,j=me,J=ae,W=te,U=ne,Y=ue,G=se;return d(),_("div",null,[l(G,{"popup-visible":m.value,"onUpdate:popupVisible":o[1]||(o[1]=a=>m.value=a),position:"bottom",trigger:"click",onPopupVisibleChange:I},{content:e(()=>[v("div",Ce,[v("div",Be,[l(J,{ref_key:"formRef",ref:O,model:s.value,"label-col-props":{span:0,offset:0},"wrapper-col-props":{span:24}},{default:e(()=>[(d(!0),_(F,null,k(s.value.conditions,(a,i)=>(d(),_("div",{key:i},[l(j,{style:{"align-items":"center"},gutter:[10,0]},{default:e(()=>[l(b,{span:6},{default:e(()=>[l(g,{field:`conditions[${i}].field`,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5B57\u6BB5"}]},{default:e(()=>[l(B,{modelValue:a.field,"onUpdate:modelValue":n=>a.field=n,placeholder:"\u8BF7\u9009\u62E9\u5B57\u6BB5","allow-clear":"","allow-search":"",onChange:n=>N(a,i),onClear:n=>R(a,i)},{default:e(()=>[(d(!0),_(F,null,k(c.fieldOptions,(n,V)=>(d(),C(w,{key:V,value:n.field},{default:e(()=>[f(S(n.title),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","onClear"])]),_:2},1032,["field"])]),_:2},1024),l(b,{span:6},{default:e(()=>[l(g,{field:`conditions[${i}].condition`,rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6761\u4EF6"}]},{default:e(()=>[l(B,{modelValue:a.condition,"onUpdate:modelValue":n=>a.condition=n,placeholder:"\u8BF7\u9009\u62E9\u6761\u4EF6","allow-clear":"",onChange:n=>P(a,i)},{default:e(()=>[(d(!0),_(F,null,k(a.conditionOptions,(n,V)=>(d(),C(w,{key:V,value:n.value},{default:e(()=>[f(S(n.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["field"])]),_:2},1024),l(b,{span:11},{default:e(()=>[a.condition==="contains"?(d(),C(g,{key:0,field:`conditions[${i}].values`,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u503C"}]},{default:e(()=>[l(B,{modelValue:a.values,"onUpdate:modelValue":n=>a.values=n,placeholder:"\u8BF7\u8F93\u5165\u503C,\u6309\u56DE\u8F66\u786E\u5B9A",multiple:"","allow-create":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field"])):(d(),C(g,{key:1,field:`conditions[${i}].value`,rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u503C"}]},{default:e(()=>[l(H,{modelValue:a.value,"onUpdate:modelValue":n=>a.value=n,placeholder:"\u8BF7\u8F93\u5165\u503C"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field"]))]),_:2},1024),l(b,{span:1,style:{display:"flex","justify-content":"center","margin-top":"-20px"}},{default:e(()=>[l(L,{style:{cursor:"pointer"},onClick:n=>M(i)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1},8,["model"])]),v("div",Ve,[l(p,{onClick:x},{icon:e(()=>[l(W)]),default:e(()=>[f(" \u6DFB\u52A0 ")]),_:1}),v("div",null,[l(Y,null,{default:e(()=>[l(U,{size:"mini",onClick:o[0]||(o[0]=a=>{m.value=!1,E("cancel")})},{default:e(()=>[f(" \u53D6\u6D88 ")]),_:1}),l(U,{type:"primary",size:"mini",onClick:z},{default:e(()=>[f(" \u7B5B\u9009 ")]),_:1})]),_:1})])])])]),default:e(()=>[l(T,{count:r.value?r.value.filter(a=>a.value||a.values&&a.values.length>0).length:0,"dot-style":{fontSize:"10px",borderRadius:"10px",background:"var(--color-bg-7)",color:"var(--color-text-3)"},offset:[14,8]},{default:e(()=>[l(p,null,{default:e(()=>[l(t),be]),_:1})]),_:1},8,["count","dot-style"])]),_:1},8,["popup-visible"])])}}});const we=Q(ye,[["__scopeId","data-v-68c5dfbe"]]);export{we as A};
