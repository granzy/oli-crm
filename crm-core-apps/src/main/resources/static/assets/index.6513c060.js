import{a as X,l as ee,_ as Be}from"./index.e9d54774.js";/* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               */import{d as oe,f as p,r as ie,c as M,w as Oe,aT as ce,D as K,E as te,aS as e,aI as t,H as D,u as g,aW as $,aY as B,bz as re,G as _e,aU as ve,aP as de,bt as pe,a_ as ne,b0 as le,bB as ge,aH as Ae,aQ as Pe,O as $e,aN as be,N as Ne,bi as qe,o as Ve,aZ as je,bq as ue,bg as J,ch as Le,aM as Me,P as Ge,ag as We,bG as Ue,cx as He,bo as Ke,bp as Qe}from"./arco.a97fe066.js";import{p as me}from"./pagination.72a5f225.js";import{q as Ye,d as Ze,u as Je,s as Xe,f as et,c as tt,e as at}from"./monitor-object-tag.71c4a187.js";import{d as ae}from"./index.127a6572.js";import{q as ot,y as nt}from"./monitor-object.647fdfa2.js";import{c as ye}from"./host-group.ed397ed1.js";import"./chart.a235fbdf.js";import"./vue.4eb70094.js";import"./config-backup-device.df1a641e.js";import"./color.562bf6e9.js";const lt={style:{display:"flex"}},st={class:"selected-count"},ut=oe({__name:"monitor-object-table-left",props:{assignedTableData:{},height:{}},setup(U,{expose:k}){const{loading:j,setLoading:F}=X(!1),{pagination:_,pageSizeOptions:S}=me(),f=p(),L=p(),I=U,C=p({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"checkId",isHover:!0},checkboxConfig:{reserve:!0,checkMethod(o){return I.assignedTableData?!I.assignedTableData.some(s=>s.checkId===o.row.checkId):!0}},showOverflow:"tooltip",columns:[{type:"checkbox",width:40},{title:"\u53EF\u89C1\u540D\u79F0",slots:{default:"displayName"},minWidth:140},{title:"IP",field:"ip",minWidth:80},{title:"\u5E94\u7528",field:"appName",minWidth:80},{title:"\u7C7B\u578B",slots:{default:"categoryName"},minWidth:60}]}),v=ie({queryStr:""}),n=p([]),h=p([]),q=M(()=>{const o=f.value,s=[];return o&&(s.push(...o.getCheckboxRecords()),s.push(...o.getCheckboxReserveRecords())),s.filter(m=>h.value.includes(m.checkId))}),r=()=>{const o=f.value;n.value.forEach(s=>{const m=s.checkId,T=h.value.indexOf(m)!==-1;o.getRowById(m)&&o.setCheckboxRow(o.getRowById(m),T)})};Oe(()=>I.assignedTableData,o=>{o&&(h.value=o.map(s=>s.checkId)),r()},{immediate:!0});const O=async(o={...v,page:_})=>{F(!0);try{const s=f.value,{data:m}=await ot(o);_.total=m.totalElements,s&&(await s.loadData(m.content),n.value=m.content)}catch(s){console.error(s)}finally{F(!1),r()}},A=o=>{const{checked:s,row:m}=o;s?h.value.push(m.checkId):h.value=h.value.filter(T=>T!==m.checkId)},y=M(()=>n.value.filter(o=>{var s;return!((s=I.assignedTableData)!=null&&s.map(m=>m.checkId).includes(o.checkId))}).map(o=>o.checkId)),R=o=>{const{checked:s}=o;if(s){const m=y.value.filter(T=>!h.value.includes(T));h.value.push(...m)}else h.value=h.value.filter(m=>!y.value.includes(m))},E=ae(async()=>{await O()},500),z=o=>{_.current=o,O()},w=o=>{_.pageSize=o,O()},P=p([]);return k({initData:()=>{O(),ye().then(o=>{P.value=o.data})},getSelectRow:()=>q.value,clearSelectRow:()=>{_.current=1,h.value=[],v.queryStr="",r()}}),(o,s)=>{const m=de,T=pe,G=ne,H=le,a=ge,c=ce("vxe-grid");return K(),te(ve,null,[e(H,null,{default:t(()=>[e(G,{span:18},{default:t(()=>[D("div",lt,[e(T,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(m,{modelValue:v.queryStr,"onUpdate:modelValue":s[0]||(s[0]=i=>v.queryStr=i),style:{width:"250px"},placeholder:"\u540D\u79F0/IP","allow-clear":"",onClear:g(E),onInput:g(E)},null,8,["modelValue","onClear","onInput"])]),_:1})])]),_:1}),e(G,{span:6,style:{"text-align":"right"}},{default:t(()=>[D("span",st,"\u5DF2\u9009\u62E9\u4E86"+$(h.value.length)+"\u6761",1)]),_:1})]),_:1}),D("div",{style:_e([{height:o.height},{"margin-left":"-16px","margin-right":"-16px"}])},[e(c,re({ref_key:"xGrid",ref:f,loading:g(j)},C.value,{onCheckboxChange:A,onCheckboxAll:R}),{displayName:t(({row:i})=>[B($(i.displayName),1)]),categoryName:t(({row:i})=>[D("span",null,$(i.categoryName||"--"),1)]),pager:t(()=>[e(a,{ref_key:"xPagination",ref:L,current:g(_).current,"page-size":g(_).pageSize,total:g(_).total,"page-size-options":g(S),style:{"padding-top":"10px","padding-left":"10px"},size:"mini","show-total":"","show-jumper":!1,"buffer-size":1,onChange:z,onPageSizeChange:w},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])],4)],64)}}}),it={style:{display:"flex"}},ct={class:"selected-count"},rt=oe({__name:"monitor-object-table-right",props:{height:{}},emits:["getAssignedTableData"],setup(U,{expose:k,emit:j}){const{loading:F,setLoading:_}=X(!1),S=p(),{pagination:f,pageSizeOptions:L}=me(),I=p({size:"mini",height:"auto",columnConfig:{resizable:!0},rowConfig:{keyField:"checkId",isHover:!0},checkboxConfig:{reserve:!0},showOverflow:"tooltip",columns:[{type:"checkbox",width:40},{title:"\u53EF\u89C1\u540D\u79F0",slots:{default:"displayName"},minWidth:140},{title:"IP",field:"ip",minWidth:80},{title:"\u5E94\u7528",field:"appName",minWidth:80},{title:"\u7C7B\u578B",slots:{default:"categoryName"},minWidth:60}]}),C=ie({queryStr:""}),v=p([]),n=p([]),h=M(()=>v.value.filter(a=>C.queryStr?a.displayName.includes(C.queryStr)||a.ip.includes(C.queryStr):!0).slice((f.current-1)*f.pageSize,f.current*f.pageSize)),q=M(()=>v.value.filter(a=>C.queryStr?a.displayName.includes(C.queryStr)||a.ip.includes(C.queryStr):!0)),r=M(()=>{const a=S.value,c=[];return a&&(c.push(...a.getCheckboxRecords()),c.push(...a.getCheckboxReserveRecords())),c}),O=()=>{const a=S.value;v.value.forEach(c=>{const i=c.checkId,b=n.value.indexOf(i)!==-1;a.getRowById(i)&&a.setCheckboxRow(a.getRowById(i),b)})},A=j,y=p([]),R=async()=>{_(!0);try{await S.value.loadData(h.value),f.total=q.value.length}catch(a){console.error(a)}finally{_(!1),O()}},E=a=>{const{checked:c,row:i}=a;c?n.value.push(i.checkId):n.value=n.value.filter(b=>b!==i.checkId)},z=M(()=>v.value.map(a=>a.checkId)),w=a=>{const{checked:c}=a,i=h.value.map(b=>b.checkId);if(c){const b=i.filter(W=>!n.value.includes(W));n.value.push(...b)}else n.value=n.value.filter(b=>!i.includes(b))},P=ae(async()=>{await R()},500),Q=p([]),Y=async a=>{const c=S.value;y.value=ee.cloneDeep(a),v.value=ee.cloneDeep(a),A("getAssignedTableData",y.value),ye().then(i=>{Q.value=i.data}),await c.loadData(h.value),f.total=v.value.length},V=()=>n.value,o=()=>r.value,s=()=>{f.current=1,n.value=[],C.queryStr="",O()},m=a=>{a.forEach(c=>{const i=c.checkId;z.value.indexOf(i)===-1&&(v.value.push(c),y.value.push(c))}),R(),A("getAssignedTableData",y.value)},T=a=>{a.forEach(c=>{const i=c.checkId;z.value.indexOf(i)!==-1&&(v.value=v.value.filter(b=>b.checkId!==i),y.value=y.value.filter(b=>b.checkId!==i))}),n.value=n.value.filter(c=>!a.map(i=>i.checkId).includes(c)),R(),A("getAssignedTableData",y.value)},G=a=>{f.current=a,R()},H=a=>{f.pageSize=a,R()};return k({initData:Y,addRowDataToTable:m,removeRowDataFromTable:T,getSelectRow:o,getSelectRowKeys:V,clearSelectRow:s}),(a,c)=>{const i=de,b=pe,W=ne,se=le,l=ge,u=ce("vxe-grid");return K(),te(ve,null,[e(se,null,{default:t(()=>[e(W,{span:18},{default:t(()=>[D("div",it,[e(b,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(i,{modelValue:C.queryStr,"onUpdate:modelValue":c[0]||(c[0]=d=>C.queryStr=d),style:{width:"250px"},placeholder:"\u540D\u79F0/IP","allow-clear":"",onClear:g(P),onInput:g(P)},null,8,["modelValue","onClear","onInput"])]),_:1})])]),_:1}),e(W,{span:6,style:{"text-align":"right"}},{default:t(()=>[D("span",ct,"\u5DF2\u9009\u62E9\u4E86"+$(n.value.length)+"\u6761",1)]),_:1})]),_:1}),D("div",{style:_e([{height:a.height},{"margin-left":"-16px","margin-right":"-16px"}])},[e(u,re({ref_key:"xGrid",ref:S,loading:g(F)},I.value,{"scroll-y":{enabled:!0,gt:100},onCheckboxChange:E,onCheckboxAll:w}),{displayName:t(({row:d})=>[B($(d.displayName),1)]),categoryName:t(({row:d})=>[D("span",null,$(d.categoryName||"--"),1)]),pager:t(()=>[e(l,{ref:"xPagination",current:g(f).current,"page-size":g(f).pageSize,total:g(f).total,"page-size-options":g(L),style:{"padding-top":"10px","padding-left":"10px"},size:"mini","show-total":"","show-jumper":!1,"buffer-size":1,onChange:G,onPageSizeChange:H},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])],4)],64)}}}),dt={class:"transfer-button-container"},pt={style:{"margin-top":"10px"}},gt=oe({__name:"index",props:{visible:{type:Boolean,default:!1},modelValue:{},drawerTitle:{default:"\u5206\u914D\u5BF9\u8C61"},sourceTitle:{default:"\u672A\u9009"},targetTitle:{default:"\u5DF2\u9009"}},emits:["update:modelValue","ok","cancel"],setup(U,{emit:k}){const j=U,F=p(),_=p(),S=k,f=()=>{F.value.clearSelectRow(),_.value.clearSelectRow()},L=()=>{F.value.initData(),_.value.initData(j.modelValue)},I=p([]),C=r=>{I.value=r},v=()=>{const r=F.value.getSelectRow();_.value.addRowDataToTable(r)},n=()=>{const r=_.value.getSelectRow();_.value.removeRowDataFromTable(r)},h=()=>{S("update:modelValue",I.value),S("ok",I.value)},q=()=>{S("cancel")};return(r,O)=>{const A=Pe,y=ne,R=$e,E=be,z=Ne,w=le,P=qe;return K(),Ae(P,{width:"68vw",title:r.drawerTitle,visible:r.visible,"mask-closable":!1,onOk:h,onCancel:q,onOpen:L,onBeforeOpen:f},{default:t(()=>[e(w,null,{default:t(()=>[e(y,{span:12,style:{"padding-right":"20px"}},{default:t(()=>[e(A,{size:"mini",title:r.sourceTitle},{default:t(()=>[e(ut,{ref_key:"monitorObjectTableLeftRef",ref:F,height:"calc(100vh - 250px)","assigned-table-data":I.value},null,8,["assigned-table-data"])]),_:1},8,["title"])]),_:1}),D("div",dt,[D("div",null,[e(E,{type:"primary",size:"mini",onClick:v},{icon:t(()=>[e(R)]),_:1})]),D("div",pt,[e(E,{type:"primary",size:"mini",onClick:n},{icon:t(()=>[e(z)]),_:1})])]),e(y,{span:12,style:{"padding-left":"20px"}},{default:t(()=>[e(A,{size:"mini",title:r.targetTitle},{default:t(()=>[e(rt,{ref_key:"monitorObjectTableRightRef",ref:_,height:"calc(100vh - 250px)",onGetAssignedTableData:C},null,512)]),_:1},8,["title"])]),_:1})]),_:1})]),_:1},8,["title","visible"])}}});const mt=Be(gt,[["__scopeId","data-v-9eacb7c2"]]),ft={class:"page-container"},ht={class:"page-panel"},_t={key:0},vt={class:"selected-count"},bt={style:{height:"calc(100vh - 146px)"}},Pt=oe({__name:"index",setup(U){const{pagination:k,pageSizeOptions:j}=me(),F=p(),_=p(),S=p({size:"mini",height:"auto",columnConfig:{resizable:!0},showOverflow:"tooltip",rowConfig:{isHover:!0,keyField:"id"},columns:[{type:"checkbox",width:40},{title:"\u6807\u7B7E\u540D\u79F0",field:"name",minWidth:120},{title:"\u521B\u5EFA\u65F6\u95F4",field:"createTime",width:200},{title:"\u64CD\u4F5C",width:200,slots:{default:"action"}}]}),f=ie({keywords:""}),{loading:L,setLoading:I}=X(!1),{loading:C,setLoading:v}=X(!1),n=p([]);let h=[];const q=()=>{const l=F.value;h.forEach(u=>{const d=u.id,N=n.value.indexOf(d)!==-1;l.getRowById(d)&&l.setCheckboxRow(l.getRowById(d),N)})},r=async(l={...f,page:k})=>{I(!0);const u=F.value;try{const{data:d}=await Ye(l);h=d.content,k.total=d.totalElements,u&&await u.reloadData(d.content)}catch(d){console.error(d)}finally{I(!1),q()}},O=l=>{k.current=l,r()},A=l=>{k.pageSize=l,r()},y=ae(async()=>{await r()},500),R=()=>{r()},E=p(!1),z=p(),w=p({id:"",name:""}),P=p(),Q=()=>{E.value=!0,z.value.resetFields(),w.value.id="",P.value=""},Y=l=>{E.value=!0,ee.assign(w.value,l),P.value=ee.cloneDeep(w.value.name),z.value.validate()},V=p(!1),o=p(),s=p(),m=async l=>{const{data:u}=await nt({tagId:l.id});s.value=u,o.value=l,V.value=!0},T=async l=>{ue.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,simple:!1,draggable:!0,closable:!1,content:`\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u6807\u7B7E'${l.name}'\uFF0C\u662F\u5426\u7EE7\u7EED?`,onOk:async()=>{await Ze(l.id),J.success("\u5220\u9664\u6210\u529F"),await r(),n.value=n.value.filter(u=>u!==l.id)}})},G=async()=>{v(!0);const l=await z.value.validate();try{l?console.warn("\u9A8C\u8BC1\u4E0D\u901A\u8FC7"):(w.value.id?await Je(w.value):await Xe(w.value),J.success("\u63D0\u4EA4\u6210\u529F"),E.value=!1,await r())}catch(u){console.error(u)}finally{v(!1)}},H=ae(async(l,u)=>{if(l!==P.value){const{data:d}=await et(l);d&&u("\u6807\u7B7E\u5DF2\u5B58\u5728")}},500),a=l=>{const{checked:u,row:d}=l;u?n.value.push(d.id):n.value=n.value.filter(N=>N!==d.id)},c=M(()=>h.map(l=>l.id)),i=l=>{const{checked:u}=l;if(u){const d=c.value.filter(N=>!n.value.includes(N));n.value.push(...d)}else n.value=n.value.filter(d=>!c.value.includes(d))},b=()=>{n.value=[],q()},W=()=>{ue.warning({title:"\u63D0\u793A",titleAlign:"start",hideCancel:!1,simple:!1,draggable:!0,closable:!1,content:`\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u60A8\u6240\u9009\u7684${n.value.length}\u6761\u6807\u7B7E\uFF0C\u662F\u5426\u7EE7\u7EED?`,onOk:async()=>{await tt(n.value),J.success("\u5220\u9664\u6210\u529F"),b(),await r()}})},se=async()=>{o.value&&(o.value.monitorObjects=s.value,await at(o.value),J.success("\u5206\u914D\u6210\u529F"),await r()),V.value=!1};return Ve(()=>{r()}),(l,u)=>{const d=Le,N=pe,fe=ne,Z=Me,we=be,ke=Ge,Ce=We,xe=Ue,De=He,Ie=le,Fe=ge,Se=ce("vxe-grid"),Ee=de,Re=Ke,ze=Qe,Te=ue;return K(),te("div",ft,[D("div",ht,[e(Ie,null,{default:t(()=>[e(fe,{span:14},{default:t(()=>[e(N,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(d,{modelValue:f.keywords,"onUpdate:modelValue":u[0]||(u[0]=x=>f.keywords=x),style:{width:"320px"},placeholder:"\u6807\u7B7E\u540D\u79F0","allow-clear":"",onSearch:R,onInput:g(y),onClear:g(y)},null,8,["modelValue","onInput","onClear"])]),_:1})]),_:1}),e(fe,{span:10,style:{"text-align":"right"}},{default:t(()=>[e(N,{style:{"margin-bottom":"5px"}},{default:t(()=>[n.value.length>0?(K(),te("span",_t,[D("span",vt," \u5DF2\u9009\u62E9\u4E86"+$(n.value.length)+"\u6761 ",1),e(Z,{onClick:b},{default:t(()=>[B("\u6E05\u7A7A")]),_:1})])):je("",!0),e(we,{type:"primary",size:"medium",onClick:Q},{default:t(()=>[B($(l.$t("button.create")),1)]),_:1}),e(De,null,{icon:t(()=>[e(ke)]),content:t(()=>[e(xe,{disabled:n.value.length===0,onClick:W},{default:t(()=>[e(Ce),B(" \u5220\u9664 ")]),_:1},8,["disabled"])]),default:t(()=>[B(" \u7BA1\u7406 ")]),_:1})]),_:1})]),_:1})]),_:1}),D("div",bt,[e(Se,re({ref_key:"xGrid",ref:F,loading:g(L)},S.value,{onCheckboxChange:a,onCheckboxAll:i}),{index:t(({rowIndex:x})=>[B($(x+1+(g(k).current-1)*g(k).pageSize),1)]),action:t(({row:x})=>[e(N,null,{default:t(()=>[e(Z,{onClick:he=>Y(x)},{default:t(()=>[B("\u7F16\u8F91")]),_:2},1032,["onClick"]),e(Z,{onClick:he=>m(x)},{default:t(()=>[B("\u5206\u914D")]),_:2},1032,["onClick"]),e(Z,{type:"text",onClick:he=>T(x)},{default:t(()=>[B("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),pager:t(()=>[e(Fe,{ref_key:"xPagination",ref:_,current:g(k).current,"page-size":g(k).pageSize,total:g(k).total,"page-size-options":g(j),style:{"padding-top":"10px"},"show-total":"","show-jumper":"","show-page-size":"",onChange:O,onPageSizeChange:A},null,8,["current","page-size","total","page-size-options"])]),_:1},16,["loading"])])]),e(Te,{visible:E.value,width:"auto","title-align":"start",draggable:"","mask-closable":!1,"ok-loading":g(C),onOk:G,onCancel:u[2]||(u[2]=x=>E.value=!1)},{title:t(()=>[B($(w.value.id?"\u7F16\u8F91\u6807\u7B7E":"\u65B0\u5EFA\u6807\u7B7E"),1)]),default:t(()=>[D("div",null,[e(ze,{ref_key:"submitFormRef",ref:z,model:w.value,style:{width:"540px"}},{default:t(()=>[e(Re,{field:"name",label:"\u6807\u7B7E\u540D\u79F0",rules:[{maxLength:64,message:"\u6807\u7B7E\u540D\u79F0\u957F\u5EA6\u6700\u5927\u4E0D\u80FD\u8D85\u8FC764"},{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u7B7E\u540D\u79F0"},{validator:g(H)}],"validate-trigger":"blur"},{default:t(()=>[e(Ee,{modelValue:w.value.name,"onUpdate:modelValue":u[1]||(u[1]=x=>w.value.name=x),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])])]),_:1},8,["visible","ok-loading"]),e(mt,{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=x=>s.value=x),visible:V.value,"onUpdate:visible":u[4]||(u[4]=x=>V.value=x),"drawer-title":o.value?"\u5206\u914D\u5BF9\u8C61("+o.value.name+")":"\u5206\u914D\u5BF9\u8C61","source-title":"\u672A\u5206\u914D","target-title":"\u5DF2\u5206\u914D",onOk:se,onCancel:u[5]||(u[5]=x=>V.value=!1)},null,8,["modelValue","visible","drawer-title"])])}}});export{Pt as default};
